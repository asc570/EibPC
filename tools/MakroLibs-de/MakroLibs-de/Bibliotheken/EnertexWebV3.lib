//----------------------------------------------------------------------
//                         Makros für den Enertex EiBPC
//
//  Ziel                 : WebMakros für den Webserver V3. Diese Makros können nicht mit Webserver V1 oder V2 
//			   genutzt werden
//
//  Version		 : v3.100
// 
//  Lizens               : Verwendung nur für die Nutzung mit dem 
//                         Enertex EibPC gestattet 
//
//  (C) Copyright        : Enertex Bayern GmbH. All rights reserved.
//
//  Author               : Dipl.-Ing. (Enertex Bayern GmbH)
//  Mail                 : schuhmann@enertex.de
//
//  Dat.Rev.             : $Date: 2016/11/16 17:53:01 $
//  Version              : $Revision: 1.16 $
//----------------------------------------------------------------------

// Schaltuhr für den Webserver: Voraussetzung der Form shifter(ID)[PLUS,MINUS,UP,DOWN]$Schaltuhr$
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin WebSchaltuhr(ID,PageID,Name,PresetH,PresetM)
:info $Steuert eine Schaltuhr, die über den Webserver angesteuert wird. Es wird eine Freigabevariable (Name = 3.Argument) angelegt, welches als Freigabeobjekt der Schaltuhr dient. Voraussetzung ist ein "pshifter" im Webserver folgender Form(§ mit Dollarzeichen ersetzen): shifter(ID)[PLUS,MINUS,UP,DOWN]§Schaltuhr§ 		Siehe Beispiel WebSchaltuhr.epc$\\
	$ID des pshifters$\\
	$Seiten-ID des pshifters$\\
	$Name der Schaltuhr$\\
	$Voreinstellung der Stunden (0..24)$\\
	$Voreinstellung der Minuten (0..59)$
:shortinfo $Steuert eine Webserver-Schaltuhr$
SchaltuhrH^Name=PresetH
SchaltuhrM^Name=PresetM
if pbutton(ID,PageID)==1 then SchaltuhrH^Name=SchaltuhrH^Name+1 endif
if pbutton(ID,PageID)==2 then if SchaltuhrH^Name==0 then SchaltuhrH^Name = 23 else SchaltuhrH^Name=SchaltuhrH^Name-1  endif endif
if pbutton(ID,PageID)==3 then SchaltuhrM^Name=SchaltuhrM^Name+1 endif
if pbutton(ID,PageID)==4 then if SchaltuhrM^Name==0 then SchaltuhrM^Name=59; SchaltuhrH^Name=SchaltuhrH^Name-1 else SchaltuhrM^Name=SchaltuhrM^Name-1 endif endif
if SchaltuhrH^Name>23 then SchaltuhrH^Name=0 endif
if SchaltuhrM^Name>59 then SchaltuhrM^Name=0;SchaltuhrH^Name=SchaltuhrH^Name+1 endif
if change(SchaltuhrM^Name) or change(SchaltuhrH^Name) or after(systemstart(),10000u64) then {
	pdisplay(ID,$ hh:mm $+stringformat(SchaltuhrH^Name,0,3,2,2)+$:$+stringformat(SchaltuhrM^Name,0,3,2,2),DOWN,INACTIVE,GREEN,PageID) 
} endif
Name=AUS
if chtime(SchaltuhrH^Name,SchaltuhrM^Name,0) then {
	Name=EIN
} else {
	Name=AUS 
} endif

if Name then {
	pdisplay(ID,$ hh:mm $+stringformat(SchaltuhrH^Name,0,3,2,2)+$:$+stringformat(SchaltuhrM^Name,0,3,2,2),DOWN,INACTIVE,GREEN,PageID) 
} else {
	pdisplay(ID,$ hh:mm $+stringformat(SchaltuhrH^Name,0,3,2,2)+$:$+stringformat(SchaltuhrM^Name,0,3,2,2),DOWN,INACTIVE,GREY,PageID)
} endif
:end 

// Schaltuhr für den Webserver: Voraussetzung der Form shifter(ID)[PLUS,MINUS,UP,DOWN]$Schaltuhr$
// @date	11.01.2014
// @version	2 
// @author	Stefanie Meier, Enertex Bayern GmbH
:begin WebSchaltuhrFlash(ID,PageID,Name,PresetH,PresetM,FlashID)
:info $Steuert eine Schaltuhr, die über den Webserver angesteuert wird. Die Daten werden im Flash abgelegt. Es wird eine Freigabevariable (Name = 3.Argument) angelegt, welches als Freigabeobjekt der Schaltuhr dient. Voraussetzung ist ein "pshifter" im Webserver folgender Form(§ mit Dollarzeichen ersetzen): shifter(ID)[PLUS,MINUS,UP,DOWN]§Schaltuhr§ Siehe Beispiel WebSchaltuhr.epc$\\
	$ID des pshifters$\\
	$Seiten-ID des pshifters$\\
	$Name der Schaltuhr$\\
	$Voreinstellung der Stunden (0..24)$\\
	$Voreinstellung der Minuten (0..59)$\\
	$Speicherplatz als u16$
:shortinfo $Steuert eine Webserver-Schaltuhr und legt die Daten im Flash ab$
SchaltuhrH^Name=PresetH
SchaltuhrM^Name=PresetM
:var Flash@
Flash@=FlashID

if pbutton(ID,PageID)==1 then SchaltuhrH^Name=SchaltuhrH^Name+1 endif
if pbutton(ID,PageID)==2 then if SchaltuhrH^Name==0 then SchaltuhrH^Name = 23 else SchaltuhrH^Name=SchaltuhrH^Name-1  endif endif
if pbutton(ID,PageID)==3 then SchaltuhrM^Name=SchaltuhrM^Name+1 endif
if pbutton(ID,PageID)==4 then if SchaltuhrM^Name==0 then SchaltuhrM^Name=59; SchaltuhrH^Name=SchaltuhrH^Name-1 else SchaltuhrM^Name=SchaltuhrM^Name-1 endif endif
if SchaltuhrH^Name>23 then SchaltuhrH^Name=0 endif
if SchaltuhrM^Name>59 then SchaltuhrM^Name=0;SchaltuhrH^Name=SchaltuhrH^Name+1 endif

if change(SchaltuhrM^Name) then {
	writeflash(SchaltuhrM^Name,Flash@+1u16);
	pdisplay(ID,$ hh:mm $+stringformat(SchaltuhrH^Name,0,3,2,2)+$:$+stringformat(SchaltuhrM^Name,0,3,2,2),DOWN,INACTIVE,GREEN,PageID) 
} endif

if change(SchaltuhrH^Name)then {
	writeflash(SchaltuhrH^Name,Flash@);
	pdisplay(ID,$ hh:mm $+stringformat(SchaltuhrH^Name,0,3,2,2)+$:$+stringformat(SchaltuhrM^Name,0,3,2,2),DOWN,INACTIVE,GREEN,PageID) 
} endif

if systemstart() then {
	Flash@=FlashID;
	readflash(SchaltuhrH^Name,Flash@);
	readflash(SchaltuhrM^Name,Flash@+1u16)
} endif

if after(systemstart(),20000u64) then {
	pdisplay(ID,$ hh:mm $+stringformat(SchaltuhrH^Name,0,3,2,2)+$:$+stringformat(SchaltuhrM^Name,0,3,2,2),DOWN,INACTIVE,GREEN,PageID) 
} endif


Name=AUS
if chtime(SchaltuhrH^Name,SchaltuhrM^Name,0) then {
	Name=EIN
} else {
	Name=AUS 
} endif

if Name then {
	pdisplay(ID,$ hh:mm $+stringformat(SchaltuhrH^Name,0,3,2,2)+$:$+stringformat(SchaltuhrM^Name,0,3,2,2),DOWN,INACTIVE,GREEN,PageID) 
} else {
	pdisplay(ID,$ hh:mm $+stringformat(SchaltuhrH^Name,0,3,2,2)+$:$+stringformat(SchaltuhrM^Name,0,3,2,2),DOWN,INACTIVE,GREY,PageID)
} endif
:end 

// Schaltuhr für den Webserver
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin WebSchaltuhrAusfuehren(Freigabetag,Freigabezeit,GA,Wert)
:info $Eine Schaltuhr schreibt ihre Werte. Dabei muss Freigabetag und Freigabezeit vom Datentyp b01 sein$\\
	$Freigabetag: Variable vom Typ b01 (EIN/AUS), im Normalfall die Freigabevariable der WebSchaltuhrTagesWahl$\\
	$Freigabezeit: Variable vom Typ b01 (EIN/AUS), im Normalfall die Freigabevariable der WebSchaltuhr$\\
	$Gruppenaddresse, auf welche ein Wert geschrieben werden soll.$\\
	$Wert, welcher auf die Gruppenadresse geschrieben werden soll.$
:shortinfo $Eine Webserver-Schaltuhr steuert eine GA$
if Freigabetag and Freigabezeit then {
   write(GA, Wert)
} endif
:end 


// Schaltuhr für den Webserver
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin WebSchaltuhrTagesWahl(FreigabeName,ID,PageID,Montag,Dienstag,Mittwoch,Donnerstag,Freitag,Samstag,Sonntag)
:info $Eine Auswahlbox für eine Webschaltuhr zur Konfiguration des Tages realisieren. Datentyp der Variable mit FreigabeName ist b01 (EIN/AUS).Vorraussetzung dafür ist ein mpshifter folgender Form(§ mit Dollarzeichene ersetzen): mpshifter(DateID)[§Montag§,§Dienstag§,§Mittwoch§,§Donnerstag§,§Freitag§,§Samstag§,§Sonntag§,§----------§,§Werktags§,§Wochenende§,§----------§,§Nie§,§Täglich§][DATE]§Tageswahl§\\
        		Siehe Beispiel WebSchaltuhrTagesWahl.epc$\\
         :$Name der FreigabeVariable$\\
         :$Zahl zwischen 0 und 39 oder ID-Variable des mpshifters$\\
         :$Zahl zwischen 0 und 99 oder ID-Variable der Seite, auf der der mpshifter definiert wurde.$\\
         :$Vorbelegung der Schaltuhr am Montag: EIN oder AUS$\\
         :$Vorbelegung der Schaltuhr am Dienstag: EIN oder AUS$\\
         :$Vorbelegung der Schaltuhr am Mittwoch: EIN oder AUS$\\
         :$Vorbelegung der Schaltuhr am Donnerstag: EIN oder AUS$\\
         :$Vorbelegung der Schaltuhr am Freitag: EIN oder AUS$\\
         :$Vorbelegung der Schaltuhr am Samstag: EIN oder AUS$\\
         :$Vorbelegung der Schaltuhr am Sonntag: EIN oder AUS$
:shortinfo $Implementierung einer Tagesauswahl für eine Schaltuhr$

//----------------------------------
// Implementierung von Name
m_^ID_^PageID_Text=$$
m_^ID_^PageID_ICON=DATE
m_^ID_^PageID_State=INACTIVE
m_^ID_^PageID_Deko=GREY
m_^ID_^PageID_Choice=1
m_^ID_^PageID_Day_1=Montag
m_^ID_^PageID_Day_2=Dienstag
m_^ID_^PageID_Day_3=Mittwoch
m_^ID_^PageID_Day_4=Donnerstag
m_^ID_^PageID_Day_5=Freitag
m_^ID_^PageID_Day_6=Samstag
m_^ID_^PageID_Day_7=Sonntag
m_^ID_^PageID_Day_8=m_^ID_^PageID_Day_1 and m_^ID_^PageID_Day_2 and m_^ID_^PageID_Day_3 and m_^ID_^PageID_Day_4 and m_^ID_^PageID_Day_5
m_^ID_^PageID_Day_9=m_^ID_^PageID_Day_6 and m_^ID_^PageID_Day_7
m_^ID_^PageID_Day_10=AUS 
m_^ID_^PageID_Day_11=m_^ID_^PageID_Day_1 and m_^ID_^PageID_Day_2 and m_^ID_^PageID_Day_3 and m_^ID_^PageID_Day_4 and m_^ID_^PageID_Day_5 and m_^ID_^PageID_Day_6 and m_^ID_^PageID_Day_7


FreigabeName=AUS
if m_^ID_^PageID_Day_1 and dayofweek()==MONDAY then FreigabeName=EIN endif
if m_^ID_^PageID_Day_2 and dayofweek()==TUESDAY then FreigabeName=EIN endif
if m_^ID_^PageID_Day_3 and dayofweek()==WEDNESDAY then FreigabeName=EIN endif
if m_^ID_^PageID_Day_4 and dayofweek()==THURSDAY then FreigabeName=EIN endif
if m_^ID_^PageID_Day_5 and dayofweek()==FRIDAY then FreigabeName=EIN endif
if m_^ID_^PageID_Day_6 and dayofweek()==SATURDAY then FreigabeName=EIN endif
if m_^ID_^PageID_Day_7 and dayofweek()==SUNDAY then FreigabeName=EIN endif
if m_^ID_^PageID_Day_8 and dayofweek()==WEEKDAY then FreigabeName=EIN endif
if m_^ID_^PageID_Day_9 and dayofweek()==WEEKEND then FreigabeName=EIN endif
if !m_^ID_^PageID_Day_1 and dayofweek()==MONDAY then FreigabeName=AUS endif
if !m_^ID_^PageID_Day_2 and dayofweek()==TUESDAY then FreigabeName=AUS endif
if !m_^ID_^PageID_Day_3 and dayofweek()==WEDNESDAY then FreigabeName=AUS endif
if !m_^ID_^PageID_Day_4 and dayofweek()==THURSDAY then FreigabeName=AUS endif
if !m_^ID_^PageID_Day_5 and dayofweek()==FRIDAY then FreigabeName=AUS endif
if !m_^ID_^PageID_Day_6 and dayofweek()==SATURDAY then FreigabeName=AUS endif
if !m_^ID_^PageID_Day_7 and dayofweek()==SUNDAY then FreigabeName=AUS endif
if !m_^ID_^PageID_Day_8 and dayofweek()==WEEKDAY then FreigabeName=AUS endif
if !m_^ID_^PageID_Day_9 and dayofweek()==WEEKEND then FreigabeName=AUS endif
if FreigabeName then m_^ID_^PageID_State=ACTIVE else m_^ID_^PageID_State=DARKRED endif
if mpbutton(ID,1,PageID)==255 then {
	m_^ID_^PageID_Choice=1
} endif   
if mpbutton(ID,2,PageID)==255 then {
	m_^ID_^PageID_Choice=2
} endif   
if mpbutton(ID,3,PageID)==255 then {
	m_^ID_^PageID_Choice=3
} endif   
if mpbutton(ID,4,PageID)==255 then {
	m_^ID_^PageID_Choice=4
} endif   
if mpbutton(ID,5,PageID)==255 then {
	m_^ID_^PageID_Choice=5
} endif   
if mpbutton(ID,6,PageID)==255 then {
	m_^ID_^PageID_Choice=6
} endif   
if mpbutton(ID,7,PageID)==255 then {
	m_^ID_^PageID_Choice=7
} endif   
if mpbutton(ID,9,PageID)==255 then {
	m_^ID_^PageID_Choice=9
} endif   
if mpbutton(ID,10,PageID)==255 then {
	m_^ID_^PageID_Choice=10
} endif   
if mpbutton(ID,12,PageID)==255 then {
	m_^ID_^PageID_Choice=12
} endif   
if mpbutton(ID,13,PageID)==255 then {
	m_^ID_^PageID_Choice=13
} endif   
if change(m_^ID_^PageID_Text) or change(m_^ID_^PageID_ICON) or change(m_^ID_^PageID_State) or change(m_^ID_^PageID_Deko) or change(m_^ID_^PageID_Choice) or after(systemstart(),convert(random(30000u32),0u64)) then {
	pdisplay(ID,m_^ID_^PageID_Text,m_^ID_^PageID_ICON,m_^ID_^PageID_State,m_^ID_^PageID_Deko,PageID,m_^ID_^PageID_Choice) 
} endif 

if mpbutton(ID,1,PageID)==1 then {
	m_^ID_^PageID_Day_1=!m_^ID_^PageID_Day_1
} endif   
if mpbutton(ID,2,PageID)==1 then {
	m_^ID_^PageID_Day_2=!m_^ID_^PageID_Day_2
} endif   
if mpbutton(ID,3,PageID)==1 then {
	m_^ID_^PageID_Day_3=!m_^ID_^PageID_Day_3
} endif   
if mpbutton(ID,4,PageID)==1 then {
	m_^ID_^PageID_Day_4=!m_^ID_^PageID_Day_4
} endif   
if mpbutton(ID,5,PageID)==1 then {
	m_^ID_^PageID_Day_5=!m_^ID_^PageID_Day_5
} endif   
if mpbutton(ID,6,PageID)==1 then {
	m_^ID_^PageID_Day_6=!m_^ID_^PageID_Day_6
} endif   
if mpbutton(ID,7,PageID)==1 then {
	m_^ID_^PageID_Day_7=!m_^ID_^PageID_Day_7
} endif   
if mpbutton(ID,9,PageID)==1 then {
	m_^ID_^PageID_Day_8=!m_^ID_^PageID_Day_8;
	If m_^ID_^PageID_Day_8 then {
		m_^ID_^PageID_Day_1=EIN;
		m_^ID_^PageID_Day_2=EIN;
		m_^ID_^PageID_Day_3=EIN;
		m_^ID_^PageID_Day_4=EIN;
		m_^ID_^PageID_Day_5=EIN;
		m_^ID_^PageID_Day_6=AUS;
		m_^ID_^PageID_Day_7=AUS;
		m_^ID_^PageID_Day_9=AUS
	} else {
		m_^ID_^PageID_Day_1=AUS;
		m_^ID_^PageID_Day_2=AUS;
		m_^ID_^PageID_Day_3=AUS;
		m_^ID_^PageID_Day_4=AUS;
		m_^ID_^PageID_Day_5=AUS
	} endif
} endif   
if mpbutton(ID,10,PageID)==1 then {
	m_^ID_^PageID_Day_9=!m_^ID_^PageID_Day_9;
	If m_^ID_^PageID_Day_9 then {
		m_^ID_^PageID_Day_1=AUS;
		m_^ID_^PageID_Day_2=AUS;
		m_^ID_^PageID_Day_3=AUS;
		m_^ID_^PageID_Day_4=AUS;
		m_^ID_^PageID_Day_5=AUS;
		m_^ID_^PageID_Day_6=EIN;
		m_^ID_^PageID_Day_7=EIN;
		m_^ID_^PageID_Day_8=AUS
	} else {
		m_^ID_^PageID_Day_6=AUS;
		m_^ID_^PageID_Day_7=AUS
	} endif		
} endif   
if mpbutton(ID,12,PageID)==1 then {
	m_^ID_^PageID_Day_10=!m_^ID_^PageID_Day_10;
	m_^ID_^PageID_Day_1=AUS;
	m_^ID_^PageID_Day_2=AUS;
	m_^ID_^PageID_Day_3=AUS;
	m_^ID_^PageID_Day_4=AUS;
	m_^ID_^PageID_Day_5=AUS;
	m_^ID_^PageID_Day_6=AUS;
	m_^ID_^PageID_Day_7=AUS;
	m_^ID_^PageID_Day_8=AUS;
	m_^ID_^PageID_Day_9=AUS
} endif   
if mpbutton(ID,13,PageID)==1 then {
	m_^ID_^PageID_Day_11=!m_^ID_^PageID_Day_11;
	m_^ID_^PageID_Day_1=EIN;
	m_^ID_^PageID_Day_2=EIN;
	m_^ID_^PageID_Day_3=EIN;
	m_^ID_^PageID_Day_4=EIN;
	m_^ID_^PageID_Day_5=EIN;
	m_^ID_^PageID_Day_6=EIN;
	m_^ID_^PageID_Day_7=EIN;
	m_^ID_^PageID_Day_8=EIN;
	m_^ID_^PageID_Day_9=EIN
} endif  
if m_^ID_^PageID_Day_1 or m_^ID_^PageID_Day_2 or m_^ID_^PageID_Day_3 or m_^ID_^PageID_Day_4 or m_^ID_^PageID_Day_5 or m_^ID_^PageID_Day_6 or m_^ID_^PageID_Day_7 or m_^ID_^PageID_Day_8 or m_^ID_^PageID_Day_9 then {
   m_^ID_^PageID_State=DISPLAY
} else {
   m_^ID_^PageID_State=DARKRED
} endif

if m_^ID_^PageID_Day_1 and m_^ID_^PageID_Choice==1 then { 
	m_^ID_^PageID_Text=$ Tag aktiv$;
	m_^ID_^PageID_Deko=GREEN
} endif 
if !m_^ID_^PageID_Day_1 and m_^ID_^PageID_Choice==1 then { 
	m_^ID_^PageID_Text=$ Tag inaktiv$;
	m_^ID_^PageID_Deko=GREY
} endif 
if m_^ID_^PageID_Day_2 and m_^ID_^PageID_Choice==2 then { 
	m_^ID_^PageID_Text=$ Tag aktiv$;
	m_^ID_^PageID_Deko=GREEN
} endif 
if !m_^ID_^PageID_Day_2 and m_^ID_^PageID_Choice==2 then { 
	m_^ID_^PageID_Text=$ Tag inaktiv$;
	m_^ID_^PageID_Deko=GREY
} endif 
if m_^ID_^PageID_Day_3 and m_^ID_^PageID_Choice==3 then { 
	m_^ID_^PageID_Text=$ Tag aktiv$;
	m_^ID_^PageID_Deko=GREEN
} endif
if !m_^ID_^PageID_Day_3 and m_^ID_^PageID_Choice==3 then { 
	m_^ID_^PageID_Text=$ Tag inaktiv$;
	m_^ID_^PageID_Deko=GREY
} endif 
if m_^ID_^PageID_Day_4 and m_^ID_^PageID_Choice==4 then { 
	m_^ID_^PageID_Text=$ Tag aktiv$;
	m_^ID_^PageID_Deko=GREEN
} endif
if !m_^ID_^PageID_Day_4 and m_^ID_^PageID_Choice==4 then { 
	m_^ID_^PageID_Text=$ Tag inaktiv$;
	m_^ID_^PageID_Deko=GREY
} endif 

if m_^ID_^PageID_Day_5 and m_^ID_^PageID_Choice==5 then { 
	m_^ID_^PageID_Text=$ Tag aktiv$;
	m_^ID_^PageID_Deko=GREEN
} endif
if !m_^ID_^PageID_Day_5 and m_^ID_^PageID_Choice==5 then { 
	m_^ID_^PageID_Text=$ Tag inaktiv$;
	m_^ID_^PageID_Deko=GREY
} endif 

if m_^ID_^PageID_Day_6 and m_^ID_^PageID_Choice==6 then { 
	m_^ID_^PageID_Text=$ Tag aktiv$;
	m_^ID_^PageID_Deko=GREEN
} endif
if !m_^ID_^PageID_Day_6 and m_^ID_^PageID_Choice==6 then { 
	m_^ID_^PageID_Text=$ Tag inaktiv$;
	m_^ID_^PageID_Deko=GREY
} endif 

if m_^ID_^PageID_Day_7 and m_^ID_^PageID_Choice==7 then { 
	m_^ID_^PageID_Text=$ Tag aktiv$;
	m_^ID_^PageID_Deko=GREEN
} endif
if !m_^ID_^PageID_Day_7 and m_^ID_^PageID_Choice==7 then { 
	m_^ID_^PageID_Text=$ Tag inaktiv$;
	m_^ID_^PageID_Deko=GREY
} endif 
if m_^ID_^PageID_Day_8 and m_^ID_^PageID_Choice==9 then { 
	m_^ID_^PageID_Text=$ Werktags aktiv$;
	m_^ID_^PageID_Deko=GREEN
} endif
if !m_^ID_^PageID_Day_8 and m_^ID_^PageID_Choice==9 then { 
	m_^ID_^PageID_Text=$ Werktags inaktiv$;
	m_^ID_^PageID_Deko=GREY
} endif 
if m_^ID_^PageID_Day_9 and m_^ID_^PageID_Choice==10 then { 
	m_^ID_^PageID_Text=$ Wochenenden aktiv$;
	m_^ID_^PageID_Deko=GREEN
} endif
if !m_^ID_^PageID_Day_9 and m_^ID_^PageID_Choice==10 then { 
	m_^ID_^PageID_Text=$ Wochenenden inaktiv$;
	m_^ID_^PageID_Deko=GREY
} endif 
if  m_^ID_^PageID_Choice==12 then { 
	m_^ID_^PageID_Text=$ Alle Tage inaktivieren$;
	m_^ID_^PageID_Deko=GREY
} endif
if  m_^ID_^PageID_Choice==12 and change(m_^ID_^PageID_Day_10) then { 
	m_^ID_^PageID_Text=$ Alle Tage inaktiv$;
	m_^ID_^PageID_Deko=GREEN
} endif
if m_^ID_^PageID_Day_11 and m_^ID_^PageID_Choice==13 then { 
	m_^ID_^PageID_Text=$ Täglich aktiv$;
	m_^ID_^PageID_Deko=GREEN
} endif
if !m_^ID_^PageID_Day_11 and m_^ID_^PageID_Choice==13 then { 
	m_^ID_^PageID_Text=$ Nicht täglich aktiv$;
	m_^ID_^PageID_Deko=GREY
} endif 

//----------------------------------
:end


// MultiButton2
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin MultiButton2(Name, ID, GA1, GA2)
:info $Einen Multibutton (Elemente: mbutton, mshifter)  mit einer zweifachen Auswahlbox ansteuern. Die Gruppenadressen müssen Schaltelemente sein, d.h. \\
Datentyp b01. - OBSOLETE, Nachfolgemakro: UmschaltMultiButton2fach$\\
         :$Name des Elements$\\
         :$(Zahl zwischen 0 und 39) als ID des Elements$\\
         :$1. Gruppenadresse des Knopfes (b01)$\\
         :$2. Gruppenadresse des Knopfes (b01)$
:shortinfo $Implementierung eines mbutton oder mshifter mit zwei GA - OBSOLETE, Nachfolgemakro: UmschaltMultiButton2fach$

//----------------------------------
// Implementierung von Name
m^Name_Text=$AUS$
m^Name_ICON=LIGHT
m^Name_State=ACTIVE
m^Name_Deko=GREY
m^Name_Choice=1
if mbutton(ID,1)==255 then {
	m^Name_Choice=1
} endif   
if mbutton(ID,2)==255 then {
	m^Name_Choice=2
} endif   
if mbutton(ID,3)==255 then {
	m^Name_Choice=3
} endif   
if  change(m^Name_ICON) or change(m^Name_State) or change(m^Name_Deko) or change(m^Name_Choice) then {
	display(ID,m^Name_Text,m^Name_ICON,m^Name_State,m^Name_Deko,m^Name_Choice) 
} endif 

if mbutton(ID,1)==1 then {
	write(GA1,!GA1)
} endif   
if mbutton(ID,2)==1 then {
	write(GA2,!GA2)
} endif   

if GA1 and m^Name_Choice==1 then { 
	m^Name_Text=$EIN$;
	m^Name_Deko=GREEN;
	m^Name_State=ACTIVE
} endif 
if !GA1 and m^Name_Choice==1 then { 
	m^Name_Text=$AUS$;
	m^Name_Deko=GREY;
	m^Name_State=INACTIVE
} endif 
if GA2 and m^Name_Choice==2 then { 
	m^Name_Text=$EIN$;
	m^Name_Deko=GREEN;
	m^Name_State=ACTIVE
} endif 
if !GA2 and m^Name_Choice==2 then { 
	m^Name_Text=$AUS$;
	m^Name_Deko=GREY;
	m^Name_State=INACTIVE
} endif 
//--------------------------------------

:end


// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin MultiButton3(Name, ID, GA1, GA2, GA3)
:info $Einen Multibutton (Elemente: mbutton, mshifter)  mit einer dreifachen Auswahlbox ansteuern. Die Gruppenadressen müssen Schaltelemente sein, d.h. \\
Datentyp b01. - OBSOLETE, Nachfolgemakro: UmschaltMultiButton3fach$\\
         :$Name des Elements$\\
         :$(Zahl zwischen 0 und 39) als ID des Elements$\\
         :$1. Gruppenadresse des Knopfes (b01)$\\
         :$2. Gruppenadresse des Knopfes (b01)$\\
         :$3. Gruppenadresse des Knopfes (b01)$
:shortinfo $Implementierung eines mbutton oder mshifter mit drei GA - OBSOLETE, Nachfolgemakro: UmschaltMultiButton3fach$

//----------------------------------
// Implementierung von Name
m^Name_Text=$AUS$
m^Name_ICON=LIGHT
m^Name_State=ACTIVE
m^Name_Deko=GREY
m^Name_Choice=1
if mbutton(ID,1)==255 then {
	m^Name_Choice=1
} endif   
if mbutton(ID,2)==255 then {
	m^Name_Choice=2
} endif   
if mbutton(ID,3)==255 then {
	m^Name_Choice=3
} endif   
if  change(m^Name_ICON) or change(m^Name_State) or change(m^Name_Deko) or change(m^Name_Choice) then {
	display(ID,m^Name_Text,m^Name_ICON,m^Name_State,m^Name_Deko,m^Name_Choice) 
} endif 

if mbutton(ID,1)==1 then {
	write(GA1,!GA1)
} endif   
if mbutton(ID,2)==1 then {
	write(GA2,!GA2)
} endif   
if mbutton(ID,3)==1 then {
	write(GA3,!GA3)
} endif   
if GA1 and m^Name_Choice==1 then { 
	m^Name_Text=$EIN$;
	m^Name_Deko=GREEN;
	m^Name_State=ACTIVE
} endif 
if !GA1 and m^Name_Choice==1 then { 
	m^Name_Text=$AUS$;
	m^Name_Deko=GREY;
	m^Name_State=INACTIVE
} endif 
if GA2 and m^Name_Choice==2 then { 
	m^Name_Text=$EIN$;
	m^Name_Deko=GREEN;
	m^Name_State=ACTIVE
} endif 
if !GA2 and m^Name_Choice==2 then { 
	m^Name_Text=$AUS$;
	m^Name_Deko=GREY;
	m^Name_State=INACTIVE
} endif 
if GA3 and m^Name_Choice==3 then { 
	m^Name_Text=$EIN$;
	m^Name_Deko=GREEN;
	m^Name_State=ACTIVE
} endif
if !GA3 and m^Name_Choice==3 then { 
	m^Name_Text=$AUS$;
	m^Name_Deko=GREY;
	m^Name_State=INACTIVE
} endif 
//----------------------------------

:end

// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin MultiButton4(Name, ID, GA1, GA2, GA3, GA4)
:info $Einen Multibutton (Elemente: mbutton, mshifter)  mit einer vierfachen Auswahlbox ansteuern. Die Gruppenadressen müssen Schaltelemente sein, d.h. \\
Datentyp b01. - OBSOLETE, Nachfolgemakro: UmschaltMultiButton4fach$\\
         :$Name des Elements$\\
         :$(Zahl zwischen 0 und 39) als ID des Elements$\\
         :$1. Gruppenadresse des Knopfes (b01)$\\
         :$2. Gruppenadresse des Knopfes (b01)$\\
         :$3. Gruppenadresse des Knopfes (b01)$\\
         :$4. Gruppenadresse des Knopfes (b01)$
:shortinfo $Implementierung eines mbutton oder mshifter mit vier GA - OBSOLETE, Nachfolgemakro: UmschaltMultiButton4fach$

//----------------------------------
// Implementierung von Name
m^Name_Text=$AUS$
m^Name_ICON=LIGHT
m^Name_State=ACTIVE
m^Name_Deko=GREY
m^Name_Choice=1
if mbutton(ID,1)==255 then {
	m^Name_Choice=1
} endif   
if mbutton(ID,2)==255 then {
	m^Name_Choice=2
} endif   
if mbutton(ID,3)==255 then {
	m^Name_Choice=3
} endif   
if mbutton(ID,4)==255 then {
	m^Name_Choice=4
} endif   
if change(m^Name_ICON) or change(m^Name_State) or change(m^Name_Deko) or change(m^Name_Choice) then {
	display(ID,m^Name_Text,m^Name_ICON,m^Name_State,m^Name_Deko,m^Name_Choice) 
} endif 
if mbutton(ID,1)==1 then {
	write(GA1,!GA1)
} endif   
if mbutton(ID,2)==1 then {
	write(GA2,!GA2)
} endif   
if mbutton(ID,3)==1 then {
	write(GA3,!GA3)
} endif   
if mbutton(ID,4)==1 then {
	write(GA4,!GA4)
} endif   

if GA1 and m^Name_Choice==1 then { 
	m^Name_Text=$EIN$;
	m^Name_Deko=GREEN;
	m^Name_State=ACTIVE
} endif 
if !GA1 and m^Name_Choice==1 then { 
	m^Name_Text=$AUS$;
	m^Name_Deko=GREY;
	m^Name_State=INACTIVE
} endif 
if GA2 and m^Name_Choice==2 then { 
	m^Name_Text=$EIN$;
	m^Name_Deko=GREEN;
	m^Name_State=ACTIVE
} endif 
if !GA2 and m^Name_Choice==2 then { 
	m^Name_Text=$AUS$;
	m^Name_Deko=GREY;
	m^Name_State=INACTIVE
} endif 
if GA3 and m^Name_Choice==3 then { 
	m^Name_Text=$EIN$;
	m^Name_Deko=GREEN;
	m^Name_State=ACTIVE
} endif
if !GA3 and m^Name_Choice==3 then { 
	m^Name_Text=$AUS$;
	m^Name_Deko=GREY;
	m^Name_State=INACTIVE
} endif 
if GA4 and m^Name_Choice==4 then { 
	m^Name_Text=$EIN$;
	m^Name_Deko=GREEN;
	m^Name_State=ACTIVE
} endif
if !GA4 and m^Name_Choice==4 then { 
	m^Name_Text=$AUS$;
	m^Name_Deko=GREY;
	m^Name_State=INACTIVE
} endif 
//----------------------------------

:end


// Webelement
// @date	20.07.2016
// @version	2
// @author	Enertex Bayern GmbH
:begin MultipageButton2(Name, ID, PageID, Icon, GA1, GA2)
:info $Einen seitenbezogenen Multibutton (Elemente: mpbutton, mpshifter)  mit einer zweifachen Auswahlbox ansteuern. Die Gruppenadressen müssen Schaltelemente sein, d.h. \\
Datentyp b01. - OBSOLETE, Nachfolgemakro: UmschaltMultiPageButton2fach$\\
         :$Name des Elements$\\
         :$Zahl zwischen 0 und 39 oder ID-Variable des Elements$\\
         :$Zahl zwischen 0 und 99 oder ID-Variable der Seite, auf der das Element definiert wurde.$\\
		 :$Darzustellendes Symbol$ \\
         :$1. Gruppenadresse des Knopfes (b01)$\\
         :$2. Gruppenadresse des Knopfes (b01)$
:shortinfo $Implementierung eines mpbutton oder mpshifter mit zwei GA - OBSOLETE, Nachfolgemakro: UmschaltMultiPageButton2fach$
//----------------------------------
// Implementierung von Name
m^Name_Text=$AUS$
m^Name_ICON=Icon
m^Name_State=ACTIVE
m^Name_Deko=GREY
m^Name_Choice=1
if mpbutton(ID,1,PageID)==255 then {
	m^Name_Choice=1
} endif   
if mpbutton(ID,2,PageID)==255 then {
	m^Name_Choice=2
} endif   
if mpbutton(ID,3,PageID)==255 then {
	m^Name_Choice=3
} endif   
if change(m^Name_ICON) or change(m^Name_State) or change(m^Name_Deko) or change(m^Name_Choice) then {
	pdisplay(ID,m^Name_Text,m^Name_ICON,m^Name_State,m^Name_Deko,PageID,m^Name_Choice) 
} endif 

if mpbutton(ID,1,PageID)==1 then {
	write(GA1,!GA1)
} endif   
if mpbutton(ID,2,PageID)==1 then {
	write(GA2,!GA2)
} endif   

if GA1 and m^Name_Choice==1 then { 
	m^Name_Text=$ EIN - $+CLOCK_STRING;
	m^Name_Deko=GREEN;
	m^Name_State=ACTIVE
} endif 
if !GA1 and m^Name_Choice==1 then { 
	m^Name_Text=$ AUS - $+CLOCK_STRING;
	m^Name_Deko=GREY;
	m^Name_State=INACTIVE
} endif 
if GA2 and m^Name_Choice==2 then { 
	m^Name_Text=$ EIN - $+CLOCK_STRING;
	m^Name_Deko=GREEN;
	m^Name_State=ACTIVE
} endif 
if !GA2 and m^Name_Choice==2 then { 
	m^Name_Text=$ AUS - $+CLOCK_STRING;
	m^Name_Deko=GREY;
	m^Name_State=INACTIVE
} endif 
//----------------------------------

:end



// Webelement
// @date	20.07.2016
// @version	2
// @author	Enertex Bayern GmbH
:begin MultipageButton3(Name, ID, PageID, Icon, GA1, GA2, GA3)
:info $Einen seitenbezogenen Multibutton (Elemente: mpbutton, mpshifter)  mit einer dreifachen Auswahlbox ansteuern. Die Gruppenadressen müssen Schaltelemente sein, d.h. \\
Datentyp b01. - OBSOLETE, Nachfolgemakro: UmschaltMultiPageButton3fach$\\
         :$Name des Elements$\\
         :$Zahl zwischen 0 und 39 oder ID-Variable des Elements$\\
         :$Zahl zwischen 0 und 99 oder ID-Variable der Seite, auf der das Element definiert wurde.$\\
		 :$Darzustellendes Symbol$ \\
         :$1. Gruppenadresse des Knopfes (b01)$\\
         :$2. Gruppenadresse des Knopfes (b01)$\\
         :$3. Gruppenadresse des Knopfes (b01)$
:shortinfo $Implementierung eines mpbutton oder mpshifter mit drei GA - OBSOLETE, Nachfolgemakro: UmschaltMultiPageButton3fach$

//----------------------------------
// Implementierung von Name
m^Name_Text=$AUS$
m^Name_ICON=Icon
m^Name_State=ACTIVE
m^Name_Deko=GREY
m^Name_Choice=1
if mpbutton(ID,1,PageID)==255 then {
	m^Name_Choice=1
} endif   
if mpbutton(ID,2,PageID)==255 then {
	m^Name_Choice=2
} endif   
if mpbutton(ID,3,PageID)==255 then {
	m^Name_Choice=3
} endif   
if change(m^Name_ICON) or change(m^Name_State) or change(m^Name_Deko) or change(m^Name_Choice) then {
	pdisplay(ID,m^Name_Text,m^Name_ICON,m^Name_State,m^Name_Deko,PageID,m^Name_Choice) 
} endif 

if mpbutton(ID,1,PageID)==1 then {
	write(GA1,!GA1)
} endif   
if mpbutton(ID,2,PageID)==1 then {
	write(GA2,!GA2)
} endif   
if mpbutton(ID,3,PageID)==1 then {
	write(GA3,!GA3)
} endif   

if GA1 and m^Name_Choice==1 then { 
	m^Name_Text=$ EIN - $+CLOCK_STRING;
	m^Name_Deko=GREEN;
	m^Name_State=ACTIVE
} endif 
if !GA1 and m^Name_Choice==1 then { 
	m^Name_Text=$ AUS - $+CLOCK_STRING;
	m^Name_Deko=GREY;
	m^Name_State=INACTIVE
} endif 
if GA2 and m^Name_Choice==2 then { 
	m^Name_Text=$ EIN - $+CLOCK_STRING;
	m^Name_Deko=GREEN;
	m^Name_State=ACTIVE
} endif 
if !GA2 and m^Name_Choice==2 then { 
	m^Name_Text=$ AUS - $+CLOCK_STRING;
	m^Name_Deko=GREY;
	m^Name_State=INACTIVE
} endif 
if GA3 and m^Name_Choice==3 then { 
	m^Name_Text=$ EIN - $+CLOCK_STRING;
	m^Name_Deko=GREEN;
	m^Name_State=ACTIVE
} endif
if !GA3 and m^Name_Choice==3 then { 
	m^Name_Text=$ AUS - $+CLOCK_STRING;
	m^Name_Deko=GREY;
	m^Name_State=INACTIVE
} endif 
//----------------------------------

:end

// Webelement
// @date	20.07.2016
// @version	2
// @author	Enertex Bayern GmbH
:begin MultipageButton4(Name, ID, PageID, Icon, GA1, GA2, GA3, GA4)
:info $Einen seitenbezogenen Multibutton (Elemente: mpbutton, mpshifter)  mit einer vierfachen Auswahlbox ansteuern. Die Gruppenadressen müssen Schaltelemente sein, d.h. \\
Datentyp b01. - OBSOLETE, Nachfolgemakro: UmschaltMultiPageButton4fach$\\
         :$Name des Elements$\\
         :$Zahl zwischen 0 und 39 oder ID-Variable des Elements$\\
         :$Zahl zwischen 0 und 99 oder ID-Variable der Seite, auf der das Element definiert wurde.$\\
		 :$Darzustellendes Symbol$ \\
         :$1. Gruppenadresse des Knopfes (b01)$\\
         :$2. Gruppenadresse des Knopfes (b01)$\\
         :$3. Gruppenadresse des Knopfes (b01)$\\
         :$4. Gruppenadresse des Knopfes (b01)$
:shortinfo $Implementierung eines mpbutton oder mpshifter mit vier GA - OBSOLETE, Nachfolgemakro: UmschaltMultiPageButton4fach$

//----------------------------------
// Implementierung von Name
m^Name_Text=$ AUS - $+CLOCK_STRING
m^Name_ICON=Icon
m^Name_State=ACTIVE
m^Name_Deko=GREY
m^Name_Choice=1
if mpbutton(ID,1,PageID)==255 then {
	m^Name_Choice=1
} endif   
if mpbutton(ID,2,PageID)==255 then {
	m^Name_Choice=2
} endif   
if mpbutton(ID,3,PageID)==255 then {
	m^Name_Choice=3
} endif   
if mpbutton(ID,4,PageID)==255 then {
	m^Name_Choice=4
} endif   
if change(m^Name_ICON) or change(m^Name_State) or change(m^Name_Deko) or change(m^Name_Choice) then {
	pdisplay(ID,m^Name_Text,m^Name_ICON,m^Name_State,m^Name_Deko,PageID,m^Name_Choice) 
} endif 

if mpbutton(ID,1,PageID)==1 then {
	write(GA1,!GA1)
} endif   
if mpbutton(ID,2,PageID)==1 then {
	write(GA2,!GA2)
} endif   
if mpbutton(ID,3,PageID)==1 then {
	write(GA3,!GA3)
} endif   
if mpbutton(ID,4,PageID)==1 then {
	write(GA4,!GA4)
} endif   

if GA1 and m^Name_Choice==1 then { 
	m^Name_Text=$ EIN - $+CLOCK_STRING;
	m^Name_Deko=GREEN;
	m^Name_State=ACTIVE
} endif 
if !GA1 and m^Name_Choice==1 then { 
	m^Name_Text=$ AUS - $+CLOCK_STRING;
	m^Name_Deko=GREY;
	m^Name_State=INACTIVE
} endif 
if GA2 and m^Name_Choice==2 then { 
	m^Name_Text=$ EIN - $+CLOCK_STRING;
	m^Name_Deko=GREEN;
	m^Name_State=ACTIVE
} endif 
if !GA2 and m^Name_Choice==2 then { 
	m^Name_Text=$ AUS - $+CLOCK_STRING;
	m^Name_Deko=GREY;
	m^Name_State=INACTIVE
} endif 
if GA3 and m^Name_Choice==3 then { 
	m^Name_Text=$ EIN - $+CLOCK_STRING;
	m^Name_Deko=GREEN;
	m^Name_State=ACTIVE
} endif
if !GA3 and m^Name_Choice==3 then { 
	m^Name_Text=$ AUS - $+CLOCK_STRING;
	m^Name_Deko=GREY;
	m^Name_State=INACTIVE
} endif 
if GA4 and m^Name_Choice==4 then { 
	m^Name_Text=$ EIN - $+CLOCK_STRING;
	m^Name_Deko=GREEN;
	m^Name_State=ACTIVE
} endif
if !GA4 and m^Name_Choice==4 then { 
	m^Name_Text=$ AUS - $+CLOCK_STRING;
	m^Name_Deko=GREY;
	m^Name_State=INACTIVE
} endif 
//----------------------------------
:end



// Webelement
// @date	20.07.2016
// @version	2
// @author	Enertex Bayern GmbH
:begin UmschaltMultiButton2fach(ID,Icon, GA1,StatusGA1, GA2,StatusGA2)
:info $Einen Multibutton (Elemente: mbutton, mshifter)  mit einer zweifachen Auswahlbox ansteuern. Die Gruppenadressen müssen Schaltelemente sein, d.h. \\
Datentyp b01$\\
         :$(Zahl zwischen 0 und 39) als ID des Elements$\\
         :$1. Gruppenadresse des Knopfes (b01)$\\
         :$1. Status-Gruppenadresse des Knopfes (b01)$\\
         :$2. Gruppenadresse des Knopfes (b01)$\\
         :$2. Status-Gruppenadresse des Knopfes (b01)$
:shortinfo $Implementierung eines mbutton oder mshifter mit zwei GA$

//----------------------------------
// Implementierung von Name
m^ID_Text=$AUS$
m^ID_ICON=Icon
m^ID_State=ACTIVE
m^ID_Deko=GREY
m^ID_Choice=1
if mbutton(ID,1)==255 then {
	m^ID_Choice=1
} endif   
if mbutton(ID,2)==255 then {
	m^ID_Choice=2
} endif   
if mbutton(ID,3)==255 then {
	m^ID_Choice=3
} endif   
if  change(m^ID_ICON) or change(m^ID_State) or change(m^ID_Deko) or change(m^ID_Choice) then {
	display(ID,m^ID_Text,m^ID_ICON,m^ID_State,m^ID_Deko,m^ID_Choice) 
} endif 

if mbutton(ID,1)==1 then {
	write(GA1,!StatusGA1)
} endif   
if mbutton(ID,2)==1 then {
	write(GA2,!StatusGA2)
} endif   

if StatusGA1 and m^ID_Choice==1 then { 
	m^ID_Text=$EIN$;
	m^ID_Deko=GREEN;
	m^ID_State=ACTIVE
} endif 
if !StatusGA1 and m^ID_Choice==1 then { 
	m^ID_Text=$AUS$;
	m^ID_Deko=GREY;
	m^ID_State=INACTIVE
} endif 
if StatusGA2 and m^ID_Choice==2 then { 
	m^ID_Text=$EIN$;
	m^ID_Deko=GREEN;
	m^ID_State=ACTIVE
} Statusendif 
if !GA2 and m^ID_Choice==2 then { 
	m^ID_Text=$AUS$;
	m^ID_Deko=GREY;
	m^ID_State=INACTIVE
} endif 
//--------------------------------------

:end


// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin UmschaltMultiButton3fach(ID, Icon,GA1,StatusGA1, GA2,StatusGA2, GA3,StatusGA3)
:info $Einen Multibutton (Elemente: mbutton, mshifter)  mit einer dreifachen Auswahlbox ansteuern. Die Gruppenadressen müssen Schaltelemente sein, d.h. \\
Datentyp b01.$\\
         :$(Zahl zwischen 0 und 39) als ID des Elements$\\
         :$Icon des Elements$\\
         :$1. Gruppenadresse des Knopfes (b01)$\\
         :$1. Status-Gruppenadresse des Knopfes (b01)$\\
         :$2. Gruppenadresse des Knopfes (b01)$\\
         :$2. Status-Gruppenadresse des Knopfes (b01)$\\
         :$3. Gruppenadresse des Knopfes (b01)$\\
         :$3. Status-Gruppenadresse des Knopfes (b01)$
:shortinfo $Implementierung eines mbutton oder mshifter mit drei GA$

//----------------------------------
// Implementierung
m^ID_Text=$AUS$
m^ID_ICON=Icon
m^ID_State=ACTIVE
m^ID_Deko=GREY
m^ID_Choice=1
if mbutton(ID,1)==255 then {
	m^ID_Choice=1
} endif   
if mbutton(ID,2)==255 then {
	m^ID_Choice=2
} endif   
if mbutton(ID,3)==255 then {
	m^ID_Choice=3
} endif   
if  change(m^ID_ICON) or change(m^ID_State) or change(m^ID_Deko) or change(m^ID_Choice) then {
	display(ID,m^ID_Text,m^ID_ICON,m^ID_State,m^ID_Deko,m^ID_Choice) 
} endif 

if mbutton(ID,1)==1 then {
	write(GA1,!StatusGA1)
} endif   
if mbutton(ID,2)==1 then {
	write(GA2,!StatusGA2)
} endif   
if mbutton(ID,3)==1 then {
	write(GA3,!StatusGA3)
} endif   
if StatusGA1 and m^ID_Choice==1 then { 
	m^ID_Text=$EIN$;
	m^ID_Deko=GREEN;
	m^ID_State=ACTIVE
} endif 
if !StatusGA1 and m^ID_Choice==1 then { 
	m^ID_Text=$AUS$;
	m^ID_Deko=GREY;
	m^ID_State=INACTIVE
} endif 
if StatusGA2 and m^ID_Choice==2 then { 
	m^ID_Text=$EIN$;
	m^ID_Deko=GREEN;
	m^ID_State=ACTIVE
} endif 
if !StatusGA2 and m^ID_Choice==2 then { 
	m^ID_Text=$AUS$;
	m^ID_Deko=GREY;
	m^ID_State=INACTIVE
} endif 
if StatusGA3 and m^ID_Choice==3 then { 
	m^ID_Text=$EIN$;
	m^ID_Deko=GREEN;
	m^ID_State=ACTIVE
} endif
if !StatusGA3 and m^ID_Choice==3 then { 
	m^ID_Text=$AUS$;
	m^ID_Deko=GREY;
	m^ID_State=INACTIVE
} endif 
//----------------------------------

:end

// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin UmschaltMultiButton4fach(ID, Icon,GA1, StatusGA1,GA2,StatusGA2, GA3,StatusGA3, GA4,StatusGA4)
:info $Einen Multibutton (Elemente: mbutton, mshifter)  mit einer vierfachen Auswahlbox ansteuern. Die Gruppenadressen müssen Schaltelemente sein, d.h. \\
Datentyp b01.$\\
         :$(Zahl zwischen 0 und 39) als ID des Elements$\\
         :$Icon des Elements$Knopfes$\\
         :$1. Gruppenadresse des Knopfes (b01)$\\
         :$1. Status-Gruppenadresse des Knopfes (b01)$ \\
         :$2. Gruppenadresse des Knopfes (b01)$\\
         :$2. Status-Gruppenadresse des Knopfes (b01)$\\
         :$3. Gruppenadresse des Knopfes (b01)$\\
         :$3. Status-Gruppenadresse des Knopfes (b01)$ \\
         :$4. Gruppenadresse des Knopfes (b01)$\\
         :$4. Status-Gruppenadresse des Knopfes (b01)$
:shortinfo $Implementierung eines mbutton oder mshifter mit vier GA$

//----------------------------------
// Implementierung
m^ID_Text=$AUS$
m^ID_ICON=LIGHT
m^ID_State=ACTIVE
m^ID_Deko=GREY
m^ID_Choice=1
if mbutton(ID,1)==255 then {
	m^ID_Choice=1
} endif   
if mbutton(ID,2)==255 then {
	m^ID_Choice=2
} endif   
if mbutton(ID,3)==255 then {
	m^ID_Choice=3
} endif   
if mbutton(ID,4)==255 then {
	m^ID_Choice=4
} endif   
if change(m^ID_ICON) or change(m^ID_State) or change(m^ID_Deko) or change(m^ID_Choice) then {
	display(ID,m^ID_Text,m^ID_ICON,m^ID_State,m^ID_Deko,m^ID_Choice) 
} endif 
if mbutton(ID,1)==1 then {
	write(GA1,!StatusGA1)
} endif   
if mbutton(ID,2)==1 then {
	write(GA2,!StatusGA2)
} endif   
if mbutton(ID,3)==1 then {
	write(GA3,!StatusGA3)
} endif   
if mbutton(ID,4)==1 then {
	write(GA4,!StatusGA4)
} endif   

if StatusGA1 and m^ID_Choice==1 then { 
	m^ID_Text=$EIN$;
	m^ID_Deko=GREEN;
	m^ID_State=ACTIVE
} endif 
if !StatusGA1 and m^ID_Choice==1 then { 
	m^ID_Text=$AUS$;
	m^ID_Deko=GREY;
	m^ID_State=INACTIVE
} endif 
if StatusGA2 and m^ID_Choice==2 then { 
	m^ID_Text=$EIN$;
	m^ID_Deko=GREEN;
	m^ID_State=ACTIVE
} endif 
if !StatusGA2 and m^ID_Choice==2 then { 
	m^ID_Text=$AUS$;
	m^ID_Deko=GREY;
	m^ID_State=INACTIVE
} endif 
if StatusGA3 and m^ID_Choice==3 then { 
	m^ID_Text=$EIN$;
	m^ID_Deko=GREEN;
	m^ID_State=ACTIVE
} endif
if !StatusGA3 and m^ID_Choice==3 then { 
	m^ID_Text=$AUS$;
	m^ID_Deko=GREY;
	m^ID_State=INACTIVE
} endif 
if StatusGA4 and m^ID_Choice==4 then { 
	m^ID_Text=$EIN$;
	m^ID_Deko=GREEN;
	m^ID_State=ACTIVE
} endif
if !StatusGA4 and m^ID_Choice==4 then { 
	m^ID_Text=$AUS$;
	m^ID_Deko=GREY;
	m^ID_State=INACTIVE
} endif 
//----------------------------------

:end


// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin UmschaltMultiPageButton2fach(ID, PageID, Icon, GA1,StatusGA1, GA2,StatusGA2)
:info $Einen seitenbezogenen Multibutton (Elemente: mpbutton, mpshifter)  mit einer zweifachen Auswahlbox ansteuern. Die Gruppenadressen müssen Schaltelemente sein, d.h. \\
Datentyp b01.$\\
         :$Zahl zwischen 0 und 39 oder ID-Variable des Elements$\\
         :$Icon des Elements$Knopfes$\\
         :$Zahl zwischen 0 und 99 oder ID-Variable der Seite, auf der das Element definiert wurde.$\\
         :$1. Gruppenadresse des Knopfes (b01)$\\
         :$1. Status-Gruppenadresse des Knopfes (b01)$\\
         :$2. Gruppenadresse des Knopfes (b01)$\\
         :$2. Status-Gruppenadresse des Knopfes (b01)$
:shortinfo $Implementierung eines mpbutton oder mpshifter mit zwei GA$
//----------------------------------
// Implementierung
m^ID_^PageID_Text=$AUS$
m^ID_^PageID_ICON=Icon
m^ID_^PageID_State=ACTIVE
m^ID_^PageID_Deko=GREY
m^ID_^PageID_Choice=1
if mpbutton(ID,1,PageID)==255 then {
	m^ID_^PageID_Choice=1
} endif   
if mpbutton(ID,2,PageID)==255 then {
	m^ID_^PageID_Choice=2
} endif   
if mpbutton(ID,3,PageID)==255 then {
	m^ID_^PageID_Choice=3
} endif   
if change(m^ID_^PageID_ICON) or change(m^ID_^PageID_State) or change(m^ID_^PageID_Deko) or change(m^ID_^PageID_Choice) then {
	pdisplay(ID,m^ID_^PageID_Text,m^ID_^PageID_ICON,m^ID_^PageID_State,m^ID_^PageID_Deko,PageID,m^ID_^PageID_Choice) 
} endif 

if mpbutton(ID,1,PageID)==1 then {
	write(GA1,!StatusGA1)
} endif   
if mpbutton(ID,2,PageID)==1 then {
	write(GA2,!StatusGA2)
} endif   

if StatusGA1 and m^ID_^PageID_Choice==1 then { 
	m^ID_^PageID_Text=$ EIN - $+CLOCK_STRING;
	m^ID_^PageID_Deko=GREEN;
	m^ID_^PageID_State=ACTIVE
} endif 
if !StatusGA1 and m^ID_^PageID_Choice==1 then { 
	m^ID_^PageID_Text=$ AUS - $+CLOCK_STRING;
	m^ID_^PageID_Deko=GREY;
	m^ID_^PageID_State=INACTIVE
} endif 
if StatusGA2 and m^ID_^PageID_Choice==2 then { 
	m^ID_^PageID_Text=$ EIN - $+CLOCK_STRING;
	m^ID_^PageID_Deko=GREEN;
	m^ID_^PageID_State=ACTIVE
} endif 
if !StatusGA2 and m^ID_^PageID_Choice==2 then { 
	m^ID_^PageID_Text=$ AUS - $+CLOCK_STRING;
	m^ID_^PageID_Deko=GREY;
	m^ID_^PageID_State=INACTIVE
} endif 
//----------------------------------

:end



// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin UmschaltMultiPageButton3fach(ID, PageID, Icon, GA1, StatusGA1,GA2,StatusGA2, GA3,StatusGA3)
:info $Einen seitenbezogenen Multibutton (Elemente: mpbutton, mpshifter)  mit einer dreifachen Auswahlbox ansteuern. Die Gruppenadressen müssen Schaltelemente sein, d.h. \\
Datentyp b01.$\\
         :$Zahl zwischen 0 und 39 oder ID-Variable des Elements$\\
         :$Zahl zwischen 0 und 99 oder ID-Variable der Seite, auf der das Element definiert wurde.$\\
         :$Icon des Elements$Knopfes$\\
	 :$Darzustellendes Symbol$ \\
         :$1. Gruppenadresse des Knopfes (b01)$\\
         :$1. Status-Gruppenadresse des Knopfes (b01)$\\
         :$2. Gruppenadresse des Knopfes (b01)$\\
         :$2. Status-Gruppenadresse des Knopfes (b01)$\\
         :$3. Gruppenadresse des Knopfes (b01)$\\
         :$3. Status-Gruppenadresse des Knopfes (b01)$
:shortinfo $Implementierung eines mpbutton oder mpshifter mit drei GA$

//----------------------------------
// Implementierung
m^ID_^PageID_Text=$AUS$
m^ID_^PageID_ICON=Icon
m^ID_^PageID_State=ACTIVE
m^ID_^PageID_Deko=GREY
m^ID_^PageID_Choice=1
if mpbutton(ID,1,PageID)==255 then {
	m^ID_^PageID_Choice=1
} endif   
if mpbutton(ID,2,PageID)==255 then {
	m^ID_^PageID_Choice=2
} endif   
if mpbutton(ID,3,PageID)==255 then {
	m^ID_^PageID_Choice=3
} endif   
if change(m^ID_^PageID_ICON) or change(m^ID_^PageID_State) or change(m^ID_^PageID_Deko) or change(m^ID_^PageID_Choice) then {
	pdisplay(ID,m^ID_^PageID_Text,m^ID_^PageID_ICON,m^ID_^PageID_State,m^ID_^PageID_Deko,PageID,m^ID_^PageID_Choice) 
} endif 

if mpbutton(ID,1,PageID)==1 then {
	write(GA1,!StatusGA1)
} endif   
if mpbutton(ID,2,PageID)==1 then {
	write(GA2,!StatusGA2)
} endif   
if mpbutton(ID,3,PageID)==1 then {
	write(GA3,!StatusGA3)
} endif   

if StatusGA1 and m^ID_^PageID_Choice==1 then { 
	m^ID_^PageID_Text=$ EIN - $+CLOCK_STRING;
	m^ID_^PageID_Deko=GREEN;
	m^ID_^PageID_State=ACTIVE
} endif 
if !StatusGA1 and m^ID_^PageID_Choice==1 then { 
	m^ID_^PageID_Text=$ AUS - $+CLOCK_STRING;
	m^ID_^PageID_Deko=GREY;
	m^ID_^PageID_State=INACTIVE
} endif 
if StatusGA2 and m^ID_^PageID_Choice==2 then { 
	m^ID_^PageID_Text=$ EIN - $+CLOCK_STRING;
	m^ID_^PageID_Deko=GREEN;
	m^ID_^PageID_State=ACTIVE
} endif 
if !StatusGA2 and m^ID_^PageID_Choice==2 then { 
	m^ID_^PageID_Text=$ AUS - $+CLOCK_STRING;
	m^ID_^PageID_Deko=GREY;
	m^ID_^PageID_State=INACTIVE
} endif 
if StatusGA3 and m^ID_^PageID_Choice==3 then { 
	m^ID_^PageID_Text=$ EIN - $+CLOCK_STRING;
	m^ID_^PageID_Deko=GREEN;
	m^ID_^PageID_State=ACTIVE
} endif
if !StatusGA3 and m^ID_^PageID_Choice==3 then { 
	m^ID_^PageID_Text=$ AUS - $+CLOCK_STRING;
	m^ID_^PageID_Deko=GREY;
	m^ID_^PageID_State=INACTIVE
} endif 
//----------------------------------

:end

// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin UmschaltMultiPageButton4fach(ID, PageID, Icon, GA1, StatusGA1, GA2, StatusGA2, GA3, StatusGA3, GA4,StatusGA4)
:info $Einen seitenbezogenen Multibutton (Elemente: mpbutton, mpshifter)  mit einer vierfachen Auswahlbox ansteuern. Die Gruppenadressen müssen Schaltelemente sein, d.h. \\
Datentyp b01.$\\
         :$Zahl zwischen 0 und 39 oder ID-Variable des Elements$\\
         :$Zahl zwischen 0 und 99 oder ID-Variable der Seite, auf der das Element definiert wurde.$\\
		 :$Darzustellendes Symbol$ \\
         :$1. Gruppenadresse des Knopfes (b01)$\\
         :$1. Status-Gruppenadresse des Knopfes (b01)$ \\
         :$2. Gruppenadresse des Knopfes (b01)$\\
         :$2. Status-Gruppenadresse des Knopfes (b01)$\\
         :$3. Gruppenadresse des Knopfes (b01)$\\
         :$3. Status-Gruppenadresse des Knopfes (b01)$ \\
         :$4. Gruppenadresse des Knopfes (b01)$\\
         :$4. Status-Gruppenadresse des Knopfes (b01)$
:shortinfo $Implementierung eines mpbutton oder mpshifter mit vier GA$

//----------------------------------
// Implementierung
m^ID_^PageID_Text=$ AUS - $+CLOCK_STRING
m^ID_^PageID_ICON=Icon
m^ID_^PageID_State=ACTIVE
m^ID_^PageID_Deko=GREY
m^ID_^PageID_Choice=1
if mpbutton(ID,1,PageID)==255 then {
	m^ID_^PageID_Choice=1
} endif   
if mpbutton(ID,2,PageID)==255 then {
	m^ID_^PageID_Choice=2
} endif   
if mpbutton(ID,3,PageID)==255 then {
	m^ID_^PageID_Choice=3
} endif   
if mpbutton(ID,4,PageID)==255 then {
	m^ID_^PageID_Choice=4
} endif   
if change(m^ID_^PageID_ICON) or change(m^ID_^PageID_State) or change(m^ID_^PageID_Deko) or change(m^ID_^PageID_Choice) then {
	pdisplay(ID,m^ID_^PageID_Text,m^ID_^PageID_ICON,m^ID_^PageID_State,m^ID_^PageID_Deko,PageID,m^ID_^PageID_Choice) 
} endif 

if mpbutton(ID,1,PageID)==1 then {
	write(GA1,!StatusGA1)
} endif   
if mpbutton(ID,2,PageID)==1 then {
	write(GA2,!StatusGA2)
} endif   
if mpbutton(ID,3,PageID)==1 then {
	write(GA3,!StatusGA3)
} endif   
if mpbutton(ID,4,PageID)==1 then {
	write(GA4,!StatusGA4)
} endif   

if StatusGA1 and m^ID_^PageID_Choice==1 then { 
	m^ID_^PageID_Text=$ EIN - $+CLOCK_STRING;
	m^ID_^PageID_Deko=GREEN;
	m^ID_^PageID_State=ACTIVE
} endif 
if !StatusGA1 and m^ID_^PageID_Choice==1 then { 
	m^ID_^PageID_Text=$ AUS - $+CLOCK_STRING;
	m^ID_^PageID_Deko=GREY;
	m^ID_^PageID_State=INACTIVE
} endif 
if StatusGA2 and m^ID_^PageID_Choice==2 then { 
	m^ID_^PageID_Text=$ EIN - $+CLOCK_STRING;
	m^ID_^PageID_Deko=GREEN;
	m^ID_^PageID_State=ACTIVE
} endif 
if !StatusGA2 and m^ID_^PageID_Choice==2 then { 
	m^ID_^PageID_Text=$ AUS - $+CLOCK_STRING;
	m^ID_^PageID_Deko=GREY;
	m^ID_^PageID_State=INACTIVE
} endif 
if StatusGA3 and m^ID_^PageID_Choice==3 then { 
	m^ID_^PageID_Text=$ EIN - $+CLOCK_STRING;
	m^ID_^PageID_Deko=GREEN;
	m^ID_^PageID_State=ACTIVE
} endif
if !StatusGA3 and m^ID_^PageID_Choice==3 then { 
	m^ID_^PageID_Text=$ AUS - $+CLOCK_STRING;
	m^ID_^PageID_Deko=GREY;
	m^ID_^PageID_State=INACTIVE
} endif 
if StatusGA4 and m^ID_^PageID_Choice==4 then { 
	m^ID_^PageID_Text=$ EIN - $+CLOCK_STRING;
	m^ID_^PageID_Deko=GREEN;
	m^ID_^PageID_State=ACTIVE
} endif
if !StatusGA4 and m^ID_^PageID_Choice==4 then { 
	m^ID_^PageID_Text=$ AUS - $+CLOCK_STRING;
	m^ID_^PageID_Deko=GREY;
	m^ID_^PageID_State=INACTIVE
} endif 
//----------------------------------
:end


// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin Rollo(ID, PageID, GA1, GA1Stop)
:info $Eine Rollosteuerung mit  einem seitenbezogenen Shifter (pshifter) ansteuern. Die Gruppenadressen müssen Schaltelemente sein, d.h. Datentyp b01.\\
Der pshifter sollte folgende Form haben(§ mit Dollarzeichen ersetzen): pshifter(RolloID)[UP,BLIND,DOWN]§Rollo§\\
		siehe Beispiel Rollo.epc$\\
         :$Zahl zwischen 0 und 39 als ID des pshifters$\\
         :$Zahl zwischen 0 und 99 als ID der Seite, auf der der pshifter definiert wurde.$\\
         :$Auf/Ab Gruppenadresse des Rollos (b01)$\\
	 :$Stop Gruppenadresse des Rollos (b01)$
:shortinfo $Rollosteuerung für einen Rollo$

//----------------------------------
// Implementierung von Name
m_^ID_^PageID_Text=$$
m_^ID_^PageID_ICON=BLIND
m_^ID_^PageID_State=ACTIVE
m_^ID_^PageID_Deko=GREY
m_^ID_^PageID_Counter=0

if after(systemstart(),3000u64) then pdisplay(ID,m_^ID_^PageID_Text,m_^ID_^PageID_ICON,m_^ID_^PageID_State,m_^ID_^PageID_Deko,PageID)  endif

//Rollo wird beim Runterfahren angehalten
if event(GA1) and GA1==EIN then {
   pdisplay(ID,m_^ID_^PageID_Text,STOP,DARKRED,m_^ID_^PageID_Deko,PageID) 
} endif
//Rollo wird beim Hochfahren angehalten
if event(GA1) and GA1==AUS then {
   pdisplay(ID,m_^ID_^PageID_Text,STOP,DARKRED,m_^ID_^PageID_Deko,PageID) 
} endif

//if change(GA1) then {
//   pdisplay(ID,m_^ID_^PageID_Text,STOP,DARKRED,m_^ID_^PageID_Deko,PageID) 
//} endif 

if (delay(change(GA1),30000u64) or event(GA1Stop)) then {
	pdisplay(ID,m_^ID_^PageID_Text,m_^ID_^PageID_ICON,m_^ID_^PageID_State,m_^ID_^PageID_Deko,PageID) 
} endif 
if pbutton(ID,PageID)==1 then {
	write(GA1,AUS)
} endif   
if pbutton(ID,PageID)==3 then {
	write(GA1,EIN)
} endif   
if pbutton(ID,PageID)==2 then {
	write(GA1Stop,EIN)
} endif   
:end 

// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin ZweiRollos(ID, PageID, GA1, GA1Stop,GA2, GA2Stop)
:info $Eine Rollosteuerung mit einem seitenbezogenen Multishifter (mpshifter) mit einer zweifachen Auswahlbox ansteuern. Die Gruppenadressen müssen Schaltelemente sein, d.h. Datentyp b01. Der mpshifter sollte von folgender Form sein(§ mit Dollarzeichen ersetzen): mpshifter(RolloID)[§Rollo 1§,§Rollo 2§][UP,BLIND,DOWN]§Rollo§\\
				  siehe auch Beispiel ZweiRollos.epc$\\
         :$Zahl zwischen 0 und 39 als ID des Elements$\\
         :$Zahl zwischen 0 und 99 als ID der Seite, auf der das Element definiert wurde.$\\
         :$Auf/Ab Gruppenadresse des 1. Rollos (b01)$\\
	 :$Stop Gruppenadresse des 1. Rollos (b01)$\\
	 :$Auf/Ab Gruppenadresse des 2. Rollos (b01)$\\
	 :$Stop Gruppenadresse des 2. Rollos (b01)$
:shortinfo $Rollosteuerung für 2 Rollos$

//----------------------------------
// Implementierung von Name
m_^ID_^PageID_Text=$$
m_^ID_^PageID_ICON=BLIND
m_^ID_^PageID_State=DISPLAY
m_^ID_^PageID_Deko=GREY
m_^ID_^PageID_Choice=1
if mpbutton(ID,1,PageID)==255 then {
	m_^ID_^PageID_Choice=1
} endif   
if mpbutton(ID,2,PageID)==255 then {
	m_^ID_^PageID_Choice=2
} endif   
if after(systemstart(),3000u64) then pdisplay(ID,m_^ID_^PageID_Text,m_^ID_^PageID_ICON,m_^ID_^PageID_State,m_^ID_^PageID_Deko,PageID,m_^ID_^PageID_Choice)  endif

if (change(GA1) or change(m_^ID_^PageID_Choice)) and m_^ID_^PageID_Choice==1 then {
   pdisplay(ID,m_^ID_^PageID_Text,STOP,DARKRED,m_^ID_^PageID_Deko,PageID,m_^ID_^PageID_Choice) 
} endif 
if (delay(change(GA1),30000u64) or change(m_^ID_^PageID_Choice) or event(GA1Stop)) and m_^ID_^PageID_Choice==1 then {
	pdisplay(ID,m_^ID_^PageID_Text,m_^ID_^PageID_ICON,m_^ID_^PageID_State,m_^ID_^PageID_Deko,PageID,m_^ID_^PageID_Choice) 
} endif 
if (change(GA2) or change(m_^ID_^PageID_Choice)) and m_^ID_^PageID_Choice==2 then {
   pdisplay(ID,m_^ID_^PageID_Text,STOP,DARKRED,m_^ID_^PageID_Deko,PageID,m_^ID_^PageID_Choice) 
} endif 
if (delay(change(GA2),30000u64) or change(m_^ID_^PageID_Choice) or event(GA2Stop)) and m_^ID_^PageID_Choice==2 then {
	pdisplay(ID,m_^ID_^PageID_Text,m_^ID_^PageID_ICON,m_^ID_^PageID_State,m_^ID_^PageID_Deko,PageID,m_^ID_^PageID_Choice) 
} endif 

if mpbutton(ID,1,PageID)==1 then {
	write(GA1,AUS)
} endif   
if mpbutton(ID,1,PageID)==3 then {
	write(GA1,EIN)
} endif   
if mpbutton(ID,1,PageID)==2 then {
	write(GA1Stop,EIN)
} endif   
if mpbutton(ID,2,PageID)==2 then {
	write(GA2Stop,EIN)
} endif   
if mpbutton(ID,2,PageID)==1 then {
	write(GA2,AUS)
} endif   
if mpbutton(ID,2,PageID)==3 then {
	write(GA2,EIN)
} endif   

//----------------------------------

:end


// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin DreiRollos(ID,PageID,GA1,GA1Stop,GA2,GA2Stop,GA3,GA3Stop)
:info $Eine Rollosteuerung  mit einem seitenbezogenen Multishifter (mpshifter) mit einer dreifachen Auswahlbox ansteuern. Die Gruppenadressen muessen Schaltelemente sein, d.h. \\
Datentyp b01. $\\
         :$Zahl zwischen 0 und 39 als ID des Elements$\\
         :$Zahl zwischen 0 und 99 als ID der Seite, auf der das Element definiert wurde.$\\
         :$Auf/Ab Gruppenadresse des 1. Rollos (b01)$\\
	 :$Stop Gruppenadresse des 1. Rollos (b01)$\\
	 :$Auf/Ab Gruppenadresse des 2. Rollos (b01)$\\
	 :$Stop Gruppenadresse des 2. Rollos (b01)$\\
	 :$Auf/Ab Gruppenadresse des 3. Rollos (b01)$\\
	 :$Stop Gruppenadresse des 3.Rollos (b01)$
:shortinfo $Rollosteuerung fuer 3 Rollos$

//----------------------------------
// Implementierung von Name
m_^ID_^PageID_Text=$$
m_^ID_^PageID_ICON=BLIND
m_^ID_^PageID_State=ACTIVE
m_^ID_^PageID_Deko=GREY
m_^ID_^PageID_Choice=1
if mpbutton(ID,1,PageID)==255 then {
	m_^ID_^PageID_Choice=1
} endif   
if mpbutton(ID,2,PageID)==255 then {
	m_^ID_^PageID_Choice=2
} endif   
if mpbutton(ID,3,PageID)==255 then {
	m_^ID_^PageID_Choice=3
} endif   

if after(systemstart(),3000u64) then pdisplay(ID,m_^ID_^PageID_Text,m_^ID_^PageID_ICON,m_^ID_^PageID_State,m_^ID_^PageID_Deko,PageID,m_^ID_^PageID_Choice)  endif
if (event(GA1) or change(m_^ID_^PageID_Choice)) and m_^ID_^PageID_Choice==1 then {
   pdisplay(ID,m_^ID_^PageID_Text,STOP,DARKRED,m_^ID_^PageID_Deko,PageID,m_^ID_^PageID_Choice) 
} endif 
if (delay(event(GA1),30000u64) or change(m_^ID_^PageID_Choice) or event(GA1Stop)) and m_^ID_^PageID_Choice==1 then {
	pdisplay(ID,m_^ID_^PageID_Text,m_^ID_^PageID_ICON,m_^ID_^PageID_State,m_^ID_^PageID_Deko,PageID,m_^ID_^PageID_Choice) 
} endif 
if (event(GA2) or change(m_^ID_^PageID_Choice)) and m_^ID_^PageID_Choice==2 then {
   pdisplay(ID,m_^ID_^PageID_Text,STOP,DARKRED,m_^ID_^PageID_Deko,PageID,m_^ID_^PageID_Choice) 
} endif 
if (delay(event(GA2),30000u64) or change(m_^ID_^PageID_Choice) or event(GA2Stop)) and m_^ID_^PageID_Choice==2 then {
	pdisplay(ID,m_^ID_^PageID_Text,m_^ID_^PageID_ICON,m_^ID_^PageID_State,m_^ID_^PageID_Deko,PageID,m_^ID_^PageID_Choice) 
} endif 
if (event(GA3) or change(m_^ID_^PageID_Choice)) and m_^ID_^PageID_Choice==3 then {
   pdisplay(ID,m_^ID_^PageID_Text,STOP,DARKRED,m_^ID_^PageID_Deko,PageID,m_^ID_^PageID_Choice) 
} endif 
if (delay(event(GA3),30000u64) or change(m_^ID_^PageID_Choice) or event(GA3Stop)) and m_^ID_^PageID_Choice==3 then {
	pdisplay(ID,m_^ID_^PageID_Text,m_^ID_^PageID_ICON,m_^ID_^PageID_State,m_^ID_^PageID_Deko,PageID,m_^ID_^PageID_Choice) 
} endif 

if mpbutton(ID,1,PageID)==1 then {
	write(GA1,AUS)
} endif   
if mpbutton(ID,1,PageID)==2 then {
	write(GA1Stop,EIN)
} endif   
if mpbutton(ID,1,PageID)==3 then {
	write(GA1,EIN)
} endif   
if mpbutton(ID,2,PageID)==1 then {
	write(GA2,AUS)
} endif   
if mpbutton(ID,2,PageID)==2 then {
	write(GA2Stop,EIN)
} endif   
if mpbutton(ID,2,PageID)==3 then {
	write(GA2,EIN)
} endif   
if mpbutton(ID,3,PageID)==1 then {
	write(GA3,AUS)
} endif   
if mpbutton(ID,3,PageID)==2 then {
	write(GA3Stop,EIN)
} endif   
if mpbutton(ID,3,PageID)==3 then {
	write(GA3,EIN)
} endif   

//----------------------------------

:end

// Webelement
// @date	31.10.2012
// @version	2 
// @author	Stefanie Meier, Enertex Bayern GmbH
:begin FuenfRollos(ID,PageID,GA1,GA1Stop,GA2,GA2Stop,GA3,GA3Stop,GA4,GA4Stop,GA5,GA5Stop)
:info $Eine Rollosteuerung  mit einem seitenbezogenen Multishifter (mpshifter) mit einer fuenffachen Auswahlbox ansteuern. Die Gruppenadressen muessen Schaltelemente sein, d.h. \\
Datentyp b01. $\\
         :$Zahl zwischen 0 und 39 als ID des Elements$\\
         :$Zahl zwischen 0 und 99 als ID der Seite, auf der das Element definiert wurde.$\\
         :$Auf/Ab Gruppenadresse des 1. Rollos (b01)$\\
	 :$Stop Gruppenadresse des 1. Rollos (b01)$\\
	 :$Auf/Ab Gruppenadresse des 2. Rollos (b01)$\\
	 :$Stop Gruppenadresse des 2. Rollos (b01)$\\
	 :$Auf/Ab Gruppenadresse des 3. Rollos (b01)$\\
	 :$Stop Gruppenadresse des 3.Rollos (b01)$\\
	 :$Auf/Ab Gruppenadresse des 4. Rollos (b01)$\\
	 :$Stop Gruppenadresse des 4.Rollos (b01)$\\
	 :$Auf/Ab Gruppenadresse des 5. Rollos (b01)$\\
	 :$Stop Gruppenadresse des 5.Rollos (b01)$
:shortinfo $Rollosteuerung fuer 5 Rollos$

//----------------------------------
// Implementierung von Name
m_^ID_^PageID_Text=$$
m_^ID_^PageID_ICON=BLIND
m_^ID_^PageID_State=ACTIVE
m_^ID_^PageID_Deko=GREY
m_^ID_^PageID_Choice=1
if mpbutton(ID,1,PageID)==255 then {
	m_^ID_^PageID_Choice=1
} endif   
if mpbutton(ID,2,PageID)==255 then {
	m_^ID_^PageID_Choice=2
} endif   
if mpbutton(ID,3,PageID)==255 then {
	m_^ID_^PageID_Choice=3
} endif   
if mpbutton(ID,4,PageID)==255 then {
	m_^ID_^PageID_Choice=4
} endif   
if mpbutton(ID,5,PageID)==255 then {
	m_^ID_^PageID_Choice=5
} endif   

if after(systemstart(),3000u64) then pdisplay(ID,m_^ID_^PageID_Text,m_^ID_^PageID_ICON,m_^ID_^PageID_State,m_^ID_^PageID_Deko,PageID,m_^ID_^PageID_Choice)  endif

if (event(GA1) or change(m_^ID_^PageID_Choice)) and m_^ID_^PageID_Choice==1 then {
   pdisplay(ID,m_^ID_^PageID_Text,STOP,DARKRED,m_^ID_^PageID_Deko,PageID,m_^ID_^PageID_Choice) 
} endif 
if (delay(event(GA1),30000u64) or change(m_^ID_^PageID_Choice) or event(GA1Stop)) and m_^ID_^PageID_Choice==1 then {
	pdisplay(ID,m_^ID_^PageID_Text,m_^ID_^PageID_ICON,m_^ID_^PageID_State,m_^ID_^PageID_Deko,PageID,m_^ID_^PageID_Choice) 
} endif 

if (event(GA2) or change(m_^ID_^PageID_Choice)) and m_^ID_^PageID_Choice==2 then {
   pdisplay(ID,m_^ID_^PageID_Text,STOP,DARKRED,m_^ID_^PageID_Deko,PageID,m_^ID_^PageID_Choice) 
} endif 
if (delay(event(GA2),30000u64) or change(m_^ID_^PageID_Choice) or event(GA2Stop)) and m_^ID_^PageID_Choice==2 then {
	pdisplay(ID,m_^ID_^PageID_Text,m_^ID_^PageID_ICON,m_^ID_^PageID_State,m_^ID_^PageID_Deko,PageID,m_^ID_^PageID_Choice) 
} endif 

if (event(GA3) or change(m_^ID_^PageID_Choice)) and m_^ID_^PageID_Choice==3 then {
   pdisplay(ID,m_^ID_^PageID_Text,STOP,DARKRED,m_^ID_^PageID_Deko,PageID,m_^ID_^PageID_Choice) 
} endif 
if (delay(event(GA3),30000u64) or change(m_^ID_^PageID_Choice) or event(GA3Stop)) and m_^ID_^PageID_Choice==3 then {
	pdisplay(ID,m_^ID_^PageID_Text,m_^ID_^PageID_ICON,m_^ID_^PageID_State,m_^ID_^PageID_Deko,PageID,m_^ID_^PageID_Choice) 
} endif 

if (event(GA4) or change(m_^ID_^PageID_Choice)) and m_^ID_^PageID_Choice==4 then {
   pdisplay(ID,m_^ID_^PageID_Text,STOP,DARKRED,m_^ID_^PageID_Deko,PageID,m_^ID_^PageID_Choice) 
} endif 
if (delay(event(GA4),30000u64) or change(m_^ID_^PageID_Choice) or event(GA4Stop)) and m_^ID_^PageID_Choice==4 then {
	pdisplay(ID,m_^ID_^PageID_Text,m_^ID_^PageID_ICON,m_^ID_^PageID_State,m_^ID_^PageID_Deko,PageID,m_^ID_^PageID_Choice) 
} endif 

if (event(GA5) or change(m_^ID_^PageID_Choice)) and m_^ID_^PageID_Choice==5 then {
   pdisplay(ID,m_^ID_^PageID_Text,STOP,DARKRED,m_^ID_^PageID_Deko,PageID,m_^ID_^PageID_Choice) 
} endif 

if (delay(event(GA5),30000u64) or change(m_^ID_^PageID_Choice) or event(GA5Stop)) and m_^ID_^PageID_Choice==5 then {
	pdisplay(ID,m_^ID_^PageID_Text,m_^ID_^PageID_ICON,m_^ID_^PageID_State,m_^ID_^PageID_Deko,PageID,m_^ID_^PageID_Choice) 
} endif 

if mpbutton(ID,1,PageID)==1 then {
	write(GA1,AUS)
} endif   
if mpbutton(ID,1,PageID)==2 then {
	write(GA1Stop,EIN)
} endif   
if mpbutton(ID,1,PageID)==3 then {
	write(GA1,EIN)
} endif   
if mpbutton(ID,2,PageID)==1 then {
	write(GA2,AUS)
} endif   
if mpbutton(ID,2,PageID)==2 then {
	write(GA2Stop,EIN)
} endif   
if mpbutton(ID,2,PageID)==3 then {
	write(GA2,EIN)
} endif   
if mpbutton(ID,3,PageID)==1 then {
	write(GA3,AUS)
} endif   
if mpbutton(ID,3,PageID)==2 then {
	write(GA3Stop,EIN)
} endif   
if mpbutton(ID,3,PageID)==3 then {
	write(GA3,EIN)
} endif   
if mpbutton(ID,4,PageID)==1 then {
	write(GA4,AUS)
} endif   
if mpbutton(ID,4,PageID)==2 then {
	write(GA4Stop,EIN)
} endif   
if mpbutton(ID,4,PageID)==3 then {
	write(GA4,EIN)
} endif   
if mpbutton(ID,5,PageID)==1 then {
	write(GA5,AUS)
} endif   
if mpbutton(ID,5,PageID)==2 then {
	write(GA5Stop,EIN)
} endif   
if mpbutton(ID,5,PageID)==3 then {
	write(GA5,EIN)
} endif   

:end

// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin UmschaltButton(ID, PageID, GA, StatusGA, ICON)
:info $Einen seitenbezogenen Button mit (Elemente: pbutton, pshifter) einer Schaltmöglichkeit ansteuern. Beim Knopfdruck wird umgeschaltet. \\
Datentyp der Gruppenaddresse b01. Die Schaltzeit der letzten Betätigung wird mit aufgezeichnet. Haben Sie keine Status-Gruppenadresse, geben sie an dieser \\
Stelle einfach nochmals die Schaltgruppenadresse vor. Beachten Sie, dass Statusaddressen eine gewisse Zeit benötigen, bis diese vom Bus aktualisiert \\
zurückgemeldet werden. U.u. ist der Webserver hier schneller als die Rückmeldung und der Status erst nach dem nächsten Refresh angezeigt. Die Anzeige ist für einen Button optimiert.$\\
         :$ID des Elements$\\
         :$SeitenID$\\
         :$Gruppenadresse des EIN/AUS Schaltelements (b01)$\\
         :$Status des Aktors (b01)$\\
	 :$ICON$
:shortinfo $Implementierung eines Um-Schalters ("Toggle")$
initga(StatusGA)
if pbutton(ID,PageID)==1 then {
   write(GA,!StatusGA)
} endif   
if StatusGA then {
 	pdisplay(ID,CLOCK_STRING,ICON,ACTIVE,GREEN,PageID) 
} else {
 	pdisplay(ID,CLOCK_STRING,ICON,INACTIVE,GREY,PageID) 
} endif
:end


// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin UmschaltButtonFenster(ID, PageID, GA, StatusGA, ICON)
:info $Einen seitenbezogenen Button mit (Elemente: pbutton, pshifter) einer Schaltmöglichkeit ansteuern. Beim Knopfdruck wird umgeschaltet. \\
Datentyp der Gruppenaddresse b01. Die Schaltzeit der letzten Betätigung wird mit aufgezeichnet. Haben Sie keine Status-Gruppenadresse, geben sie an dieser \\
Stelle einfach nochmals die Schaltgruppenadresse vor. Beachten Sie, dass Statusaddressen eine gewisse Zeit benötigen, bis diese vom Bus aktualisiert \\
zurückgemeldet werden. U.u. ist der Webserver hier schneller als die Rückmeldung und der Status erst nach dem nächsten Refresh angezeigt. Die Anzeige ist für einen Button optimiert.$\\
         :$ID des Elements$\\
         :$SeitenID$\\
         :$Gruppenadresse des EIN/AUS Schaltelements (b01)$\\
         :$Status des Aktors (b01)$\\
	 :$ICON$
:shortinfo $Implementierung eines Um-Schalters ("Toggle")$
initga(StatusGA)
if pbutton(ID,PageID)==1 then {
   write(GA,!StatusGA)
} endif   
if StatusGA then {
 	pdisplay(ID,CLOCK_STRING,ICON,STATE5,GREEN,PageID) 
} else {
 	pdisplay(ID,CLOCK_STRING,ICON,INACTIVE,GREY,PageID) 
} endif
:end



// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin UmschaltButtonZustand(ID, PageID, GA, StatusGA, ICON,Aktiv,InAktiv)
:info $Einen seitenbezogenen Button mit (Elemente: pbutton, pshifter) einer Schaltmöglichkeit ansteuern. Beim Knopfdruck wird umgeschaltet. \\
Datentyp der Gruppenaddresse b01. Die Schaltzeit der letzten Betätigung wird mit aufgezeichnet. Haben Sie keine Status-Gruppenadresse, geben sie an dieser \\
Stelle einfach nochmals die Schaltgruppenadresse vor. Beachten Sie, dass Statusaddressen eine gewisse Zeit benötigen, bis diese vom Bus aktualisiert\\
zurückgemeldet werden. U.u. ist der Webserver hier schneller als die Rückmeldung und der Status erst nach dem nächsten Refresh angezeigt. Die Anzeige ist für einen Button optimiert, \\
wobei der ICON-Zustand für EIN und AUS angegeben werden kann$\\
         :$ID des Elements$\\
         :$SeitenID$\\
         :$Gruppenadresse des EIN/AUS Schaltelements (b01)$\\
         :$Status des Aktors (b01)$\\
	 :$ICON$\\
         :$EIN-Zustand des ICONs$\\
         :$AUS-Zustand des ICONs$
:shortinfo $Implementierung eines Um-Schalters mit Angabe der Zustände des Icons$
initga(StatusGA)
if pbutton(ID,PageID)==1 then {
   write(GA,!StatusGA)
} endif   
if StatusGA then {
 	pdisplay(ID,CLOCK_STRING,ICON,Aktiv,GREEN,PageID) 
} else {
 	pdisplay(ID,CLOCK_STRING,ICON,InAktiv,GREY,PageID) 
} endif
:end

// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin ToggleButtonVar(ID, PageID, Var, ICON,Aktiv,InAktiv)
:info $Einen seitenbezogenen Button mit (Elemente: pbutton, pshifter) einer Schaltmöglichkeit ansteuern. Beim Knopfdruck wird umgeschaltet. \\
Datentyp der Variable b01. Die Schaltzeit der letzten Betätigung wird mit aufgezeichnet. Die Anzeige ist für einen Button optimiert, \\
wobei der ICON-Zustand für EIN und AUS angegeben werden kann$\\
         :$ID des Elements$\\
         :$SeitenID$\\
         :$Variable des EIN/AUS Schaltelements (b01)$\\
         :$ICON$\\
         :$EIN-Zustand des ICONs$\\
         :$AUS-Zustand des ICONs$
:shortinfo $Implementierung eines Um-Schalters mit Angabe der Zustände des Icons$

if systemstart() then pdisplay(ID,CLOCK_STRING,ICON,Aktiv,GREY,PageID) endif
if pbutton(ID,PageID)==1 then {
   Var=!Var
} endif
if Var then {
	pdisplay(ID,CLOCK_STRING,ICON,Aktiv,GREEN,PageID)
} else {
	pdisplay(ID,CLOCK_STRING,ICON,InAktiv,GREY,PageID)
} endif

:end




// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin UmschaltShifter(ID, PageID, GA, StatusGA, ICON)
:info $Einen seitenbezogenen Button mit (Elemente: pbutton, pshifter) mit einer Schaltmöglichkeit ansteuern. Beim Knopfdruck wird umgeschaltet. \\
Datentyp der Gruppenaddresse b01. Die Schaltzeit der letzten Betätigung wird mit aufgezeichnet. Haben Sie keine Status-Gruppenadresse, geben sie an dieser \\
Stelle einfach nochmals die Schaltgruppenadresse vor. Beachten Sie, dass Statusaddressen eine gewisse Zeit benötigen, bis diese vom Bus aktualisiert\\
zurückgemeldet werden. U.u. ist der Webserver hier schneller als die Rückmeldung und der Status erst nach dem nächsten Refresh angezeigt.$\\
         :$ID des Elements$\\
         :$SeitenID$\\
         :$Gruppenadresse des EIN/AUS Schaltelements (b01)$\\
         :$Status des Aktors (b01)$\\
	 :$Icon$
:shortinfo $Implementierung eines Um-Schalters mit Datumsangabe$
initga(StatusGA)

if pbutton(ID,PageID)==1 then write(GA,!StatusGA) endif

if StatusGA then {
 	pdisplay(ID,CLOCKDATE_STRING,ICON,ACTIVE,GREEN,PageID) 
} else {
 	pdisplay(ID,CLOCKDATE_STRING,ICON,INACTIVE,GREY,PageID) 
} endif
:end

// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin UmschaltShifterZustand(ID, PageID, GA, StatusGA, ICON,Aktiv,InAktiv)
:info $Einen seitenbezogenen Button mit (Elemente: pbutton, pshifter) mit einer Schaltmöglichkeit ansteuern. Beim Knopfdruck wird umgeschaltet. \\
Datentyp der Gruppenaddresse b01. Die Schaltzeit der letzten Betätigung wird mit aufgezeichnet. Haben Sie keine Status-Gruppenadresse, geben sie an dieser \\
Stelle einfach nochmals die Schaltgruppenadresse vor. Beachten Sie, dass Statusaddressen eine gewisse Zeit benötigen, bis diese vom Bus aktualisiert\\
zurückgemeldet werden. U.u. ist der Webserver hier schneller als die Rückmeldung und der Status erst nach dem nächsten Refresh angezeigt,wobei der ICON-Zustand für EIN und AUS angegeben werden kann.$\\
         :$ID des Elements$\\
         :$SeitenID$\\
         :$Gruppenadresse des EIN/AUS Schaltelements (b01)$\\
         :$Status des Aktors (b01)$\\
	 :$Icon$\\
         :$EIN-Zustand des ICONs$\\
         :$AUS-Zustand des ICONs$
:shortinfo $Implementierung eines Um-Schalters mit Datumsangabe und Angabe der Zustände des Icons$
initga(StatusGA)
if pbutton(ID,PageID)==1 then {
   write(GA,!StatusGA)
} endif   
if StatusGA then {
 	pdisplay(ID,CLOCKDATE_STRING,ICON,Aktiv,GREEN,PageID) 
} else {
 	pdisplay(ID,CLOCKDATE_STRING,ICON,InAktiv,GREY,PageID) 
} endif
:end

// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin UmschaltShifter2Fach(ID,PageID,GA1,GA2,ICON,Text,Value)
:info $Einen seitenbezogenen Button mit (Elemente: pbutton, pshifter) mit zwei Schaltmöglichkeiten ansteuern. Beim Knopfdruck wird umgeschaltet. \\
Datentyp der Gruppenaddresse b01.$\\
         :$ID des Elements$\\
         :$SeitenID$\\
         :$Gruppenadresse des 1. EIN/AUS Schaltelements (b01)$\\
         :$Gruppenadresse des 2. EIN/AUS Schaltelements (b01)$\\
	 :$ICON, es sollte das bei der Webserver Konfiguration als 2. Icon genannte verwendet werden$\\
	 :$Statischer Text für die 1. Zeile$\\
	 :$Variable oder Gruppenadresse, dessen Wert angezeigt werden soll$
:shortinfo $Implementierung eines Um-Schalters mit zwei Elementen$
initga(GA1)
initga(GA2)

if pbutton(ID,PageID)==1 then {
   write(GA1,!GA1)
} endif   

if pbutton(ID,PageID)==2 then {
   write(GA2,!GA2)
} endif
if event(GA1) then {
 	pdisplay(ID,convert(Text,$$c14)+$:$c14+convert(Value,$$c14),ICON,INACTIVE,GREEN,PageID)
} endif
if event(GA2) then {
 	pdisplay(ID,convert(Text,$$c14)+$:$c14+convert(Value,$$c14),ICON,INACTIVE,GREEN,PageID) 
} endif

:end


// Webelement
// @date	31.10.2012
// @version	2 
// @author	Stefanie Meier, Enertex Bayern GmbH
:begin UmschaltShifterZentralmit2GA(ID,PageID, GA, GA1,GA2, ICON)
:info $Einen seitenbezogenen Button mit (Elemente: pbutton, pshifter) mit einer Schaltmöglichkeit ansteuern. Beim Knopfdruck wird GA umgeschaltet. GA1 und GA2 passen ihren Status an.\\
z.B. GA = Alle Lichter, GA1 = Licht1, GA2= Licht2.\\
Datentyp der Gruppenaddresse b01. Die Schaltzeit der letzten Betätigung wird mit aufgezeichnet. Haben Sie keine Status-Gruppenadresse, geben sie an dieser \\
Stelle einfach nochmals die Schaltgruppenadresse vor. Beachten Sie, dass Statusaddressen eine gewisse Zeit benötigen, bis diese vom Bus aktualisiert\\
zurückgemeldet werden. U.u. ist der Webserver hier schneller als die Rückmeldung und der Status erst nach dem nächsten Refresh angezeigt.$\\
         :$ID des Elements$\\
         :$SeitenID$\\
         :$Gruppenadresse des EIN/AUS Schaltelements (b01)$\\
         :$GA1 (b01)$\\
         :$GA2 (b01)$\\
	 :$Icon$
:shortinfo $Implementierung eines Um-Schalters mit Datumsangabe und Statusanpassung abhängiger GAs$

initga(GA)

if pbutton(ID,PageID)==1 then write(GA,!GA) endif

if !GA1 and !GA2 then write(GA,AUS) endif
if GA1 and GA2 then write(GA,EIN) endif

if GA then {
 	pdisplay(ID,CLOCKDATE_STRING,ICON,ACTIVE,GREEN,PageID);
	write(GA1,EIN);
	write(GA2,EIN)
} else {
 	pdisplay(ID,CLOCKDATE_STRING,ICON,INACTIVE,GREY,PageID);
	write(GA1,AUS);
	write(GA2,AUS)
} endif
:end

// Webelement
// @date	31.10.2012
// @version	2 
// @author	Stefanie Meier, Enertex Bayern GmbH
:begin UmschaltShifterZentralmit3GA(ID,PageID, GA, GA1,GA2,GA3, ICON)
:info $Einen seitenbezogenen Button mit (Elemente: pbutton, pshifter) mit einer Schaltmöglichkeit ansteuern. Beim Knopfdruck wird GA umgeschaltet. GA1, GA2 und GA3 passen ihren Status an.\\
z.B. GA = Alle Lichter, GA1 = Licht1, GA2= Licht2, GA3=Licht3.\\
Datentyp der Gruppenaddresse b01. Die Schaltzeit der letzten Betätigung wird mit aufgezeichnet. Haben Sie keine Status-Gruppenadresse, geben sie an dieser \\
Stelle einfach nochmals die Schaltgruppenadresse vor. Beachten Sie, dass Statusaddressen eine gewisse Zeit benötigen, bis diese vom Bus aktualisiert\\
zurückgemeldet werden. U.u. ist der Webserver hier schneller als die Rückmeldung und der Status erst nach dem nächsten Refresh angezeigt.$\\
         :$ID des Elements$\\
         :$SeitenID$\\
         :$Gruppenadresse des EIN/AUS Schaltelements (b01)$\\
         :$GA1 (b01)$\\
         :$GA2 (b01)$\\
         :$GA3 (b01)$\\
	 :$Icon$
:shortinfo $Implementierung eines Um-Schalters mit Datumsangabe und Statusanpassung abhängiger GAs$

initga(GA)

if pbutton(ID,PageID)==1 then write(GA,!GA) endif

if !GA1 and !GA2 and !GA3 then write(GA,AUS) endif
if GA1 and GA2 and GA3 then write(GA,EIN) endif

if GA then {
 	pdisplay(ID,CLOCKDATE_STRING,ICON,ACTIVE,GREEN,PageID);
	write(GA1,EIN);
	write(GA2,EIN);
	write(GA3,EIN)
} else {
 	pdisplay(ID,CLOCKDATE_STRING,ICON,INACTIVE,GREY,PageID);
	write(GA1,AUS);
	write(GA2,AUS);
	write(GA3,AUS)
} endif
:end

// Webelement
// @date	31.10.2012
// @version	2 
// @author	Stefanie Meier, Enertex Bayern GmbH
:begin UmschaltShifterZentralmit4GA(ID,PageID, GA, GA1,GA2,GA3, GA4,ICON)
:info $Einen seitenbezogenen Button mit (Elemente: pbutton, pshifter) mit einer Schaltmöglichkeit ansteuern. Beim Knopfdruck wird GA umgeschaltet. GA1, GA2, GA3 und GA4 passen ihren Status an.\\
z.B. GA = Alle Lichter, GA1 = Licht1, GA2= Licht2, GA3=Licht3, GA4=Licht4.\\
Datentyp der Gruppenaddresse b01. Die Schaltzeit der letzten Betätigung wird mit aufgezeichnet. Haben Sie keine Status-Gruppenadresse, geben sie an dieser \\
Stelle einfach nochmals die Schaltgruppenadresse vor. Beachten Sie, dass Statusaddressen eine gewisse Zeit benötigen, bis diese vom Bus aktualisiert\\
zurückgemeldet werden. U.u. ist der Webserver hier schneller als die Rückmeldung und der Status erst nach dem nächsten Refresh angezeigt.$\\
         :$ID des Elements$\\
         :$SeitenID$\\
         :$Gruppenadresse des EIN/AUS Schaltelements (b01)$\\
         :$GA1 (b01)$\\
         :$GA2 (b01)$\\
         :$GA3 (b01)$\\
         :$GA4 (b01)$\\
	 :$Icon$
:shortinfo $Implementierung eines Um-Schalters mit Datumsangabe und Statusanpassung abhängiger GAs$

initga(GA)

if pbutton(ID,PageID)==1 then write(GA,!GA) endif

if !GA1 and !GA2 and !GA3 and !GA4 then write(GA,AUS) endif
if GA1 and GA2 and GA3 and GA4 then write(GA,EIN) endif

if GA then {
 	pdisplay(ID,CLOCKDATE_STRING,ICON,ACTIVE,GREEN,PageID);
	write(GA1,EIN);
	write(GA2,EIN);
	write(GA3,EIN);
	write(GA4,EIN)
} else {
 	pdisplay(ID,CLOCKDATE_STRING,ICON,INACTIVE,GREY,PageID);
	write(GA1,AUS);
	write(GA2,AUS);
	write(GA3,AUS);
	write(GA4,AUS)
} endif
:end

// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin SliderDimmer(ID, PageID, GA)
:info $Ein seitenbezogenen Slider(pslider), der einen Dimmer ansteuert. Die GA ist vom Typ u08 (= Prozenttyp). Das Icon wird dem Zustand angepasst.$\\
         :$ID des psliders$\\
         :$SeitenID des psliders$\\
         :$Gruppenadresse des Dimmers (Prozenttyp (u08))$
:shortinfo $Einen Dimmer mit einem Slider ansteuern$
initga(GA)
InternDimmer_^ID_^PageID=getpslider(ID,PageID)
// Status bei normaler Busänderung
if delay(change(GA),150u64) or systemstart() then InternDimmer_^ID_^PageID=GA endif

if change(InternDimmer_^ID_^PageID) then {
	if InternDimmer_^ID_^PageID!=GA then {
		write(GA,InternDimmer_^ID_^PageID)
	} endif;
	if InternDimmer_^ID_^PageID==0 then {
		setpslider(ID,InternDimmer_^ID_^PageID,LIGHT,INACTIVE,PageID)
	} endif ;
	if InternDimmer_^ID_^PageID>=1 and InternDimmer_^ID_^PageID<50  then {
		setpslider(ID,InternDimmer_^ID_^PageID,LIGHT,STATE4,PageID)
	} endif;
	if InternDimmer_^ID_^PageID>=50 and InternDimmer_^ID_^PageID<100  then {
		setpslider(ID,InternDimmer_^ID_^PageID,LIGHT,STATE5,PageID)
	} endif;
	if InternDimmer_^ID_^PageID>=100 and InternDimmer_^ID_^PageID<200  then {
		setpslider(ID,InternDimmer_^ID_^PageID,LIGHT,STATE6,PageID)
	} endif;
	if InternDimmer_^ID_^PageID>=200  then {
		setpslider(ID,InternDimmer_^ID_^PageID,LIGHT,ACTIVE,PageID)
	} endif
} endif
:end

// Webelement
// @date	05.05.2015
// @version	2 
// @author	M.H. - Enertex Bayern GmbH
:begin SliderDimmerStatus(ID, PageID, GA, StatusGA)
:info $Ein seitenbezogenen Slider(pslider), der einen Dimmer ansteuert. Die GA ist vom Typ u08 (= Prozenttyp). Das Icon wird dem Zustand angepasst.$\\
         :$ID des psliders$\\
         :$SeitenID des psliders$\\
         :$Gruppenadresse des Dimmers (Prozenttyp (u08))\\
	 :$Statusadresse des Dimmers (Prozenttyp (u08))$
:shortinfo $Einen Dimmer mit einem Slider ansteuern$
initga(GA)
initga(StatusGA)
InternDimmer_^ID_^PageID=getpslider(ID,PageID)

// Status bei normaler Busänderung
if systemstart()  then {
	 write(GA,StatusGA);
	 InternDimmer_^ID_^PageID=StatusGA
} endif


if change(GA) then InternDimmer_^ID_^PageID=GA endif
if change(StatusGA) then {
	if StatusGA!=InternDimmer_^ID_^PageID then InternDimmer_^ID_^PageID=StatusGA endif
	} endif


if change(InternDimmer_^ID_^PageID) then {
	if InternDimmer_^ID_^PageID!=GA then {
		write(GA,InternDimmer_^ID_^PageID);
		
	} endif;
	if InternDimmer_^ID_^PageID==0 then {
		setpslider(ID,InternDimmer_^ID_^PageID,LIGHT,INACTIVE,PageID)
	} endif ;
	if InternDimmer_^ID_^PageID>=1 and InternDimmer_^ID_^PageID<50  then {
		setpslider(ID,InternDimmer_^ID_^PageID,LIGHT,STATE4,PageID)
	} endif;
	if InternDimmer_^ID_^PageID>=50 and InternDimmer_^ID_^PageID<100  then {
		setpslider(ID,InternDimmer_^ID_^PageID,LIGHT,STATE5,PageID)
	} endif;
	if InternDimmer_^ID_^PageID>=100 and InternDimmer_^ID_^PageID<200  then {
		setpslider(ID,InternDimmer_^ID_^PageID,LIGHT,STATE6,PageID)
	} endif;
	if InternDimmer_^ID_^PageID>=200  then {
		setpslider(ID,InternDimmer_^ID_^PageID,LIGHT,ACTIVE,PageID)
	} endif
} endif
:end

        // Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH - Dr. Schuster
:begin SliderDimmerButton(ID, PageID, GA)
:info $Ein seitenbezogenen Slider(pslider), der einen Dimmer ansteuert. Die GA ist vom Typ u08 (= Prozenttyp). Das Icon wird dem Zustand angepasst. Der Knopf kann gedrückt werden, um ein Toggeln des Wertes zwischen 0 und 100% zu ereichen.$\\
         :$ID des psliders$\\
         :$SeitenID des psliders$\\
         :$Gruppenadresse des Dimmers (Prozenttyp (u08))$
:shortinfo $Einen Dimmer mit einem Slider ansteuern - der Knopf kann betätigt werden$
initga(GA)
InternDimmer_^ID_^PageID=getpslider(ID,PageID)
// Status bei normaler Busänderung
if delay(change(GA),150u64) or systemstart() then InternDimmer_^ID_^PageID=GA endif

if pbutton(ID,PageID)==1 and GA==0 then write(GA, 100%) endif
if pbutton(ID,PageID)==1 and GA>0 then write(GA, 0%) endif


if change(InternDimmer_^ID_^PageID) then {
	if InternDimmer_^ID_^PageID!=GA then {
		write(GA,InternDimmer_^ID_^PageID)
	} endif;
	if InternDimmer_^ID_^PageID==0 then {
		setpslider(ID,InternDimmer_^ID_^PageID,LIGHT,INACTIVE,PageID)
	} endif ;
	if InternDimmer_^ID_^PageID>=1 and InternDimmer_^ID_^PageID<50  then {
		setpslider(ID,InternDimmer_^ID_^PageID,LIGHT,STATE4,PageID)
	} endif;
	if InternDimmer_^ID_^PageID>=50 and InternDimmer_^ID_^PageID<100  then {
		setpslider(ID,InternDimmer_^ID_^PageID,LIGHT,STATE5,PageID)
	} endif;
	if InternDimmer_^ID_^PageID>=100 and InternDimmer_^ID_^PageID<200  then {
		setpslider(ID,InternDimmer_^ID_^PageID,LIGHT,STATE6,PageID)
	} endif;
	if InternDimmer_^ID_^PageID>=200  then {
		setpslider(ID,InternDimmer_^ID_^PageID,LIGHT,ACTIVE,PageID)
	} endif
} endif
:end

// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH - Stefanie Meier
:begin SliderDimmerButtonZustand(ID, PageID, GA)
:info $Ein seitenbezogenen Slider(pslider), der einen Dimmer ansteuert. Die GA ist vom Typ u08 (= Prozenttyp). Das Icon wird dem Zustand angepasst. Der Knopf kann gedrückt werden, um ein Toggeln des Wertes zwischen 0 und 100% zu ereichen. Der Dimmer nimmt beim Einschalten den alten Dimmwert (Zustand) wieder an.$\\
         :$ID des psliders$\\
         :$SeitenID des psliders$\\
         :$Gruppenadresse des Dimmers (Prozenttyp (u08))$
:shortinfo $Einen Dimmer mit einem Slider ansteuern (einschalten auf zuletzt empfangenen Dimmwert - der Knopf kann betätigt werden$
initga(GA)
InternDimmer_^ID_^PageID=getpslider(ID,PageID)
// Status bei normaler Busänderung
if delay(change(GA),150u64) or systemstart() then InternDimmer_^ID_^PageID=GA endif

InternDimmer_^ID_^PageID_alt=100%
if pbutton(ID,PageID)==1 and GA==0 then write(GA, InternDimmer_^ID_^PageID_alt) endif
if pbutton(ID,PageID)==1 and GA>0 then 	write(GA, 0%) endif


if change(InternDimmer_^ID_^PageID) then {
	if InternDimmer_^ID_^PageID!=GA then {
		write(GA,InternDimmer_^ID_^PageID);
		InternDimmer_^ID_^PageID_alt=InternDimmer_^ID_^PageID
	} endif;
	if InternDimmer_^ID_^PageID==0 then {
		setpslider(ID,InternDimmer_^ID_^PageID,LIGHT,INACTIVE,PageID)
	} endif ;
	if InternDimmer_^ID_^PageID>=1 and InternDimmer_^ID_^PageID<50  then {
		setpslider(ID,InternDimmer_^ID_^PageID,LIGHT,STATE4,PageID)
	} endif;
	if InternDimmer_^ID_^PageID>=50 and InternDimmer_^ID_^PageID<100  then {
		setpslider(ID,InternDimmer_^ID_^PageID,LIGHT,STATE5,PageID)
	} endif;
	if InternDimmer_^ID_^PageID>=100 and InternDimmer_^ID_^PageID<200  then {
		setpslider(ID,InternDimmer_^ID_^PageID,LIGHT,STATE6,PageID)
	} endif;
	if InternDimmer_^ID_^PageID>=200  then {
		setpslider(ID,InternDimmer_^ID_^PageID,LIGHT,ACTIVE,PageID)
	} endif
} endif
:end


// Webelement
// @date	01.03.2012
// @version	2 
// @author	Enertex Bayern GmbH - Dr. Schuster
:begin SliderTemperatur(ID,PageID,Min,Inkr,Max,GA)
:info $Ein seitenbezogener Slider(pslider), der einen 16-Bit Temperatursollwert ansteuert. Die GA ist vom Typ f16 (= Temperatur). Das Icon wird dem Zustand angepasst. Beim Drücken des Buttons wird auf die maximale bzw. die miniale Temperatur gesprungen.$\\
         :$ID des psliders$\\
         :$SeitenID des psliders$\\
         :$Die untere Grenze, welche über den Slider eingestellt werden kann$\\
         :$Die Werterhöhung bei Knopfdruck$\\
         :$Die obere Grenze, welche über den Slider eingestellt werden kann$\\
         :$Gruppenadresse Temperatursollwert (f16))$
:shortinfo $Eine Solltemperatur mit einem Slider einstellen$

// Initialisieren
initga(GA)
// Variable
InternTemperatur_^ID_^PageID=getpeslider(ID,PageID)
InternTemperatur_^ID_^PageID_Inkrement=convert(Inkr,GA)

// Status bei normaler Busänderung
if delay(change(GA),150u64) or systemstart() then InternTemperatur_^ID_^PageID=convert(GA,InternTemperatur_^ID_^PageID) endif


if pbutton(ID,PageID)==1 and InternTemperatur_^ID_^PageID_Inkrement>=convert(0,GA) then {
   if GA+InternTemperatur_^ID_^PageID_Inkrement=<convert(Max,GA) then {
            write(GA, InternTemperatur_^ID_^PageID_Inkrement+GA) 
     } else {
             InternTemperatur_^ID_^PageID_Inkrement=-convert(Inkr,GA)
      } endif
}   endif
if pbutton(ID,PageID)==1 and InternTemperatur_^ID_^PageID_Inkrement<convert(0,GA) then {
   if GA+InternTemperatur_^ID_^PageID_Inkrement=>convert(Min,GA) then {
            write(GA, InternTemperatur_^ID_^PageID_Inkrement+GA) 
      } else {
             InternTemperatur_^ID_^PageID_Inkrement=-convert(Inkr,GA)
      } endif
}   endif
   

if change(InternTemperatur_^ID_^PageID) then {
	if InternTemperatur_^ID_^PageID!=convert(GA,InternTemperatur_^ID_^PageID) then {
		write(GA,convert(InternTemperatur_^ID_^PageID,GA))
	} endif;

     if ((InternTemperatur_^ID_^PageID!=convert(Max,InternTemperatur_^ID_^PageID)) and (InternTemperatur_^ID_^PageID!=convert(Min,InternTemperatur_^ID_^PageID))) then {     
         setpeslider(ID,InternTemperatur_^ID_^PageID,TEMPERATURE,ACTIVE,PageID)
} endif;
    if (InternTemperatur_^ID_^PageID>=convert(Max,InternTemperatur_^ID_^PageID)) then {
         setpeslider(ID,InternTemperatur_^ID_^PageID,TEMPERATURE,BRIGHTRED,PageID)       
    } endif;
    if (InternTemperatur_^ID_^PageID<=convert(Min,InternTemperatur_^ID_^PageID)) then {
         setpeslider(ID,InternTemperatur_^ID_^PageID,TEMPERATURE,INACTIVE,PageID)
    } endif
} endif


:end

// Webelement
// @date	01.03.2012
// @version	2 
// @author	Enertex Bayern GmbH - Dr. Schuster
:begin SliderTemperaturVar(ID,PageID,Min,Inkr,Max,Var)
:info $Ein seitenbezogener Slider(peslider), der einen 16-Bit Temperatursollwert ansteuert. Die Variable ist vom Typ f16 (= Temperatur). Das Icon wird dem Zustand angepasst. Beim Drücken des Buttons wird auf die maximale bzw. die miniale Temperatur gesprungen.$\\
         :$ID des pesliders$\\
         :$SeitenID des pesliders$\\
         :$Die untere Grenze, welche über den Slider eingestellt werden kann$\\
         :$Die Werterhöhung bei Knopfdruck$\\
         :$Die obere Grenze, welche über den Slider eingestellt werden kann$\\
         :$Gruppenadresse Temperatursollwert (f16))$
:shortinfo $Eine Solltemperatur mit einem Slider einstellen (Ausgabe auf Variable)$

// Variable
InternTemperatur_^ID_^PageID=getpeslider(ID,PageID)
InternTemperatur_^ID_^PageID_Inkrement=convert(Inkr,Var)

// Status bei normaler Busänderung
if delay(change(Var),150u64) or systemstart() then InternTemperatur_^ID_^PageID=convert(Var,InternTemperatur_^ID_^PageID) endif


if pbutton(ID,PageID)==1 and InternTemperatur_^ID_^PageID_Inkrement>=convert(0,Var) then {
   if Var+InternTemperatur_^ID_^PageID_Inkrement=<convert(Max,Var) then {
              Var=InternTemperatur_^ID_^PageID_Inkrement+Var 
     } else {
             InternTemperatur_^ID_^PageID_Inkrement=-convert(Inkr,Var)
      } endif
}   endif

if pbutton(ID,PageID)==1 and InternTemperatur_^ID_^PageID_Inkrement<convert(0,Var) then {
        if Var+InternTemperatur_^ID_^PageID_Inkrement=>convert(Min,Var) then {
             Var=InternTemperatur_^ID_^PageID_Inkrement+Var
      } else {
             InternTemperatur_^ID_^PageID_Inkrement=-convert(Inkr,Var)
      } endif
}   endif
   

if change(InternTemperatur_^ID_^PageID) then {
	if InternTemperatur_^ID_^PageID!=convert(Var,InternTemperatur_^ID_^PageID) then {
	   Var=convert(InternTemperatur_^ID_^PageID,Var)
	} endif;

     if ((InternTemperatur_^ID_^PageID!=convert(Max,InternTemperatur_^ID_^PageID)) and (InternTemperatur_^ID_^PageID!=convert(Min,InternTemperatur_^ID_^PageID))) then {     
         setpeslider(ID,InternTemperatur_^ID_^PageID,TEMPERATURE,ACTIVE,PageID)
     } endif;
    if (InternTemperatur_^ID_^PageID>=convert(Max,InternTemperatur_^ID_^PageID)) then {
         setpeslider(ID,InternTemperatur_^ID_^PageID,TEMPERATURE,BRIGHTRED,PageID)       
    } endif;
    if (InternTemperatur_^ID_^PageID<=convert(Min,InternTemperatur_^ID_^PageID)) then {
         setpeslider(ID,InternTemperatur_^ID_^PageID,TEMPERATURE,INACTIVE,PageID)
    } endif
} endif


:end




// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin Raumcontroller(ID, PageID, GA, RkGA)
:info $Einen Raumcontroller im Webinterface mit einem pshifter ansteuern. Der Raumkontroller wird über die 8-Bit Adresse RkGA angesteuert (Umschaltung in Standby,\\
Komfort, Nachtmodus).Über die Gruppenadresse des Heizaktors GA wird ermittelt, ob tatsächlich geheizt wird. Der pshifter sollte folgende Form haben(§ mit Dollarzeichen ersetzen): pshifter(RkID)[ABSENT,PRESENT,NIGHT,ABSENT]§Raumkontroller§						siehe auch Beispiel Raumcontroller.epc $\\
         :$ID des pshifters$\\
         :$SeitenID des pshifters$\\
         :$Gruppenadresse des Heizaktors(Prozenttyp (u08))$\\
	 :$Gruppenadresse des Raumkontrollers (8-Bit Typ)$
:shortinfo $Raumcontroller$
Rk_^ID_^PageID=RkGA
RkSymbol_^ID_^PageID=ABSENT
initga(RkGA)
if pbutton(ID,PageID)==1 then Rk_^ID_^PageID=STANDBY endif
if pbutton(ID,PageID)==2 then Rk_^ID_^PageID=KOMFORT endif
if pbutton(ID,PageID)==3 then Rk_^ID_^PageID=NIGHTMODE endif

if change(Rk_^ID_^PageID) then {	
	write(RkGA,Rk_^ID_^PageID);
	if Rk_^ID_^PageID==KOMFORT then RkSymbol_^ID_^PageID=PRESENT endif;
	if Rk_^ID_^PageID==STANDBY then RkSymbol_^ID_^PageID=ABSENT endif;
	if Rk_^ID_^PageID==NIGHTMODE then RkSymbol_^ID_^PageID=NIGHT endif
} endif 

if (change(RkSymbol_^ID_^PageID) or change(GA)) and GA>0 then {
 	pdisplay(ID,$Es wird geheizt$,RkSymbol_^ID_^PageID,BRIGHTRED,BLINKBLUE,PageID)
} endif 
if (change(RkSymbol_^ID_^PageID) or change(GA)) and GA==0 then {
	pdisplay(ID,$AUS$,RkSymbol_^ID_^PageID,ACTIVE,GREY,PageID)
} endif
:end

// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin Ferienkalender(DayID,MonthID,FerienID,PageID)
:info $Legt einen Ferienkalender mit Hilfe von 2 mpbuttons und einem shifter im Webserver an. Die Variable "Ferien" zeigt an, ob Ferien sind. Außerdem kann man mit dem Status-Shifter diese Variable manuell schalten. Die buttons sollten folgende Form haben(§ mit Dollarzeichen ersetzen):                        mpbutton(MonthID)[§Januar§,§Februar§,§März§,§April§,§Mai§,§Juni§,§Juli§,§August§,§September§,§Oktober§,§November§,§Dezember§][DATE]§Monat§ \\
mpbutton(DayID)[§1§,§2§,§3§,§4§,§5§,§6§,§7§,§8§,§9§,§10§,§11§,§12§,§13§,§14§,§15§,§16§,§17§,§18§,§19§,§20§,§21§,§22§,§23§,§24§,§25§,§26§,§27§,§28§,§29§,§30§,§31§][DATE]§Tag§           shifter(FerienID)[INFO]§Ferien Status:§                          siehe Beispiel Ferienkalender.epc$\\
	$ID des mpbuttons, mit dem man die Tage auswählt$\\
	$ID des mpbuttons, mit dem man die Monate auswählt$\\
	$ID des shifters, der den Status der Ferien anzeigen soll$\\
	$SeitenID der buttons$
:shortinfo $Visualisiert einen Ferienkalender$

ChoiceMonth = 1
ChoiceDay = 1
Ferien = AUS
FerienText = $$
FerienDeko=GREEN
FerienState=INACTIVE


if mpbutton(MonthID,1,PageID)==255 then ChoiceMonth = 1 endif
if mpbutton(MonthID,2,PageID)==255 then ChoiceMonth = 2 endif
if mpbutton(MonthID,3,PageID)==255 then ChoiceMonth = 3 endif
if mpbutton(MonthID,4,PageID)==255 then ChoiceMonth = 4 endif
if mpbutton(MonthID,5,PageID)==255 then ChoiceMonth = 5 endif
if mpbutton(MonthID,6,PageID)==255 then ChoiceMonth = 6 endif
if mpbutton(MonthID,7,PageID)==255 then ChoiceMonth = 7 endif
if mpbutton(MonthID,8,PageID)==255 then ChoiceMonth = 8 endif
if mpbutton(MonthID,9,PageID)==255 then ChoiceMonth = 9 endif
if mpbutton(MonthID,10,PageID)==255 then ChoiceMonth = 10 endif
if mpbutton(MonthID,11,PageID)==255 then ChoiceMonth = 11 endif
if mpbutton(MonthID,12,PageID)==255 then ChoiceMonth = 12 endif

if mpbutton(DayID,1,PageID)==255 then ChoiceDay = 1 endif
if mpbutton(DayID,2,PageID)==255 then ChoiceDay = 2 endif
if mpbutton(DayID,3,PageID)==255 then ChoiceDay = 3 endif
if mpbutton(DayID,4,PageID)==255 then ChoiceDay = 4 endif
if mpbutton(DayID,5,PageID)==255 then ChoiceDay = 5 endif
if mpbutton(DayID,6,PageID)==255 then ChoiceDay = 6 endif
if mpbutton(DayID,7,PageID)==255 then ChoiceDay = 7 endif
if mpbutton(DayID,8,PageID)==255 then ChoiceDay = 8 endif
if mpbutton(DayID,9,PageID)==255 then ChoiceDay = 9 endif
if mpbutton(DayID,10,PageID)==255 then ChoiceDay = 10 endif
if mpbutton(DayID,11,PageID)==255 then ChoiceDay = 11 endif
if mpbutton(DayID,12,PageID)==255 then ChoiceDay = 12 endif
if mpbutton(DayID,13,PageID)==255 then ChoiceDay = 13 endif
if mpbutton(DayID,14,PageID)==255 then ChoiceDay = 14 endif
if mpbutton(DayID,15,PageID)==255 then ChoiceDay = 15 endif
if mpbutton(DayID,16,PageID)==255 then ChoiceDay = 16 endif
if mpbutton(DayID,17,PageID)==255 then ChoiceDay = 17 endif
if mpbutton(DayID,18,PageID)==255 then ChoiceDay = 18 endif
if mpbutton(DayID,19,PageID)==255 then ChoiceDay = 19 endif
if mpbutton(DayID,20,PageID)==255 then ChoiceDay = 20 endif
if mpbutton(DayID,21,PageID)==255 then ChoiceDay = 21 endif
if mpbutton(DayID,22,PageID)==255 then ChoiceDay = 22 endif
if mpbutton(DayID,23,PageID)==255 then ChoiceDay = 23 endif
if mpbutton(DayID,24,PageID)==255 then ChoiceDay = 24 endif
if mpbutton(DayID,25,PageID)==255 then ChoiceDay = 25 endif
if mpbutton(DayID,26,PageID)==255 then ChoiceDay = 26 endif
if mpbutton(DayID,27,PageID)==255 then ChoiceDay = 27 endif
if mpbutton(DayID,28,PageID)==255 then ChoiceDay = 28 endif
if mpbutton(DayID,29,PageID)==255 then ChoiceDay = 29 endif
if mpbutton(DayID,30,PageID)==255 then ChoiceDay = 30 endif
if mpbutton(DayID,31,PageID)==255 then ChoiceDay = 31 endif

if change(ChoiceMonth) then pdisplay(MonthID,$$,DATE,INACTIVE,GREEN,PageID,ChoiceMonth) endif
if change(ChoiceDay) then pdisplay(DayID,$$,DATE,INACTIVE,GREEN,PageID,ChoiceDay) endif

if button(FerienID) == 1 then Ferien = !Ferien endif
if Ferien then {
	FerienText = $Es sind gerade Ferien$;
	FerienDeko=GREEN;
	FerienState=ACTIVE
} else {
	FerienText = $Es sind gerade keine Ferien$;
	FerienDeko=GREY;
	FerienState=INACTIVE
} endif
	

if change(Ferien) or after(systemstart(),3000u64) then display(FerienID,FerienText,INFO,FerienState,FerienDeko) endif
:end

// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin FerienAusfuehren(Name,BeginID,EndID,PageID,BeginnTag, BeginnMonat, EndeTag, EndeMonat)
:info $Man kann damit Ferien mit dem Ferienkalender realisieren. Man benötigt dafür das Makro Ferienkalender und 2 pshifter folgender Form(§ mit Dollarzeichen ersetzen):            pshifter(BeginID)[INFO]§ Ferienbeginn§ pshifter(EndID)[INFO]§ Ferienende§             siehe Beispiel FerienAusfuehren.epc$\\
	$Name der Ferien$\\
	$ID des shifters, der den Beginn der Ferien anzeigt$\\
	$ID des shifters, der das Ende der Ferien anzeigt$\\
	$SeitenID auf der die shifter sind$\\
	$Tag des Ferienbeginns(z.B. "18" für 18.)$\\
	$Monat des Ferienbeginns(z.B. "10" für Oktober)$\\
	$Tag des Ferienendes(z.B. "18" für 18.)$\\
	$Monat des Ferienendes(z.B. "10" für Oktober)$
:shortinfo $Ferienkalender realisieren$
Name_BeginDay = BeginnTag
Name_EndDay = EndeTag
Name_EndMonth = EndeMonat
Name_BeginMonth = BeginnMonat

if after(systemstart(),3000u64) then {
	pdisplay(BeginID,convert(Name_BeginDay,$$)+$.$+convert(Name_BeginMonth,$$),INFO,ACTIVE,GREEN,PageID);
	pdisplay(EndID,convert(Name_EndDay,$$)+$.$+convert(Name_EndMonth,$$),INFO,ACTIVE,GREEN,PageID)
} endif
	
if pbutton(BeginID,PageID)==1 then {
	pdisplay(BeginID,convert(ChoiceDay,$$)+$.$+convert(ChoiceMonth,$$),INFO,ACTIVE,GREEN,PageID);
	Name_BeginDay=ChoiceDay; Name_BeginMonth=ChoiceMonth
} endif
if pbutton(EndID,PageID)==1 then {
	pdisplay(EndID,convert(ChoiceDay,$$)+$.$+convert(ChoiceMonth,$$),INFO,ACTIVE,GREEN,PageID);
	Name_EndDay=ChoiceDay; Name_EndMonth=ChoiceMonth
} endif

if month(Name_BeginDay,Name_BeginMonth) then Ferien = EIN endif
if month(Name_EndDay,Name_EndMonth) then Ferien = AUS endif
:end

// Sollwertvorgabe auf den BUS
:begin WebWertvorgabeGA(ID,PageID,Name,GA,Max,Min)
:info $Steuert eine Wertvorgabe an eine Gruppenadresse z.B. Temperatursollwert), die über den Webserver angesteuert wird. $\\
	$ID des pshifters$\\
	$Seiten-ID des pshifters$\\
	$Name der Wertvorgabe$\\
	$Gruppenadresse des Werts, diese wird beim Start des EibPC aktualisiert über eine Leseanforderung\\
	$Maximale Verstellung des Werts, z.B. 23.5 $\\
	$Minimale Verstellung des Werts, z.B. 19.5 $
:shortinfo $Steuert eine Webserver-Wertveränderung$
initGA(GA)
Sollwertvorgabe^Name=GA
if pbutton(ID,PageID)==1 then if Sollwertvorgabe^Name<Max^f16 then Sollwertvorgabe^Name=Sollwertvorgabe^Name+(min(1.0,Max^f16-Sollwertvorgabe^Name)) endif endif
if pbutton(ID,PageID)==2 then if Sollwertvorgabe^Name>Min^f16 then Sollwertvorgabe^Name=Sollwertvorgabe^Name-(min(1.0,Sollwertvorgabe^Name-Min^f16)) endif endif
if pbutton(ID,PageID)==3 then if Sollwertvorgabe^Name<Max^f16 then Sollwertvorgabe^Name=Sollwertvorgabe^Name+(min(0.1,Max^f16-Sollwertvorgabe^Name)) endif endif
if pbutton(ID,PageID)==4 then if Sollwertvorgabe^Name>Min^f16 then Sollwertvorgabe^Name=Sollwertvorgabe^Name-(min(0.1,Sollwertvorgabe^Name-Min^f16)) endif endif

if change(Sollwertvorgabe^Name) or after(systemstart(),1u64) then {
	write(GA,Sollwertvorgabe^Name);
	pdisplay(ID,$ Sollwert $+convert(Sollwertvorgabe^Name,$$),DOWN,INACTIVE,GREEN,PageID)
} endif
:end 

// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin JalousieMitLamellen(RolloID,JalousieID,PageID,GAJalousie,GALamellen)
:info $Ein Makro, um die Jalousie mit Lamellenverstellung via WebServer steuern zu können.$\\
	:$Zahl zwischen 0 und 39 als ID der Jalousie$\\
	:$Zahl zwischen 0 und 39 als ID der Lamellen$\\
	:$Zahl zwischen 0 und 99 als ID der Seite, auf der das Element definiert wurde.$\\
	:$Gruppenadresse der Jalousie (b01)$\\
	:$Gruppenadresse der Lamellen (b01)$
:shortinfo $Jalousiesteuerung$

// Implementierung von Name
m_^RolloID_^PageID_Text=$$
m_^RolloID_^PageID_ICON=BLIND
m_^RolloID_^PageID_State=INACTIVE
m_^RolloID_^PageID_Deko=GREY

if after(systemstart(),3000u64) then pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID) endif
if after(systemstart(),3200u64) then pdisplay(JalousieID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID) endif

if change(GAJalousie) then pdisplay(RolloID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID) endif
if change(GALamellen) then pdisplay(JalousieID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID) endif

if (delay(change(GAJalousie),30000u64) or pbutton(RolloID,PageID)==2) then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID)
} endif
if (delay(change(GALamellen),30000u64) or pbutton(JalousieID,PageID)==2) then {
	pdisplay(JalousieID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID)
} endif
if pbutton(RolloID,PageID)==1 then {
	write(GAJalousie,AUS)
} endif
if pbutton(RolloID,PageID)==3 then {
	write(GAJalousie,EIN)
} endif
if (pbutton(RolloID,PageID)==2 and GAJalousie==EIN) then {
	write(GAJalousie,EIN)
} endif
if (pbutton(RolloID,PageID)==2 and GAJalousie==AUS) then {
	write(GAJalousie,AUS)
} endif
if pbutton(JalousieID,PageID)==1 then {
	write(GALamellen,AUS)
} endif
if pbutton(JalousieID,PageID)==3 then {
	write(GALamellen,EIN)
} endif
if (pbutton(JalousieID,PageID)==2 and GALamellen==EIN) then {
	write(GALamellen,EIN)
} endif
if (pbutton(JalousieID,PageID)==2 and GALamellen==AUS) then {
	write(GALamellen,AUS)
} endif

:end


// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin ZweiJalousienMitLamellen(RolloID,LamellenID,PageID,GAJalousie1,GALamellen1,GAJalousie2,GALamellen2)
:info $Ein Makro, um zwei Jalousien mit Lamellenverstellung via WebServer steuern zu können.$\\
	:$Zahl zwischen 0 und 39 als ID der Jalousie$\\
	:$Zahl zwischen 0 und 39 als ID der Lamellen$\\
	:$Zahl zwischen 0 und 99 als ID der Seite, auf der das Element definiert wurde.$\\
	:$Gruppenadresse der 1. Jalousie (b01)$\\
	:$Gruppenadresse der 1. Lamellen (b01)$\\
	:$Gruppenadresse der 2. Jalousie (b01)$\\
	:$Gruppenadresse der 2. Lamellen (b01)$
:shortinfo $Jalousiesteuerung für zwei Jalousien$

// Implementierung von Name
m_^RolloID_^PageID_Text=$$
m_^RolloID_^PageID_ICON=BLIND
m_^RolloID_^PageID_State=INACTIVE
m_^RolloID_^PageID_Deko=GREY
m_^RolloID_^PageID_Choice=1
m_^LamellenID_^PageID_Choice=1

if mpbutton(RolloID,1,PageID)==255 then {
	m_^RolloID_^PageID_Choice=1
} endif
if mpbutton(RolloID,2,PageID)==255 then {
	m_^RolloID_^PageID_Choice=2
} endif
if mpbutton(LamellenID,1,PageID)==255 then {
	m_^LamellenID_^PageID_Choice=1
} endif
if mpbutton(LamellenID,2,PageID)==255 then {
	m_^LamellenID_^PageID_Choice=2
} endif

if after(systemstart(),3000u64) then pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice) endif
if after(systemstart(),3200u64) then pdisplay(LamellenID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice) endif

if (change(GAJalousie1) or change(m_^RolloID_^PageID_Choice) and m_^RolloID_^PageID_Choice==1) then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice)
} endif
if (change(GAJalousie2) or change(m_^RolloID_^PageID_Choice) and m_^RolloID_^PageID_Choice==2) then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice)
} endif
if (change(GALamellen1) or change(m_^LamellenID_^PageID_Choice) and m_^LamellenID_^PageID_Choice==1) then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice)
} endif
if (change(GALamellen2) or change(m_^LamellenID_^PageID_Choice) and m_^LamellenID_^PageID_Choice==2) then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice)
} endif
if (delay(change(GAJalousie1),30000u64) or change(m_^RolloID_^PageID_Choice) or mpbutton(RolloID,1,PageID)==2) and m_^RolloID_^PageID_Choice==1 then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice) 
} endif 
if (delay(change(GAJalousie2),30000u64) or change(m_^RolloID_^PageID_Choice) or mpbutton(RolloID,2,PageID)==2) and m_^RolloID_^PageID_Choice==2 then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice) 
} endif 
if (delay(change(GALamellen1),30000u64) or change(m_^LamellenID_^PageID_Choice) or mpbutton(LamellenID,1,PageID)==2) and m_^LamellenID_^PageID_Choice==1 then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice) 
} endif 
if (delay(change(GALamellen2),30000u64) or change(m_^LamellenID_^PageID_Choice) or mpbutton(LamellenID,2,PageID)==2) and m_^LamellenID_^PageID_Choice==2 then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice) 
} endif 

if mpbutton(RolloID,1,PageID)==1 then {
	write(GAJalousie1,AUS)
} endif
if mpbutton(RolloID,1,PageID)==3 then {
	write(GAJalousie1,EIN)
} endif
if (mpbutton(RolloID,1,PageID)==2 and GAJalousie1==EIN) then {
	write(GAJalousie1,EIN)
} endif
if (mpbutton(RolloID,1,PageID)==2 and GAJalousie1==AUS) then {
	write(GAJalousie1,AUS)
} endif
if mpbutton(RolloID,2,PageID)==1 then {
	write(GAJalousie2,AUS)
} endif
if mpbutton(RolloID,2,PageID)==3 then {
	write(GAJalousie2,EIN)
} endif
if (mpbutton(RolloID,2,PageID)==2 and GAJalousie2==EIN) then {
	write(GAJalousie2,EIN)
} endif
if (mpbutton(RolloID,2,PageID)==2 and GAJalousie2==AUS) then {
	write(GAJalousie2,AUS)
} endif
if mpbutton(LamellenID,1,PageID)==1 then {
	write(GALamellen1,AUS)
} endif
if mpbutton(LamellenID,1,PageID)==3 then {
	write(GALamellen1,EIN)
} endif
if (mpbutton(LamellenID,1,PageID)==2 and GALamellen1==EIN) then {
	write(GALamellen1,EIN)
} endif
if (mpbutton(LamellenID,1,PageID)==2 and GALamellen1==AUS) then {
	write(GALamellen1,AUS)
} endif
if mpbutton(LamellenID,2,PageID)==1 then {
	write(GALamellen2,AUS)
} endif
if mpbutton(LamellenID,2,PageID)==3 then {
	write(GALamellen2,EIN)
} endif
if (mpbutton(LamellenID,2,PageID)==2 and GALamellen2==EIN) then {
	write(GALamellen2,EIN)
} endif
if (mpbutton(LamellenID,2,PageID)==2 and GALamellen2==AUS) then {
	write(GALamellen2,AUS)
} endif
:end


// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin DreiJalousienMitLamellen(RolloID,LamellenID,PageID,GAJalousie1,GALamellen1,GAJalousie2,GALamellen2,GAJalousie3,GALamellen3)
:info $Ein Makro, um drei Jalousien mit Lamellenverstellung via WebServer steuern zu können.$\\
	:$Zahl zwischen 0 und 39 als ID der Jalousie$\\
	:$Zahl zwischen 0 und 39 als ID der Lamellen$\\
	:$Zahl zwischen 0 und 99 als ID der Seite, auf der das Element definiert wurde.$\\
	:$Gruppenadresse der 1. Jalousie (b01)$\\
	:$Gruppenadresse der 1. Lamellen (b01)$\\
	:$Gruppenadresse der 2. Jalousie (b01)$\\
	:$Gruppenadresse der 2. Lamellen (b01)$\\
	:$Gruppenadresse der 3. Jalousie (b01)$\\
	:$Gruppenadresse der 3. Lamellen (b01)$
:shortinfo $Jalousiesteuerung für drei Jalousien$

// Implementierung von Name
m_^RolloID_^PageID_Text=$$
m_^RolloID_^PageID_ICON=BLIND
m_^RolloID_^PageID_State=INACTIVE
m_^RolloID_^PageID_Deko=GREY
m_^RolloID_^PageID_Choice=1
m_^LamellenID_^PageID_Choice=1

if mpbutton(RolloID,1,PageID)==255 then {
	m_^RolloID_^PageID_Choice=1
} endif
if mpbutton(RolloID,2,PageID)==255 then {
	m_^RolloID_^PageID_Choice=2
} endif
if mpbutton(RolloID,3,PageID)==255 then {
	m_^RolloID_^PageID_Choice=3
} endif

if mpbutton(LamellenID,1,PageID)==255 then {
	m_^LamellenID_^PageID_Choice=1
} endif
if mpbutton(LamellenID,2,PageID)==255 then {
	m_^LamellenID_^PageID_Choice=2
} endif
if mpbutton(LamellenID,3,PageID)==255 then {
	m_^LamellenID_^PageID_Choice=3
} endif

if after(systemstart(),3000u64) then pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice) endif
if after(systemstart(),3200u64) then pdisplay(LamellenID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice) endif

if (change(GAJalousie1) or change(m_^RolloID_^PageID_Choice) and m_^RolloID_^PageID_Choice==1) then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice)
} endif
if (change(GAJalousie2) or change(m_^RolloID_^PageID_Choice) and m_^RolloID_^PageID_Choice==2) then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice)
} endif
if (change(GAJalousie3) or change(m_^RolloID_^PageID_Choice) and m_^RolloID_^PageID_Choice==3) then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice)
} endif

if (change(GALamellen1) or change(m_^LamellenID_^PageID_Choice) and m_^LamellenID_^PageID_Choice==1) then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice)
} endif
if (change(GALamellen2) or change(m_^LamellenID_^PageID_Choice) and m_^LamellenID_^PageID_Choice==2) then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice)
} endif
if (change(GALamellen3) or change(m_^LamellenID_^PageID_Choice) and m_^LamellenID_^PageID_Choice==3) then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice)
} endif

if (delay(change(GAJalousie1),30000u64) or change(m_^RolloID_^PageID_Choice) or mpbutton(RolloID,1,PageID)==2) and m_^RolloID_^PageID_Choice==1 then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice) 
} endif 
if (delay(change(GAJalousie2),30000u64) or change(m_^RolloID_^PageID_Choice) or mpbutton(RolloID,2,PageID)==2) and m_^RolloID_^PageID_Choice==2 then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice) 
} endif 
if (delay(change(GAJalousie3),30000u64) or change(m_^RolloID_^PageID_Choice) or mpbutton(RolloID,2,PageID)==3) and m_^RolloID_^PageID_Choice==3 then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice) 
} endif 

if (delay(change(GALamellen1),30000u64) or change(m_^LamellenID_^PageID_Choice) or mpbutton(LamellenID,1,PageID)==2) and m_^LamellenID_^PageID_Choice==1 then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice) 
} endif 
if (delay(change(GALamellen2),30000u64) or change(m_^LamellenID_^PageID_Choice) or mpbutton(LamellenID,2,PageID)==2) and m_^LamellenID_^PageID_Choice==2 then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice) 
} endif 
if (delay(change(GALamellen2),30000u64) or change(m_^LamellenID_^PageID_Choice) or mpbutton(LamellenID,2,PageID)==3) and m_^LamellenID_^PageID_Choice==3 then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice) 
} endif 

if mpbutton(RolloID,1,PageID)==1 then {
	write(GAJalousie1,AUS)
} endif
if mpbutton(RolloID,1,PageID)==3 then {
	write(GAJalousie1,EIN)
} endif
if (mpbutton(RolloID,1,PageID)==2 and GAJalousie1==EIN) then {
	write(GAJalousie1,EIN)
} endif
if (mpbutton(RolloID,1,PageID)==2 and GAJalousie1==AUS) then {
	write(GAJalousie1,AUS)
} endif
if mpbutton(RolloID,2,PageID)==1 then {
	write(GAJalousie2,AUS)
} endif
if mpbutton(RolloID,2,PageID)==3 then {
	write(GAJalousie2,EIN)
} endif
if (mpbutton(RolloID,2,PageID)==2 and GAJalousie2==EIN) then {
	write(GAJalousie2,EIN)
} endif
if (mpbutton(RolloID,2,PageID)==2 and GAJalousie2==AUS) then {
	write(GAJalousie2,AUS)
} endif
if mpbutton(RolloID,3,PageID)==1 then {
	write(GAJalousie3,AUS)
} endif
if mpbutton(RolloID,3,PageID)==3 then {
	write(GAJalousie3,EIN)
} endif
if (mpbutton(RolloID,3,PageID)==2 and GAJalousie3==EIN) then {
	write(GAJalousie3,EIN)
} endif
if (mpbutton(RolloID,3,PageID)==2 and GAJalousie3==AUS) then {
	write(GAJalousie3,AUS)
} endif

if mpbutton(LamellenID,1,PageID)==1 then {
	write(GALamellen1,AUS)
} endif
if mpbutton(LamellenID,1,PageID)==3 then {
	write(GALamellen1,EIN)
} endif
if (mpbutton(LamellenID,1,PageID)==2 and GALamellen1==EIN) then {
	write(GALamellen1,EIN)
} endif
if (mpbutton(LamellenID,1,PageID)==2 and GALamellen1==AUS) then {
	write(GALamellen1,AUS)
} endif
if mpbutton(LamellenID,2,PageID)==1 then {
	write(GALamellen2,AUS)
} endif
if mpbutton(LamellenID,2,PageID)==3 then {
	write(GALamellen2,EIN)
} endif
if (mpbutton(LamellenID,2,PageID)==2 and GALamellen2==EIN) then {
	write(GALamellen2,EIN)
} endif
if (mpbutton(LamellenID,2,PageID)==2 and GALamellen2==AUS) then {
	write(GALamellen2,AUS)
} endif
if mpbutton(LamellenID,3,PageID)==1 then {
	write(GALamellen3,AUS)
} endif
if mpbutton(LamellenID,3,PageID)==3 then {
	write(GALamellen3,EIN)
} endif
if (mpbutton(LamellenID,3,PageID)==2 and GALamellen3==EIN) then {
	write(GALamellen3,EIN)
} endif
if (mpbutton(LamellenID,3,PageID)==2 and GALamellen3==AUS) then {
	write(GALamellen3,AUS)
} endif
:end

// Webelement
// @date	31.10.2012
// @version	2 
// @author	Stefanie Meier, Enertex Bayern GmbH
:begin VierJalousienMitLamellen(RolloID,LamellenID,PageID,GAJalousie1,GALamellen1,GAJalousie2,GALamellen2,GAJalousie3,GALamellen3,GAJalousie4,GALamellen4)
:info $Ein Makro, um vier Jalousien mit Lamellenverstellung via WebServer steuern zu können.$\\
	:$Zahl zwischen 0 und 39 als ID der Jalousie$\\
	:$Zahl zwischen 0 und 39 als ID der Lamellen$\\
	:$Zahl zwischen 0 und 99 als ID der Seite, auf der das Element definiert wurde.$\\
	:$Gruppenadresse der 1. Jalousie (b01)$\\
	:$Gruppenadresse der 1. Lamellen (b01)$\\
	:$Gruppenadresse der 2. Jalousie (b01)$\\
	:$Gruppenadresse der 2. Lamellen (b01)$\\
	:$Gruppenadresse der 3. Jalousie (b01)$\\
	:$Gruppenadresse der 3. Lamellen (b01)$\\
	:$Gruppenadresse der 4. Jalousie (b01)$\\
	:$Gruppenadresse der 4. Lamellen (b01)$
:shortinfo $Jalousiesteuerung für vier Jalousien$

// Implementierung von Name
m_^RolloID_^PageID_Text=$$
m_^RolloID_^PageID_ICON=BLIND
m_^RolloID_^PageID_State=INACTIVE
m_^RolloID_^PageID_Deko=GREY
m_^RolloID_^PageID_Choice=1
m_^LamellenID_^PageID_Choice=1

if mpbutton(RolloID,1,PageID)==255 then {
	m_^RolloID_^PageID_Choice=1
} endif
if mpbutton(RolloID,2,PageID)==255 then {
	m_^RolloID_^PageID_Choice=2
} endif
if mpbutton(RolloID,3,PageID)==255 then {
	m_^RolloID_^PageID_Choice=3
} endif
if mpbutton(RolloID,4,PageID)==255 then {
	m_^RolloID_^PageID_Choice=4
} endif

if mpbutton(LamellenID,1,PageID)==255 then {
	m_^LamellenID_^PageID_Choice=1
} endif
if mpbutton(LamellenID,2,PageID)==255 then {
	m_^LamellenID_^PageID_Choice=2
} endif
if mpbutton(LamellenID,3,PageID)==255 then {
	m_^LamellenID_^PageID_Choice=3
} endif
if mpbutton(LamellenID,4,PageID)==255 then {
	m_^LamellenID_^PageID_Choice=4
} endif

if after(systemstart(),3000u64) then pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice) endif
if after(systemstart(),3200u64) then pdisplay(LamellenID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice) endif

if (change(GAJalousie1) or change(m_^RolloID_^PageID_Choice) and m_^RolloID_^PageID_Choice==1) then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice)
} endif
if (change(GAJalousie2) or change(m_^RolloID_^PageID_Choice) and m_^RolloID_^PageID_Choice==2) then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice)
} endif
if (change(GAJalousie3) or change(m_^RolloID_^PageID_Choice) and m_^RolloID_^PageID_Choice==3) then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice)
} endif
if (change(GAJalousie4) or change(m_^RolloID_^PageID_Choice) and m_^RolloID_^PageID_Choice==4) then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice)
} endif


if (change(GALamellen1) or change(m_^LamellenID_^PageID_Choice) and m_^LamellenID_^PageID_Choice==1) then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice)
} endif
if (change(GALamellen2) or change(m_^LamellenID_^PageID_Choice) and m_^LamellenID_^PageID_Choice==2) then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice)
} endif
if (change(GALamellen3) or change(m_^LamellenID_^PageID_Choice) and m_^LamellenID_^PageID_Choice==3) then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice)
} endif
if (change(GALamellen4) or change(m_^LamellenID_^PageID_Choice) and m_^LamellenID_^PageID_Choice==4) then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice)
} endif


if (delay(change(GAJalousie1),30000u64) or change(m_^RolloID_^PageID_Choice) or mpbutton(RolloID,1,PageID)==2) and m_^RolloID_^PageID_Choice==1 then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice) 
} endif 
if (delay(change(GAJalousie2),30000u64) or change(m_^RolloID_^PageID_Choice) or mpbutton(RolloID,2,PageID)==2) and m_^RolloID_^PageID_Choice==2 then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice) 
} endif 
if (delay(change(GAJalousie3),30000u64) or change(m_^RolloID_^PageID_Choice) or mpbutton(RolloID,2,PageID)==3) and m_^RolloID_^PageID_Choice==3 then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice) 
} endif 
if (delay(change(GAJalousie4),30000u64) or change(m_^RolloID_^PageID_Choice) or mpbutton(RolloID,2,PageID)==4) and m_^RolloID_^PageID_Choice==5 then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice) 
} endif 


if (delay(change(GALamellen1),30000u64) or change(m_^LamellenID_^PageID_Choice) or mpbutton(LamellenID,1,PageID)==2) and m_^LamellenID_^PageID_Choice==1 then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice) 
} endif 
if (delay(change(GALamellen2),30000u64) or change(m_^LamellenID_^PageID_Choice) or mpbutton(LamellenID,2,PageID)==2) and m_^LamellenID_^PageID_Choice==2 then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice) 
} endif 
if (delay(change(GALamellen3),30000u64) or change(m_^LamellenID_^PageID_Choice) or mpbutton(LamellenID,2,PageID)==3) and m_^LamellenID_^PageID_Choice==3 then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice) 
} endif 
if (delay(change(GALamellen4),30000u64) or change(m_^LamellenID_^PageID_Choice) or mpbutton(LamellenID,2,PageID)==4) and m_^LamellenID_^PageID_Choice==4 then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice) 
} endif 


if mpbutton(RolloID,1,PageID)==1 then {
	write(GAJalousie1,AUS)
} endif
if mpbutton(RolloID,1,PageID)==3 then {
	write(GAJalousie1,EIN)
} endif
if (mpbutton(RolloID,1,PageID)==2 and GAJalousie1==EIN) then {
	write(GAJalousie1,EIN)
} endif
if (mpbutton(RolloID,1,PageID)==2 and GAJalousie1==AUS) then {
	write(GAJalousie1,AUS)
} endif
if mpbutton(RolloID,2,PageID)==1 then {
	write(GAJalousie2,AUS)
} endif
if mpbutton(RolloID,2,PageID)==3 then {
	write(GAJalousie2,EIN)
} endif
if (mpbutton(RolloID,2,PageID)==2 and GAJalousie2==EIN) then {
	write(GAJalousie2,EIN)
} endif
if (mpbutton(RolloID,2,PageID)==2 and GAJalousie2==AUS) then {
	write(GAJalousie2,AUS)
} endif
if mpbutton(RolloID,3,PageID)==1 then {
	write(GAJalousie3,AUS)
} endif
if mpbutton(RolloID,3,PageID)==3 then {
	write(GAJalousie3,EIN)
} endif
if (mpbutton(RolloID,3,PageID)==2 and GAJalousie3==EIN) then {
	write(GAJalousie3,EIN)
} endif
if (mpbutton(RolloID,3,PageID)==2 and GAJalousie3==AUS) then {
	write(GAJalousie3,AUS)
} endif
if mpbutton(RolloID,4,PageID)==1 then {
	write(GAJalousie4,AUS)
} endif
if mpbutton(RolloID,4,PageID)==3 then {
	write(GAJalousie4,EIN)
} endif
if (mpbutton(RolloID,4,PageID)==2 and GAJalousie4==EIN) then {
	write(GAJalousie4,EIN)
} endif
if (mpbutton(RolloID,4,PageID)==2 and GAJalousie4==AUS) then {
	write(GAJalousie4,AUS)
} endif


if mpbutton(LamellenID,1,PageID)==1 then {
	write(GALamellen1,AUS)
} endif
if mpbutton(LamellenID,1,PageID)==3 then {
	write(GALamellen1,EIN)
} endif
if (mpbutton(LamellenID,1,PageID)==2 and GALamellen1==EIN) then {
	write(GALamellen1,EIN)
} endif
if (mpbutton(LamellenID,1,PageID)==2 and GALamellen1==AUS) then {
	write(GALamellen1,AUS)
} endif
if mpbutton(LamellenID,2,PageID)==1 then {
	write(GALamellen2,AUS)
} endif
if mpbutton(LamellenID,2,PageID)==3 then {
	write(GALamellen2,EIN)
} endif
if (mpbutton(LamellenID,2,PageID)==2 and GALamellen2==EIN) then {
	write(GALamellen2,EIN)
} endif
if (mpbutton(LamellenID,2,PageID)==2 and GALamellen2==AUS) then {
	write(GALamellen2,AUS)
} endif
if mpbutton(LamellenID,3,PageID)==1 then {
	write(GALamellen3,AUS)
} endif
if mpbutton(LamellenID,3,PageID)==3 then {
	write(GALamellen3,EIN)
} endif
if (mpbutton(LamellenID,3,PageID)==2 and GALamellen3==EIN) then {
	write(GALamellen3,EIN)
} endif
if (mpbutton(LamellenID,3,PageID)==2 and GALamellen3==AUS) then {
	write(GALamellen3,AUS)
} endif
if mpbutton(LamellenID,4,PageID)==1 then {
	write(GALamellen4,AUS)
} endif
if mpbutton(LamellenID,4,PageID)==3 then {
	write(GALamellen4,EIN)
} endif
if (mpbutton(LamellenID,4,PageID)==2 and GALamellen4==EIN) then {
	write(GALamellen4,EIN)
} endif
if (mpbutton(LamellenID,4,PageID)==2 and GALamellen4==AUS) then {
	write(GALamellen4,AUS)
} endif

:end



// Webelement
// @date	24.08.2012
// @version	2 
// @author	Stefanie Meier, Enertex Bayern GmbH
:begin FuenJalousienMitLamellen(RolloID,LamellenID,PageID,GAJalousie1,GALamellen1,GAJalousie2,GALamellen2,GAJalousie3,GALamellen3,GAJalousie4,GALamellen4,GAJalousie5,GALamellen5)
:info $Ein Makro, um fünf Jalousien mit Lamellenverstellung via WebServer steuern zu können.$\\
	:$Zahl zwischen 0 und 39 als ID der Jalousie$\\
	:$Zahl zwischen 0 und 39 als ID der Lamellen$\\
	:$Zahl zwischen 0 und 99 als ID der Seite, auf der das Element definiert wurde.$\\
	:$Gruppenadresse der 1. Jalousie (b01)$\\
	:$Gruppenadresse der 1. Lamellen (b01)$\\
	:$Gruppenadresse der 2. Jalousie (b01)$\\
	:$Gruppenadresse der 2. Lamellen (b01)$\\
	:$Gruppenadresse der 3. Jalousie (b01)$\\
	:$Gruppenadresse der 3. Lamellen (b01)$\\
	:$Gruppenadresse der 4. Jalousie (b01)$\\
	:$Gruppenadresse der 4. Lamellen (b01)$\\
	:$Gruppenadresse der 5. Jalousie (b01)$\\
	:$Gruppenadresse der 5. Lamellen (b01)$
:shortinfo $Jalousiesteuerung für fünf Jalousien$

// Implementierung von Name
m_^RolloID_^PageID_Text=$$
m_^RolloID_^PageID_ICON=BLIND
m_^RolloID_^PageID_State=INACTIVE
m_^RolloID_^PageID_Deko=GREY
m_^RolloID_^PageID_Choice=1
m_^LamellenID_^PageID_Choice=1

if mpbutton(RolloID,1,PageID)==255 then {
	m_^RolloID_^PageID_Choice=1
} endif
if mpbutton(RolloID,2,PageID)==255 then {
	m_^RolloID_^PageID_Choice=2
} endif
if mpbutton(RolloID,3,PageID)==255 then {
	m_^RolloID_^PageID_Choice=3
} endif
if mpbutton(RolloID,4,PageID)==255 then {
	m_^RolloID_^PageID_Choice=4
} endif
if mpbutton(RolloID,5,PageID)==255 then {
	m_^RolloID_^PageID_Choice=5
} endif

if mpbutton(LamellenID,1,PageID)==255 then {
	m_^LamellenID_^PageID_Choice=1
} endif
if mpbutton(LamellenID,2,PageID)==255 then {
	m_^LamellenID_^PageID_Choice=2
} endif
if mpbutton(LamellenID,3,PageID)==255 then {
	m_^LamellenID_^PageID_Choice=3
} endif
if mpbutton(LamellenID,4,PageID)==255 then {
	m_^LamellenID_^PageID_Choice=4
} endif
if mpbutton(LamellenID,5,PageID)==255 then {
	m_^LamellenID_^PageID_Choice=5
} endif

if after(systemstart(),3000u64) then pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice) endif
if after(systemstart(),3200u64) then pdisplay(LamellenID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice) endif

if (change(GAJalousie1) or change(m_^RolloID_^PageID_Choice) and m_^RolloID_^PageID_Choice==1) then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice)
} endif
if (change(GAJalousie2) or change(m_^RolloID_^PageID_Choice) and m_^RolloID_^PageID_Choice==2) then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice)
} endif
if (change(GAJalousie3) or change(m_^RolloID_^PageID_Choice) and m_^RolloID_^PageID_Choice==3) then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice)
} endif
if (change(GAJalousie4) or change(m_^RolloID_^PageID_Choice) and m_^RolloID_^PageID_Choice==4) then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice)
} endif
if (change(GAJalousie5) or change(m_^RolloID_^PageID_Choice) and m_^RolloID_^PageID_Choice==5) then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice)
} endif

if (change(GALamellen1) or change(m_^LamellenID_^PageID_Choice) and m_^LamellenID_^PageID_Choice==1) then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice)
} endif
if (change(GALamellen2) or change(m_^LamellenID_^PageID_Choice) and m_^LamellenID_^PageID_Choice==2) then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice)
} endif
if (change(GALamellen3) or change(m_^LamellenID_^PageID_Choice) and m_^LamellenID_^PageID_Choice==3) then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice)
} endif
if (change(GALamellen4) or change(m_^LamellenID_^PageID_Choice) and m_^LamellenID_^PageID_Choice==4) then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice)
} endif
if (change(GALamellen5) or change(m_^LamellenID_^PageID_Choice) and m_^LamellenID_^PageID_Choice==5) then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice)
} endif

if (delay(change(GAJalousie1),30000u64) or change(m_^RolloID_^PageID_Choice) or mpbutton(RolloID,1,PageID)==2) and m_^RolloID_^PageID_Choice==1 then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice) 
} endif 
if (delay(change(GAJalousie2),30000u64) or change(m_^RolloID_^PageID_Choice) or mpbutton(RolloID,2,PageID)==2) and m_^RolloID_^PageID_Choice==2 then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice) 
} endif 
if (delay(change(GAJalousie3),30000u64) or change(m_^RolloID_^PageID_Choice) or mpbutton(RolloID,2,PageID)==3) and m_^RolloID_^PageID_Choice==3 then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice) 
} endif 
if (delay(change(GAJalousie4),30000u64) or change(m_^RolloID_^PageID_Choice) or mpbutton(RolloID,2,PageID)==4) and m_^RolloID_^PageID_Choice==5 then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice) 
} endif 
if (delay(change(GAJalousie5),30000u64) or change(m_^RolloID_^PageID_Choice) or mpbutton(RolloID,2,PageID)==5) and m_^RolloID_^PageID_Choice==4 then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice) 
} endif 

if (delay(change(GALamellen1),30000u64) or change(m_^LamellenID_^PageID_Choice) or mpbutton(LamellenID,1,PageID)==2) and m_^LamellenID_^PageID_Choice==1 then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice) 
} endif 
if (delay(change(GALamellen2),30000u64) or change(m_^LamellenID_^PageID_Choice) or mpbutton(LamellenID,2,PageID)==2) and m_^LamellenID_^PageID_Choice==2 then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice) 
} endif 
if (delay(change(GALamellen3),30000u64) or change(m_^LamellenID_^PageID_Choice) or mpbutton(LamellenID,2,PageID)==3) and m_^LamellenID_^PageID_Choice==3 then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice) 
} endif 
if (delay(change(GALamellen4),30000u64) or change(m_^LamellenID_^PageID_Choice) or mpbutton(LamellenID,2,PageID)==4) and m_^LamellenID_^PageID_Choice==4 then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice) 
} endif 
if (delay(change(GALamellen5),30000u64) or change(m_^LamellenID_^PageID_Choice) or mpbutton(LamellenID,2,PageID)==5) and m_^LamellenID_^PageID_Choice==5 then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice) 
} endif 

if mpbutton(RolloID,1,PageID)==1 then {
	write(GAJalousie1,AUS)
} endif
if mpbutton(RolloID,1,PageID)==3 then {
	write(GAJalousie1,EIN)
} endif
if (mpbutton(RolloID,1,PageID)==2 and GAJalousie1==EIN) then {
	write(GAJalousie1,EIN)
} endif
if (mpbutton(RolloID,1,PageID)==2 and GAJalousie1==AUS) then {
	write(GAJalousie1,AUS)
} endif
if mpbutton(RolloID,2,PageID)==1 then {
	write(GAJalousie2,AUS)
} endif
if mpbutton(RolloID,2,PageID)==3 then {
	write(GAJalousie2,EIN)
} endif
if (mpbutton(RolloID,2,PageID)==2 and GAJalousie2==EIN) then {
	write(GAJalousie2,EIN)
} endif
if (mpbutton(RolloID,2,PageID)==2 and GAJalousie2==AUS) then {
	write(GAJalousie2,AUS)
} endif
if mpbutton(RolloID,3,PageID)==1 then {
	write(GAJalousie3,AUS)
} endif
if mpbutton(RolloID,3,PageID)==3 then {
	write(GAJalousie3,EIN)
} endif
if (mpbutton(RolloID,3,PageID)==2 and GAJalousie3==EIN) then {
	write(GAJalousie3,EIN)
} endif
if (mpbutton(RolloID,3,PageID)==2 and GAJalousie3==AUS) then {
	write(GAJalousie3,AUS)
} endif
if mpbutton(RolloID,4,PageID)==1 then {
	write(GAJalousie4,AUS)
} endif
if mpbutton(RolloID,4,PageID)==3 then {
	write(GAJalousie4,EIN)
} endif
if (mpbutton(RolloID,4,PageID)==2 and GAJalousie4==EIN) then {
	write(GAJalousie4,EIN)
} endif
if (mpbutton(RolloID,4,PageID)==2 and GAJalousie4==AUS) then {
	write(GAJalousie4,AUS)
} endif
if mpbutton(RolloID,5,PageID)==1 then {
	write(GAJalousie5,AUS)
} endif
if mpbutton(RolloID,5,PageID)==3 then {
	write(GAJalousie5,EIN)
} endif
if (mpbutton(RolloID,5,PageID)==2 and GAJalousie5==EIN) then {
	write(GAJalousie5,EIN)
} endif
if (mpbutton(RolloID,5,PageID)==2 and GAJalousie5==AUS) then {
	write(GAJalousie5,AUS)
} endif

if mpbutton(LamellenID,1,PageID)==1 then {
	write(GALamellen1,AUS)
} endif
if mpbutton(LamellenID,1,PageID)==3 then {
	write(GALamellen1,EIN)
} endif
if (mpbutton(LamellenID,1,PageID)==2 and GALamellen1==EIN) then {
	write(GALamellen1,EIN)
} endif
if (mpbutton(LamellenID,1,PageID)==2 and GALamellen1==AUS) then {
	write(GALamellen1,AUS)
} endif
if mpbutton(LamellenID,2,PageID)==1 then {
	write(GALamellen2,AUS)
} endif
if mpbutton(LamellenID,2,PageID)==3 then {
	write(GALamellen2,EIN)
} endif
if (mpbutton(LamellenID,2,PageID)==2 and GALamellen2==EIN) then {
	write(GALamellen2,EIN)
} endif
if (mpbutton(LamellenID,2,PageID)==2 and GALamellen2==AUS) then {
	write(GALamellen2,AUS)
} endif
if mpbutton(LamellenID,3,PageID)==1 then {
	write(GALamellen3,AUS)
} endif
if mpbutton(LamellenID,3,PageID)==3 then {
	write(GALamellen3,EIN)
} endif
if (mpbutton(LamellenID,3,PageID)==2 and GALamellen3==EIN) then {
	write(GALamellen3,EIN)
} endif
if (mpbutton(LamellenID,3,PageID)==2 and GALamellen3==AUS) then {
	write(GALamellen3,AUS)
} endif
if mpbutton(LamellenID,4,PageID)==1 then {
	write(GALamellen4,AUS)
} endif
if mpbutton(LamellenID,4,PageID)==3 then {
	write(GALamellen4,EIN)
} endif
if (mpbutton(LamellenID,4,PageID)==2 and GALamellen4==EIN) then {
	write(GALamellen4,EIN)
} endif
if (mpbutton(LamellenID,4,PageID)==2 and GALamellen4==AUS) then {
	write(GALamellen4,AUS)
} endif
if mpbutton(LamellenID,5,PageID)==1 then {
	write(GALamellen5,AUS)
} endif
if mpbutton(LamellenID,5,PageID)==3 then {
	write(GALamellen5,EIN)
} endif
if (mpbutton(LamellenID,5,PageID)==2 and GALamellen5==EIN) then {
	write(GALamellen5,EIN)
} endif
if (mpbutton(LamellenID,5,PageID)==2 and GALamellen5==AUS) then {
	write(GALamellen5,AUS)
} endif

:end

-------------------------------------
// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin JalousieMitLamellenStopp(RolloID,JalousieID,PageID,GAJalousie,GALamellen)
:info $Ein Makro, um die Jalousie mit Lamellenverstellung via WebServer steuern zu können. Stopp durch Objekt Kurzzeitbetrieb.$\\
	:$Zahl zwischen 0 und 39 als ID der Jalousie$\\
	:$Zahl zwischen 0 und 39 als ID der Lamellen$\\
	:$Zahl zwischen 0 und 99 als ID der Seite, auf der das Element definiert wurde.$\\
	:$Gruppenadresse der Jalousie (b01)$\\
	:$Gruppenadresse der Lamellen (b01)$
:shortinfo $Jalousiesteuerung. Stopp durch Objekt Kurzzeitbetrieb.$

// Implementierung von Name
m_^RolloID_^PageID_Text=$$
m_^RolloID_^PageID_ICON=BLIND
m_^RolloID_^PageID_State=INACTIVE
m_^RolloID_^PageID_Deko=GREY

if after(systemstart(),3000u64) then pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID) endif
if after(systemstart(),3200u64) then pdisplay(JalousieID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID) endif

if change(GAJalousie) then pdisplay(RolloID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID) endif
if change(GALamellen) then pdisplay(JalousieID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID) endif

if (delay(change(GAJalousie),30000u64) or pbutton(RolloID,PageID)==2) then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID)
} endif
if (delay(change(GALamellen),30000u64) or pbutton(JalousieID,PageID)==2) then {
	pdisplay(JalousieID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID)
} endif
if pbutton(RolloID,PageID)==1 then {
	write(GAJalousie,AUS)
} endif
if pbutton(RolloID,PageID)==3 then {
	write(GAJalousie,EIN)
} endif
if (pbutton(RolloID,PageID)==2 and GAJalousie==EIN) then {
	write(GALamellen,EIN)
} endif
if (pbutton(RolloID,PageID)==2 and GAJalousie==AUS) then {
	write(GALamellen,AUS)
} endif
if pbutton(JalousieID,PageID)==1 then {
	write(GALamellen,AUS)
} endif
if pbutton(JalousieID,PageID)==3 then {
	write(GALamellen,EIN)
} endif
if (pbutton(JalousieID,PageID)==2 and GALamellen==EIN) then {
	write(GALamellen,EIN)
} endif
if (pbutton(JalousieID,PageID)==2 and GALamellen==AUS) then {
	write(GALamellen,AUS)
} endif

:end


// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin ZweiJalousienMitLamellenStopp(RolloID,LamellenID,PageID,GAJalousie1,GALamellen1,GAJalousie2,GALamellen2)
:info $Ein Makro, um zwei Jalousien mit Lamellenverstellung via WebServer steuern zu können. Stopp durch Objekt Kurzzeitbetrieb.$\\
	:$Zahl zwischen 0 und 39 als ID der Jalousie$\\
	:$Zahl zwischen 0 und 39 als ID der Lamellen$\\
	:$Zahl zwischen 0 und 99 als ID der Seite, auf der das Element definiert wurde.$\\
	:$Gruppenadresse der 1. Jalousie (b01)$\\
	:$Gruppenadresse der 1. Lamellen (b01)$\\
	:$Gruppenadresse der 2. Jalousie (b01)$\\
	:$Gruppenadresse der 2. Lamellen (b01)$
:shortinfo $Jalousiesteuerung für zwei Jalousien. Stopp durch Objekt Kurzzeitbetrieb.$

// Implementierung von Name
m_^RolloID_^PageID_Text=$$
m_^RolloID_^PageID_ICON=BLIND
m_^RolloID_^PageID_State=INACTIVE
m_^RolloID_^PageID_Deko=GREY
m_^RolloID_^PageID_Choice=1
m_^LamellenID_^PageID_Choice=1

if mpbutton(RolloID,1,PageID)==255 then {
	m_^RolloID_^PageID_Choice=1
} endif
if mpbutton(RolloID,2,PageID)==255 then {
	m_^RolloID_^PageID_Choice=2
} endif
if mpbutton(LamellenID,1,PageID)==255 then {
	m_^LamellenID_^PageID_Choice=1
} endif
if mpbutton(LamellenID,2,PageID)==255 then {
	m_^LamellenID_^PageID_Choice=2
} endif

if after(systemstart(),3000u64) then pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice) endif
if after(systemstart(),3200u64) then pdisplay(LamellenID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice) endif

if (change(GAJalousie1) or change(m_^RolloID_^PageID_Choice) and m_^RolloID_^PageID_Choice==1) then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice)
} endif
if (change(GAJalousie2) or change(m_^RolloID_^PageID_Choice) and m_^RolloID_^PageID_Choice==2) then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice)
} endif
if (change(GALamellen1) or change(m_^LamellenID_^PageID_Choice) and m_^LamellenID_^PageID_Choice==1) then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice)
} endif
if (change(GALamellen2) or change(m_^LamellenID_^PageID_Choice) and m_^LamellenID_^PageID_Choice==2) then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice)
} endif
if (delay(change(GAJalousie1),30000u64) or change(m_^RolloID_^PageID_Choice) or mpbutton(RolloID,1,PageID)==2) and m_^RolloID_^PageID_Choice==1 then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice) 
} endif 
if (delay(change(GAJalousie2),30000u64) or change(m_^RolloID_^PageID_Choice) or mpbutton(RolloID,2,PageID)==2) and m_^RolloID_^PageID_Choice==2 then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice) 
} endif 
if (delay(change(GALamellen1),30000u64) or change(m_^LamellenID_^PageID_Choice) or mpbutton(LamellenID,1,PageID)==2) and m_^LamellenID_^PageID_Choice==1 then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice) 
} endif 
if (delay(change(GALamellen2),30000u64) or change(m_^LamellenID_^PageID_Choice) or mpbutton(LamellenID,2,PageID)==2) and m_^LamellenID_^PageID_Choice==2 then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice) 
} endif 

if mpbutton(RolloID,1,PageID)==1 then {
	write(GAJalousie1,AUS)
} endif
if mpbutton(RolloID,1,PageID)==3 then {
	write(GAJalousie1,EIN)
} endif
if (mpbutton(RolloID,1,PageID)==2 and GAJalousie1==EIN) then {
	write(GALamellen1,EIN)
} endif
if (mpbutton(RolloID,1,PageID)==2 and GAJalousie1==AUS) then {
	write(GALamellen1,AUS)
} endif
if mpbutton(RolloID,2,PageID)==1 then {
	write(GAJalousie2,AUS)
} endif
if mpbutton(RolloID,2,PageID)==3 then {
	write(GAJalousie2,EIN)
} endif
if (mpbutton(RolloID,2,PageID)==2 and GAJalousie2==EIN) then {
	write(GALamellen2,EIN)
} endif
if (mpbutton(RolloID,2,PageID)==2 and GAJalousie2==AUS) then {
	write(GALamellen2,AUS)
} endif
if mpbutton(LamellenID,1,PageID)==1 then {
	write(GALamellen1,AUS)
} endif
if mpbutton(LamellenID,1,PageID)==3 then {
	write(GALamellen1,EIN)
} endif
if (mpbutton(LamellenID,1,PageID)==2 and GALamellen1==EIN) then {
	write(GALamellen1,EIN)
} endif
if (mpbutton(LamellenID,1,PageID)==2 and GALamellen1==AUS) then {
	write(GALamellen1,AUS)
} endif
if mpbutton(LamellenID,2,PageID)==1 then {
	write(GALamellen2,AUS)
} endif
if mpbutton(LamellenID,2,PageID)==3 then {
	write(GALamellen2,EIN)
} endif
if (mpbutton(LamellenID,2,PageID)==2 and GALamellen2==EIN) then {
	write(GALamellen2,EIN)
} endif
if (mpbutton(LamellenID,2,PageID)==2 and GALamellen2==AUS) then {
	write(GALamellen2,AUS)
} endif
:end


// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin DreiJalousienMitLamellenStopp(RolloID,LamellenID,PageID,GAJalousie1,GALamellen1,GAJalousie2,GALamellen2,GAJalousie3,GALamellen3)
:info $Ein Makro, um drei Jalousien mit Lamellenverstellung via WebServer steuern zu können. Stopp durch Objekt Kurzzeitbetrieb.$\\
	:$Zahl zwischen 0 und 39 als ID der Jalousie$\\
	:$Zahl zwischen 0 und 39 als ID der Lamellen$\\
	:$Zahl zwischen 0 und 99 als ID der Seite, auf der das Element definiert wurde.$\\
	:$Gruppenadresse der 1. Jalousie (b01)$\\
	:$Gruppenadresse der 1. Lamellen (b01)$\\
	:$Gruppenadresse der 2. Jalousie (b01)$\\
	:$Gruppenadresse der 2. Lamellen (b01)$\\
	:$Gruppenadresse der 3. Jalousie (b01)$\\
	:$Gruppenadresse der 3. Lamellen (b01)$
:shortinfo $Jalousiesteuerung für drei Jalousien. Stopp durch Objekt Kurzzeitbetrieb.$

// Implementierung von Name
m_^RolloID_^PageID_Text=$$
m_^RolloID_^PageID_ICON=BLIND
m_^RolloID_^PageID_State=INACTIVE
m_^RolloID_^PageID_Deko=GREY
m_^RolloID_^PageID_Choice=1
m_^LamellenID_^PageID_Choice=1

if mpbutton(RolloID,1,PageID)==255 then {
	m_^RolloID_^PageID_Choice=1
} endif
if mpbutton(RolloID,2,PageID)==255 then {
	m_^RolloID_^PageID_Choice=2
} endif
if mpbutton(RolloID,3,PageID)==255 then {
	m_^RolloID_^PageID_Choice=3
} endif

if mpbutton(LamellenID,1,PageID)==255 then {
	m_^LamellenID_^PageID_Choice=1
} endif
if mpbutton(LamellenID,2,PageID)==255 then {
	m_^LamellenID_^PageID_Choice=2
} endif
if mpbutton(LamellenID,3,PageID)==255 then {
	m_^LamellenID_^PageID_Choice=3
} endif

if after(systemstart(),3000u64) then pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice) endif
if after(systemstart(),3200u64) then pdisplay(LamellenID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice) endif

if (change(GAJalousie1) or change(m_^RolloID_^PageID_Choice) and m_^RolloID_^PageID_Choice==1) then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice)
} endif
if (change(GAJalousie2) or change(m_^RolloID_^PageID_Choice) and m_^RolloID_^PageID_Choice==2) then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice)
} endif
if (change(GAJalousie3) or change(m_^RolloID_^PageID_Choice) and m_^RolloID_^PageID_Choice==3) then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice)
} endif

if (change(GALamellen1) or change(m_^LamellenID_^PageID_Choice) and m_^LamellenID_^PageID_Choice==1) then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice)
} endif
if (change(GALamellen2) or change(m_^LamellenID_^PageID_Choice) and m_^LamellenID_^PageID_Choice==2) then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice)
} endif
if (change(GALamellen3) or change(m_^LamellenID_^PageID_Choice) and m_^LamellenID_^PageID_Choice==3) then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice)
} endif

if (delay(change(GAJalousie1),30000u64) or change(m_^RolloID_^PageID_Choice) or mpbutton(RolloID,1,PageID)==2) and m_^RolloID_^PageID_Choice==1 then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice) 
} endif 
if (delay(change(GAJalousie2),30000u64) or change(m_^RolloID_^PageID_Choice) or mpbutton(RolloID,2,PageID)==2) and m_^RolloID_^PageID_Choice==2 then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice) 
} endif 
if (delay(change(GAJalousie3),30000u64) or change(m_^RolloID_^PageID_Choice) or mpbutton(RolloID,2,PageID)==3) and m_^RolloID_^PageID_Choice==3 then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice) 
} endif 

if (delay(change(GALamellen1),30000u64) or change(m_^LamellenID_^PageID_Choice) or mpbutton(LamellenID,1,PageID)==2) and m_^LamellenID_^PageID_Choice==1 then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice) 
} endif 
if (delay(change(GALamellen2),30000u64) or change(m_^LamellenID_^PageID_Choice) or mpbutton(LamellenID,2,PageID)==2) and m_^LamellenID_^PageID_Choice==2 then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice) 
} endif 
if (delay(change(GALamellen2),30000u64) or change(m_^LamellenID_^PageID_Choice) or mpbutton(LamellenID,2,PageID)==3) and m_^LamellenID_^PageID_Choice==3 then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice) 
} endif 

if mpbutton(RolloID,1,PageID)==1 then {
	write(GAJalousie1,AUS)
} endif
if mpbutton(RolloID,1,PageID)==3 then {
	write(GAJalousie1,EIN)
} endif
if (mpbutton(RolloID,1,PageID)==2 and GAJalousie1==EIN) then {
	write(GALamellen1,EIN)
} endif
if (mpbutton(RolloID,1,PageID)==2 and GAJalousie1==AUS) then {
	write(GALamellen1,AUS)
} endif
if mpbutton(RolloID,2,PageID)==1 then {
	write(GAJalousie2,AUS)
} endif
if mpbutton(RolloID,2,PageID)==3 then {
	write(GAJalousie2,EIN)
} endif
if (mpbutton(RolloID,2,PageID)==2 and GAJalousie2==EIN) then {
	write(GALamellen2,EIN)
} endif
if (mpbutton(RolloID,2,PageID)==2 and GAJalousie2==AUS) then {
	write(GALamellen2,AUS)
} endif
if mpbutton(RolloID,3,PageID)==1 then {
	write(GAJalousie3,AUS)
} endif
if mpbutton(RolloID,3,PageID)==3 then {
	write(GAJalousie3,EIN)
} endif
if (mpbutton(RolloID,3,PageID)==2 and GAJalousie3==EIN) then {
	write(GALamellen3,EIN)
} endif
if (mpbutton(RolloID,3,PageID)==2 and GAJalousie3==AUS) then {
	write(GALamellen3,AUS)
} endif

if mpbutton(LamellenID,1,PageID)==1 then {
	write(GALamellen1,AUS)
} endif
if mpbutton(LamellenID,1,PageID)==3 then {
	write(GALamellen1,EIN)
} endif
if (mpbutton(LamellenID,1,PageID)==2 and GALamellen1==EIN) then {
	write(GALamellen1,EIN)
} endif
if (mpbutton(LamellenID,1,PageID)==2 and GALamellen1==AUS) then {
	write(GALamellen1,AUS)
} endif
if mpbutton(LamellenID,2,PageID)==1 then {
	write(GALamellen2,AUS)
} endif
if mpbutton(LamellenID,2,PageID)==3 then {
	write(GALamellen2,EIN)
} endif
if (mpbutton(LamellenID,2,PageID)==2 and GALamellen2==EIN) then {
	write(GALamellen2,EIN)
} endif
if (mpbutton(LamellenID,2,PageID)==2 and GALamellen2==AUS) then {
	write(GALamellen2,AUS)
} endif
if mpbutton(LamellenID,3,PageID)==1 then {
	write(GALamellen3,AUS)
} endif
if mpbutton(LamellenID,3,PageID)==3 then {
	write(GALamellen3,EIN)
} endif
if (mpbutton(LamellenID,3,PageID)==2 and GALamellen3==EIN) then {
	write(GALamellen3,EIN)
} endif
if (mpbutton(LamellenID,3,PageID)==2 and GALamellen3==AUS) then {
	write(GALamellen3,AUS)
} endif
:end

// Webelement
// @date	31.10.2012
// @version	2 
// @author	Stefanie Meier, Enertex Bayern GmbH
:begin VierJalousienMitLamellenStopp(RolloID,LamellenID,PageID,GAJalousie1,GALamellen1,GAJalousie2,GALamellen2,GAJalousie3,GALamellen3,GAJalousie4,GALamellen4)
:info $Ein Makro, um vier Jalousien mit Lamellenverstellung via WebServer steuern zu können. Stopp durch Objekt Kurzzeitbetrieb.$\\
	:$Zahl zwischen 0 und 39 als ID der Jalousie$\\
	:$Zahl zwischen 0 und 39 als ID der Lamellen$\\
	:$Zahl zwischen 0 und 99 als ID der Seite, auf der das Element definiert wurde.$\\
	:$Gruppenadresse der 1. Jalousie (b01)$\\
	:$Gruppenadresse der 1. Lamellen (b01)$\\
	:$Gruppenadresse der 2. Jalousie (b01)$\\
	:$Gruppenadresse der 2. Lamellen (b01)$\\
	:$Gruppenadresse der 3. Jalousie (b01)$\\
	:$Gruppenadresse der 3. Lamellen (b01)$\\
	:$Gruppenadresse der 4. Jalousie (b01)$\\
	:$Gruppenadresse der 4. Lamellen (b01)$
:shortinfo $Jalousiesteuerung für vier Jalousien. Stopp durch Objekt Kurzzeitbetrieb.$

// Implementierung von Name
m_^RolloID_^PageID_Text=$$
m_^RolloID_^PageID_ICON=BLIND
m_^RolloID_^PageID_State=INACTIVE
m_^RolloID_^PageID_Deko=GREY
m_^RolloID_^PageID_Choice=1
m_^LamellenID_^PageID_Choice=1

if mpbutton(RolloID,1,PageID)==255 then {
	m_^RolloID_^PageID_Choice=1
} endif
if mpbutton(RolloID,2,PageID)==255 then {
	m_^RolloID_^PageID_Choice=2
} endif
if mpbutton(RolloID,3,PageID)==255 then {
	m_^RolloID_^PageID_Choice=3
} endif
if mpbutton(RolloID,4,PageID)==255 then {
	m_^RolloID_^PageID_Choice=4
} endif

if mpbutton(LamellenID,1,PageID)==255 then {
	m_^LamellenID_^PageID_Choice=1
} endif
if mpbutton(LamellenID,2,PageID)==255 then {
	m_^LamellenID_^PageID_Choice=2
} endif
if mpbutton(LamellenID,3,PageID)==255 then {
	m_^LamellenID_^PageID_Choice=3
} endif
if mpbutton(LamellenID,4,PageID)==255 then {
	m_^LamellenID_^PageID_Choice=4
} endif

if after(systemstart(),3000u64) then pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice) endif
if after(systemstart(),3200u64) then pdisplay(LamellenID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice) endif

if (change(GAJalousie1) or change(m_^RolloID_^PageID_Choice) and m_^RolloID_^PageID_Choice==1) then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice)
} endif
if (change(GAJalousie2) or change(m_^RolloID_^PageID_Choice) and m_^RolloID_^PageID_Choice==2) then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice)
} endif
if (change(GAJalousie3) or change(m_^RolloID_^PageID_Choice) and m_^RolloID_^PageID_Choice==3) then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice)
} endif
if (change(GAJalousie4) or change(m_^RolloID_^PageID_Choice) and m_^RolloID_^PageID_Choice==4) then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice)
} endif


if (change(GALamellen1) or change(m_^LamellenID_^PageID_Choice) and m_^LamellenID_^PageID_Choice==1) then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice)
} endif
if (change(GALamellen2) or change(m_^LamellenID_^PageID_Choice) and m_^LamellenID_^PageID_Choice==2) then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice)
} endif
if (change(GALamellen3) or change(m_^LamellenID_^PageID_Choice) and m_^LamellenID_^PageID_Choice==3) then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice)
} endif
if (change(GALamellen4) or change(m_^LamellenID_^PageID_Choice) and m_^LamellenID_^PageID_Choice==4) then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice)
} endif


if (delay(change(GAJalousie1),30000u64) or change(m_^RolloID_^PageID_Choice) or mpbutton(RolloID,1,PageID)==2) and m_^RolloID_^PageID_Choice==1 then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice) 
} endif 
if (delay(change(GAJalousie2),30000u64) or change(m_^RolloID_^PageID_Choice) or mpbutton(RolloID,2,PageID)==2) and m_^RolloID_^PageID_Choice==2 then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice) 
} endif 
if (delay(change(GAJalousie3),30000u64) or change(m_^RolloID_^PageID_Choice) or mpbutton(RolloID,2,PageID)==3) and m_^RolloID_^PageID_Choice==3 then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice) 
} endif 
if (delay(change(GAJalousie4),30000u64) or change(m_^RolloID_^PageID_Choice) or mpbutton(RolloID,2,PageID)==4) and m_^RolloID_^PageID_Choice==5 then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice) 
} endif 


if (delay(change(GALamellen1),30000u64) or change(m_^LamellenID_^PageID_Choice) or mpbutton(LamellenID,1,PageID)==2) and m_^LamellenID_^PageID_Choice==1 then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice) 
} endif 
if (delay(change(GALamellen2),30000u64) or change(m_^LamellenID_^PageID_Choice) or mpbutton(LamellenID,2,PageID)==2) and m_^LamellenID_^PageID_Choice==2 then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice) 
} endif 
if (delay(change(GALamellen3),30000u64) or change(m_^LamellenID_^PageID_Choice) or mpbutton(LamellenID,2,PageID)==3) and m_^LamellenID_^PageID_Choice==3 then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice) 
} endif 
if (delay(change(GALamellen4),30000u64) or change(m_^LamellenID_^PageID_Choice) or mpbutton(LamellenID,2,PageID)==4) and m_^LamellenID_^PageID_Choice==4 then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice) 
} endif 


if mpbutton(RolloID,1,PageID)==1 then {
	write(GAJalousie1,AUS)
} endif
if mpbutton(RolloID,1,PageID)==3 then {
	write(GAJalousie1,EIN)
} endif
if (mpbutton(RolloID,1,PageID)==2 and GAJalousie1==EIN) then {
	write(GALamellen1,EIN)
} endif
if (mpbutton(RolloID,1,PageID)==2 and GAJalousie1==AUS) then {
	write(GALamellen1,AUS)
} endif
if mpbutton(RolloID,2,PageID)==1 then {
	write(GAJalousie2,AUS)
} endif
if mpbutton(RolloID,2,PageID)==3 then {
	write(GAJalousie2,EIN)
} endif
if (mpbutton(RolloID,2,PageID)==2 and GAJalousie2==EIN) then {
	write(GALamellen2,EIN)
} endif
if (mpbutton(RolloID,2,PageID)==2 and GAJalousie2==AUS) then {
	write(GALamellen2,AUS)
} endif
if mpbutton(RolloID,3,PageID)==1 then {
	write(GAJalousie3,AUS)
} endif
if mpbutton(RolloID,3,PageID)==3 then {
	write(GAJalousie3,EIN)
} endif
if (mpbutton(RolloID,3,PageID)==2 and GAJalousie3==EIN) then {
	write(GALamellen3,EIN)
} endif
if (mpbutton(RolloID,3,PageID)==2 and GAJalousie3==AUS) then {
	write(GALamellen3,AUS)
} endif
if mpbutton(RolloID,4,PageID)==1 then {
	write(GAJalousie4,AUS)
} endif
if mpbutton(RolloID,4,PageID)==3 then {
	write(GAJalousie4,EIN)
} endif
if (mpbutton(RolloID,4,PageID)==2 and GAJalousie4==EIN) then {
	write(GALamellen4,EIN)
} endif
if (mpbutton(RolloID,4,PageID)==2 and GAJalousie4==AUS) then {
	write(GALamellen4,AUS)
} endif


if mpbutton(LamellenID,1,PageID)==1 then {
	write(GALamellen1,AUS)
} endif
if mpbutton(LamellenID,1,PageID)==3 then {
	write(GALamellen1,EIN)
} endif
if (mpbutton(LamellenID,1,PageID)==2 and GALamellen1==EIN) then {
	write(GALamellen1,EIN)
} endif
if (mpbutton(LamellenID,1,PageID)==2 and GALamellen1==AUS) then {
	write(GALamellen1,AUS)
} endif
if mpbutton(LamellenID,2,PageID)==1 then {
	write(GALamellen2,AUS)
} endif
if mpbutton(LamellenID,2,PageID)==3 then {
	write(GALamellen2,EIN)
} endif
if (mpbutton(LamellenID,2,PageID)==2 and GALamellen2==EIN) then {
	write(GALamellen2,EIN)
} endif
if (mpbutton(LamellenID,2,PageID)==2 and GALamellen2==AUS) then {
	write(GALamellen2,AUS)
} endif
if mpbutton(LamellenID,3,PageID)==1 then {
	write(GALamellen3,AUS)
} endif
if mpbutton(LamellenID,3,PageID)==3 then {
	write(GALamellen3,EIN)
} endif
if (mpbutton(LamellenID,3,PageID)==2 and GALamellen3==EIN) then {
	write(GALamellen3,EIN)
} endif
if (mpbutton(LamellenID,3,PageID)==2 and GALamellen3==AUS) then {
	write(GALamellen3,AUS)
} endif
if mpbutton(LamellenID,4,PageID)==1 then {
	write(GALamellen4,AUS)
} endif
if mpbutton(LamellenID,4,PageID)==3 then {
	write(GALamellen4,EIN)
} endif
if (mpbutton(LamellenID,4,PageID)==2 and GALamellen4==EIN) then {
	write(GALamellen4,EIN)
} endif
if (mpbutton(LamellenID,4,PageID)==2 and GALamellen4==AUS) then {
	write(GALamellen4,AUS)
} endif

:end



// Webelement
// @date	24.08.2012
// @version	2 
// @author	Stefanie Meier, Enertex Bayern GmbH
:begin FuenfJalousienMitLamellenStopp(RolloID,LamellenID,PageID,GAJalousie1,GALamellen1,GAJalousie2,GALamellen2,GAJalousie3,GALamellen3,GAJalousie4,GALamellen4,GAJalousie5,GALamellen5)
:info $Ein Makro, um fünf Jalousien mit Lamellenverstellung via WebServer steuern zu können. Stopp durch Objekt Kurzzeitbetrieb.$\\
	:$Zahl zwischen 0 und 39 als ID der Jalousie$\\
	:$Zahl zwischen 0 und 39 als ID der Lamellen$\\
	:$Zahl zwischen 0 und 99 als ID der Seite, auf der das Element definiert wurde.$\\
	:$Gruppenadresse der 1. Jalousie (b01)$\\
	:$Gruppenadresse der 1. Lamellen (b01)$\\
	:$Gruppenadresse der 2. Jalousie (b01)$\\
	:$Gruppenadresse der 2. Lamellen (b01)$\\
	:$Gruppenadresse der 3. Jalousie (b01)$\\
	:$Gruppenadresse der 3. Lamellen (b01)$\\
	:$Gruppenadresse der 4. Jalousie (b01)$\\
	:$Gruppenadresse der 4. Lamellen (b01)$\\
	:$Gruppenadresse der 5. Jalousie (b01)$\\
	:$Gruppenadresse der 5. Lamellen (b01)$
:shortinfo $Jalousiesteuerung für fünf Jalousien. Stopp durch Objekt Kurzzeitbetrieb.$

// Implementierung von Name
m_^RolloID_^PageID_Text=$$
m_^RolloID_^PageID_ICON=BLIND
m_^RolloID_^PageID_State=INACTIVE
m_^RolloID_^PageID_Deko=GREY
m_^RolloID_^PageID_Choice=1
m_^LamellenID_^PageID_Choice=1

if mpbutton(RolloID,1,PageID)==255 then {
	m_^RolloID_^PageID_Choice=1
} endif
if mpbutton(RolloID,2,PageID)==255 then {
	m_^RolloID_^PageID_Choice=2
} endif
if mpbutton(RolloID,3,PageID)==255 then {
	m_^RolloID_^PageID_Choice=3
} endif
if mpbutton(RolloID,4,PageID)==255 then {
	m_^RolloID_^PageID_Choice=4
} endif
if mpbutton(RolloID,5,PageID)==255 then {
	m_^RolloID_^PageID_Choice=5
} endif

if mpbutton(LamellenID,1,PageID)==255 then {
	m_^LamellenID_^PageID_Choice=1
} endif
if mpbutton(LamellenID,2,PageID)==255 then {
	m_^LamellenID_^PageID_Choice=2
} endif
if mpbutton(LamellenID,3,PageID)==255 then {
	m_^LamellenID_^PageID_Choice=3
} endif
if mpbutton(LamellenID,4,PageID)==255 then {
	m_^LamellenID_^PageID_Choice=4
} endif
if mpbutton(LamellenID,5,PageID)==255 then {
	m_^LamellenID_^PageID_Choice=5
} endif

if after(systemstart(),3000u64) then pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice) endif
if after(systemstart(),3200u64) then pdisplay(LamellenID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice) endif

if (change(GAJalousie1) or change(m_^RolloID_^PageID_Choice) and m_^RolloID_^PageID_Choice==1) then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice)
} endif
if (change(GAJalousie2) or change(m_^RolloID_^PageID_Choice) and m_^RolloID_^PageID_Choice==2) then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice)
} endif
if (change(GAJalousie3) or change(m_^RolloID_^PageID_Choice) and m_^RolloID_^PageID_Choice==3) then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice)
} endif
if (change(GAJalousie4) or change(m_^RolloID_^PageID_Choice) and m_^RolloID_^PageID_Choice==4) then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice)
} endif
if (change(GAJalousie5) or change(m_^RolloID_^PageID_Choice) and m_^RolloID_^PageID_Choice==5) then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice)
} endif

if (change(GALamellen1) or change(m_^LamellenID_^PageID_Choice) and m_^LamellenID_^PageID_Choice==1) then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice)
} endif
if (change(GALamellen2) or change(m_^LamellenID_^PageID_Choice) and m_^LamellenID_^PageID_Choice==2) then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice)
} endif
if (change(GALamellen3) or change(m_^LamellenID_^PageID_Choice) and m_^LamellenID_^PageID_Choice==3) then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice)
} endif
if (change(GALamellen4) or change(m_^LamellenID_^PageID_Choice) and m_^LamellenID_^PageID_Choice==4) then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice)
} endif
if (change(GALamellen5) or change(m_^LamellenID_^PageID_Choice) and m_^LamellenID_^PageID_Choice==5) then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,STOP,DARKRED,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice)
} endif

if (delay(change(GAJalousie1),30000u64) or change(m_^RolloID_^PageID_Choice) or mpbutton(RolloID,1,PageID)==2) and m_^RolloID_^PageID_Choice==1 then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice) 
} endif 
if (delay(change(GAJalousie2),30000u64) or change(m_^RolloID_^PageID_Choice) or mpbutton(RolloID,2,PageID)==2) and m_^RolloID_^PageID_Choice==2 then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice) 
} endif 
if (delay(change(GAJalousie3),30000u64) or change(m_^RolloID_^PageID_Choice) or mpbutton(RolloID,2,PageID)==3) and m_^RolloID_^PageID_Choice==3 then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice) 
} endif 
if (delay(change(GAJalousie4),30000u64) or change(m_^RolloID_^PageID_Choice) or mpbutton(RolloID,2,PageID)==4) and m_^RolloID_^PageID_Choice==5 then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice) 
} endif 
if (delay(change(GAJalousie5),30000u64) or change(m_^RolloID_^PageID_Choice) or mpbutton(RolloID,2,PageID)==5) and m_^RolloID_^PageID_Choice==4 then {
	pdisplay(RolloID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^RolloID_^PageID_Choice) 
} endif 

if (delay(change(GALamellen1),30000u64) or change(m_^LamellenID_^PageID_Choice) or mpbutton(LamellenID,1,PageID)==2) and m_^LamellenID_^PageID_Choice==1 then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice) 
} endif 
if (delay(change(GALamellen2),30000u64) or change(m_^LamellenID_^PageID_Choice) or mpbutton(LamellenID,2,PageID)==2) and m_^LamellenID_^PageID_Choice==2 then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice) 
} endif 
if (delay(change(GALamellen3),30000u64) or change(m_^LamellenID_^PageID_Choice) or mpbutton(LamellenID,2,PageID)==3) and m_^LamellenID_^PageID_Choice==3 then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice) 
} endif 
if (delay(change(GALamellen4),30000u64) or change(m_^LamellenID_^PageID_Choice) or mpbutton(LamellenID,2,PageID)==4) and m_^LamellenID_^PageID_Choice==4 then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice) 
} endif 
if (delay(change(GALamellen5),30000u64) or change(m_^LamellenID_^PageID_Choice) or mpbutton(LamellenID,2,PageID)==5) and m_^LamellenID_^PageID_Choice==5 then {
	pdisplay(LamellenID,m_^RolloID_^PageID_Text,m_^RolloID_^PageID_ICON,m_^RolloID_^PageID_State,m_^RolloID_^PageID_Deko,PageID,m_^LamellenID_^PageID_Choice) 
} endif 

if mpbutton(RolloID,1,PageID)==1 then {
	write(GAJalousie1,AUS)
} endif
if mpbutton(RolloID,1,PageID)==3 then {
	write(GAJalousie1,EIN)
} endif
if (mpbutton(RolloID,1,PageID)==2 and GAJalousie1==EIN) then {
	write(GALamellen1,EIN)
} endif
if (mpbutton(RolloID,1,PageID)==2 and GAJalousie1==AUS) then {
	write(GALamellen1,AUS)
} endif
if mpbutton(RolloID,2,PageID)==1 then {
	write(GAJalousie2,AUS)
} endif
if mpbutton(RolloID,2,PageID)==3 then {
	write(GAJalousie2,EIN)
} endif
if (mpbutton(RolloID,2,PageID)==2 and GAJalousie2==EIN) then {
	write(GALamellen2,EIN)
} endif
if (mpbutton(RolloID,2,PageID)==2 and GAJalousie2==AUS) then {
	write(GALamellen2,AUS)
} endif
if mpbutton(RolloID,3,PageID)==1 then {
	write(GAJalousie3,AUS)
} endif
if mpbutton(RolloID,3,PageID)==3 then {
	write(GAJalousie3,EIN)
} endif
if (mpbutton(RolloID,3,PageID)==2 and GAJalousie3==EIN) then {
	write(GALamellen3,EIN)
} endif
if (mpbutton(RolloID,3,PageID)==2 and GAJalousie3==AUS) then {
	write(GALamellen3,AUS)
} endif
if mpbutton(RolloID,4,PageID)==1 then {
	write(GAJalousie4,AUS)
} endif
if mpbutton(RolloID,4,PageID)==3 then {
	write(GAJalousie4,EIN)
} endif
if (mpbutton(RolloID,4,PageID)==2 and GAJalousie4==EIN) then {
	write(GALamellen4,EIN)
} endif
if (mpbutton(RolloID,4,PageID)==2 and GAJalousie4==AUS) then {
	write(GALamellen4,AUS)
} endif
if mpbutton(RolloID,5,PageID)==1 then {
	write(GAJalousie5,AUS)
} endif
if mpbutton(RolloID,5,PageID)==3 then {
	write(GAJalousie5,EIN)
} endif
if (mpbutton(RolloID,5,PageID)==2 and GAJalousie5==EIN) then {
	write(GALamellen5,EIN)
} endif
if (mpbutton(RolloID,5,PageID)==2 and GAJalousie5==AUS) then {
	write(GALamellen5,AUS)
} endif

if mpbutton(LamellenID,1,PageID)==1 then {
	write(GALamellen1,AUS)
} endif
if mpbutton(LamellenID,1,PageID)==3 then {
	write(GALamellen1,EIN)
} endif
if (mpbutton(LamellenID,1,PageID)==2 and GALamellen1==EIN) then {
	write(GALamellen1,EIN)
} endif
if (mpbutton(LamellenID,1,PageID)==2 and GALamellen1==AUS) then {
	write(GALamellen1,AUS)
} endif
if mpbutton(LamellenID,2,PageID)==1 then {
	write(GALamellen2,AUS)
} endif
if mpbutton(LamellenID,2,PageID)==3 then {
	write(GALamellen2,EIN)
} endif
if (mpbutton(LamellenID,2,PageID)==2 and GALamellen2==EIN) then {
	write(GALamellen2,EIN)
} endif
if (mpbutton(LamellenID,2,PageID)==2 and GALamellen2==AUS) then {
	write(GALamellen2,AUS)
} endif
if mpbutton(LamellenID,3,PageID)==1 then {
	write(GALamellen3,AUS)
} endif
if mpbutton(LamellenID,3,PageID)==3 then {
	write(GALamellen3,EIN)
} endif
if (mpbutton(LamellenID,3,PageID)==2 and GALamellen3==EIN) then {
	write(GALamellen3,EIN)
} endif
if (mpbutton(LamellenID,3,PageID)==2 and GALamellen3==AUS) then {
	write(GALamellen3,AUS)
} endif
if mpbutton(LamellenID,4,PageID)==1 then {
	write(GALamellen4,AUS)
} endif
if mpbutton(LamellenID,4,PageID)==3 then {
	write(GALamellen4,EIN)
} endif
if (mpbutton(LamellenID,4,PageID)==2 and GALamellen4==EIN) then {
	write(GALamellen4,EIN)
} endif
if (mpbutton(LamellenID,4,PageID)==2 and GALamellen4==AUS) then {
	write(GALamellen4,AUS)
} endif
if mpbutton(LamellenID,5,PageID)==1 then {
	write(GALamellen5,AUS)
} endif
if mpbutton(LamellenID,5,PageID)==3 then {
	write(GALamellen5,EIN)
} endif
if (mpbutton(LamellenID,5,PageID)==2 and GALamellen5==EIN) then {
	write(GALamellen5,EIN)
} endif
if (mpbutton(LamellenID,5,PageID)==2 and GALamellen5==AUS) then {
	write(GALamellen5,AUS)
} endif

:end
--------------------------------------------
// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin Statusanzeige(ID,PageID,StatusGA,Icon,TextAktiv,TextInaktiv)
:info $Das Makro liest den Status von einer binären Gruppenadresse und ändert den Status des dazugehörigen Elements(pbutton/pshifter)$\\
	:$Zahl zwischen 0 und 39 als ID des Elements$\\
	:$Zahl zwischen 0 und 99 als ID der Seite, auf der das Element definiert wurde$\\
	:$Gruppenadresse oder Variable, dessen Status angezeigt werden soll (b01)\\
	:$Icon$\\
	:$Text bei pos. Status$\\
	:$Text bei neg. Status$
:shortinfo $Statusanzeige für den WebServer$
m_^ID_^PageID_Text=$$
initGA(StatusGA)
if StatusGA then {
	pdisplay(ID,convert(TextAktiv,$$c14),Icon,ACTIVE,GREEN,PageID)
} else {
	pdisplay(ID,convert(TextInaktiv,$$c14),Icon,INACTIVE,GREY,PageID)
} endif
:end


// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin Fensterkontakte(ID,PageID,StatusGA)
:info $Das Makro liest den Status von einer binären Gruppenadresse und ändert den Status des dazugehörigen Elements(pbutton/pshifter)$\\
	:$Zahl zwischen 0 und 39 als ID des Elements$\\
	:$Zahl zwischen 0 und 99 als ID der Seite, auf der das Element definiert wurde$\\
	:$Gruppenadresse des Status (b01)$
:shortinfo $Statusanzeige von Fensterkontakten für den WebServer$
m_^ID_^PageID_Text=$$
initGA(StatusGA)
if StatusGA then {
	pdisplay(ID,$geschlossen$,WINDOW,INACTIVE,GREEN,PageID)
} else {
	pdisplay(ID,$offen$,WINDOW,STATE7,BLINKRED,PageID)
} endif
:end


// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin ZweiFensterkontakte(ID, PageID, StatusGA1, StatusGA2)
:info $Einen seitenbezogenen Multibutton (Elemente: mpbutton, mpshifter)  mit einer zweifachen Auswahlbox ansteuern. Die Gruppenadressen muessen Schaltelemente sein, d.h. \\
Datentyp b01.$\\
         :$Zahl zwischen 0 und 39 oder ID-Variable des Elements$\\
         :$Zahl zwischen 0 und 99 oder ID-Variable der Seite, auf der das Element definiert wurde.$\\
         :$Gruppenadresse des 1. Fensterkontaktes (b01)$\\
         :$Gruppenadresse des 2. Fensterkontaktes (b01)$
:shortinfo $Implementierung eines mpbutton oder mpshifter mit zwei GA$
//----------------------------------
// Implementierung von Name
m_^ID_^PageID_Text=$offen$
m_^ID_^PageID_ICON=WINDOW
m_^ID_^PageID_State=ACTIVE
m_^ID_^PageID_Deko=GREY
m_^ID_^PageID_Choice=1

initGA(StatusGA1)
initGA(StatusGA2)
if mpbutton(ID,1,PageID)==255 then {
	m_^ID_^PageID_Choice=1
} endif   
if mpbutton(ID,2,PageID)==255 then {
	m_^ID_^PageID_Choice=2
} endif   
if change(m_^ID_^PageID_ICON) or change(m_^ID_^PageID_State) or change(m_^ID_^PageID_Deko) or change(m_^ID_^PageID_Choice) then {
	pdisplay(ID,m_^ID_^PageID_Text,m_^ID_^PageID_ICON,m_^ID_^PageID_State,m_^ID_^PageID_Deko,PageID,m_^ID_^PageID_Choice) 
} endif 

if StatusGA1 and m_^ID_^PageID_Choice==1 then { 
	m_^ID_^PageID_Text=$geschlossen$;
	m_^ID_^PageID_Deko=GREEN;
	m_^ID_^PageID_State=INACTIVE
} endif 
if !StatusGA1 and m_^ID_^PageID_Choice==1 then { 
	m_^ID_^PageID_Text=$offen$;
	m_^ID_^PageID_Deko=GREY;
	m_^ID_^PageID_State=INACTIVE
} endif 
if StatusGA2 and m_^ID_^PageID_Choice==2 then { 
	m_^ID_^PageID_Text=$geschlossen$;
	m_^ID_^PageID_Deko=GREEN;
	m_^ID_^PageID_State=INACTIVE
} endif 
if !StatusGA2 and m_^ID_^PageID_Choice==2 then { 
	m_^ID_^PageID_Text=$offen$;
	m_^ID_^PageID_Deko=GREY;
	m_^ID_^PageID_State=INACTIVE
} endif 
//----------------------------------

:end



// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin DreiFensterkontakte(ID, PageID, StatusGA1, StatusGA2, StatusGA3)
:info $Einen seitenbezogenen Multibutton (Elemente: mpbutton, mpshifter)  mit einer zweifachen Auswahlbox ansteuern. Die Gruppenadressen muessen Schaltelemente sein, d.h. \\
Datentyp b01.$\\
         :$Zahl zwischen 0 und 39 oder ID-Variable des Elements$\\
         :$Zahl zwischen 0 und 99 oder ID-Variable der Seite, auf der das Element definiert wurde.$\\
         :$Gruppenadresse des 1. Fensterkontaktes (b01)$\\
         :$Gruppenadresse des 2. Fensterkontaktes (b01)$\\
         :$Gruppenadresse des 3. Fensterkontaktes (b01)$
:shortinfo $Implementierung eines mpbutton oder mpshifter mit zwei GA$
//----------------------------------
// Implementierung von Name
m_^ID_^PageID_Text=$offen$
m_^ID_^PageID_ICON=WINDOW
m_^ID_^PageID_State=ACTIVE
m_^ID_^PageID_Deko=GREY
m_^ID_^PageID_Choice=1

initGA(StatusGA1)
initGA(StatusGA2)
initGA(StatusGA3)

if mpbutton(ID,1,PageID)==255 then {
	m_^ID_^PageID_Choice=1
} endif   
if mpbutton(ID,2,PageID)==255 then {
	m_^ID_^PageID_Choice=2
} endif
if mpbutton(ID,3,PageID)==255 then {
	m_^ID_^PageID_Choice=3
} endif

if change(m_^ID_^PageID_ICON) or change(m_^ID_^PageID_State) or change(m_^ID_^PageID_Deko) or change(m_^ID_^PageID_Choice) then {
	pdisplay(ID,m_^ID_^PageID_Text,m_^ID_^PageID_ICON,m_^ID_^PageID_State,m_^ID_^PageID_Deko,PageID,m_^ID_^PageID_Choice) 
} endif 

if StatusGA1 and m_^ID_^PageID_Choice==1 then { 
	m_^ID_^PageID_Text=$geschlossen$;
	m_^ID_^PageID_Deko=GREEN;
	m_^ID_^PageID_State=INACTIVE
} endif 
if !StatusGA1 and m_^ID_^PageID_Choice==1 then { 
	m_^ID_^PageID_Text=$offen$;
	m_^ID_^PageID_Deko=GREY;
	m_^ID_^PageID_State=INACTIVE
} endif 
if StatusGA2 and m_^ID_^PageID_Choice==2 then { 
	m_^ID_^PageID_Text=$geschlossen$;
	m_^ID_^PageID_Deko=GREEN;
	m_^ID_^PageID_State=INACTIVE
} endif 
if !StatusGA2 and m_^ID_^PageID_Choice==2 then { 
	m_^ID_^PageID_Text=$offen$;
	m_^ID_^PageID_Deko=GREY;
	m_^ID_^PageID_State=INACTIVE
} endif
if StatusGA3 and m_^ID_^PageID_Choice==3 then {
	m_^ID_^PageID_Text=$geschlossen$;
	m_^ID_^PageID_Deko=GREEN;
	m_^ID_^PageID_State=INACTIVE
} endif 
if !StatusGA3 and m_^ID_^PageID_Choice==3 then {
	m_^ID_^PageID_Text=$offen$;
	m_^ID_^PageID_Deko=GREY;
	m_^ID_^PageID_State=INACTIVE
} endif
//----------------------------------

:end



// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin VierFensterkontakte(ID, PageID, StatusGA1, StatusGA2, StatusGA3,StatusGA4)
:info $Einen seitenbezogenen Multibutton (Elemente: mpbutton, mpshifter)  mit einer zweifachen Auswahlbox ansteuern. Die Gruppenadressen muessen Schaltelemente sein, d.h. \\
Datentyp b01.$\\
         :$Zahl zwischen 0 und 39 oder ID-Variable des Elements$\\
         :$Zahl zwischen 0 und 99 oder ID-Variable der Seite, auf der das Element definiert wurde.$\\
         :$Gruppenadresse des 1. Fensterkontaktes (b01)$\\
         :$Gruppenadresse des 2. Fensterkontaktes (b01)$\\
         :$Gruppenadresse des 3. Fensterkontaktes (b01)$\\
         :$Gruppenadresse des 4. Fensterkontaktes (b01)$
:shortinfo $Implementierung eines mpbutton oder mpshifter mit vier GA$
//----------------------------------
// Implementierung von Name
m_^ID_^PageID_Text=$offen$
m_^ID_^PageID_ICON=WINDOW
m_^ID_^PageID_State=ACTIVE
m_^ID_^PageID_Deko=GREY
m_^ID_^PageID_Choice=1

initGA(StatusGA1)
initGA(StatusGA2)
initGA(StatusGA3)
initGA(StatusGA4)

if mpbutton(ID,1,PageID)==255 then {
	m_^ID_^PageID_Choice=1
} endif   
if mpbutton(ID,2,PageID)==255 then {
	m_^ID_^PageID_Choice=2
} endif
if mpbutton(ID,3,PageID)==255 then {
	m_^ID_^PageID_Choice=3
} endif
if mpbutton(ID,4,PageID)==255 then {
	m_^ID_^PageID_Choice=4
} endif

if change(m_^ID_^PageID_ICON) or change(m_^ID_^PageID_State) or change(m_^ID_^PageID_Deko) or change(m_^ID_^PageID_Choice) then {
	pdisplay(ID,m_^ID_^PageID_Text,m_^ID_^PageID_ICON,m_^ID_^PageID_State,m_^ID_^PageID_Deko,PageID,m_^ID_^PageID_Choice) 
} endif 

if StatusGA1 and m_^ID_^PageID_Choice==1 then { 
	m_^ID_^PageID_Text=$geschlossen$;
	m_^ID_^PageID_Deko=GREEN;
	m_^ID_^PageID_State=INACTIVE
} endif 
if !StatusGA1 and m_^ID_^PageID_Choice==1 then { 
	m_^ID_^PageID_Text=$offen$;
	m_^ID_^PageID_Deko=GREY;
	m_^ID_^PageID_State=INACTIVE
} endif 
if StatusGA2 and m_^ID_^PageID_Choice==2 then { 
	m_^ID_^PageID_Text=$geschlossen$;
	m_^ID_^PageID_Deko=GREEN;
	m_^ID_^PageID_State=INACTIVE
} endif 
if !StatusGA2 and m_^ID_^PageID_Choice==2 then { 
	m_^ID_^PageID_Text=$offen$;
	m_^ID_^PageID_Deko=GREY;
	m_^ID_^PageID_State=INACTIVE
} endif
if StatusGA3 and m_^ID_^PageID_Choice==3 then {
	m_^ID_^PageID_Text=$geschlossen$;
	m_^ID_^PageID_Deko=GREEN;
	m_^ID_^PageID_State=INACTIVE
} endif 
if !StatusGA3 and m_^ID_^PageID_Choice==3 then {
	m_^ID_^PageID_Text=$offen$;
	m_^ID_^PageID_Deko=GREY;
	m_^ID_^PageID_State=INACTIVE
} endif
if StatusGA4 and m_^ID_^PageID_Choice==4 then {
	m_^ID_^PageID_Text=$geschlossen$;
	m_^ID_^PageID_Deko=GREEN;
	m_^ID_^PageID_State=INACTIVE
} endif 
if !StatusGA4 and m_^ID_^PageID_Choice==4 then {
	m_^ID_^PageID_Text=$offen$;
	m_^ID_^PageID_Deko=GREY;
	m_^ID_^PageID_State=INACTIVE
} endif

:end


// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin GetInfoButton(ID, PageID, GA, ICON,Text, Value)
:info $Eine seitenbezogener Button. Bei Knopfdruck wird der Wert von Value angezeigt.$\\
         :$ID des Elements$\\
         :$SeitenID$\\
         :$Gruppenadresse des EIN/AUS Schaltelements (b01)$\\
	 :$ICON$\\
	 :$Statischer Text für die 1. Zeile$\\
	 :$Variable oder Gruppenadresse, die bei Knopfdruck angezeigt werden soll$
:shortinfo $Eine seitenbezogener Button. Bei Knopfdruck wird der Wert von Value angezeigt.$

if pbutton(ID,PageID)==1 then {
   GA=EIN
} endif

if after(GA,100u64) then {
 	pdisplay(ID,convert(Text,$$c14)+$:$c14+convert(Value,$$c14),ICON,INACTIVE,GREEN,PageID);
	GA=AUS
} endif
:end


// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin Uhrzeitanzeige(ID,GAClock)
:info $Eine Uhranzeige fuer den WebServer mit einem button$\\
	:$Zahl zwischen 0 und 39 als ID des Elements$\\
	:$Gruppenadresse der Uhrzeit(Datentyp: t24)$
:shortinfo $Uhranzeige fuer den WebServer$

if after(systemstart(),1000u64) then webdisplay(ID,settime(),CLOCK,INACTIVE,GREEN) endif
if stime(0) then webdisplay(ID,settime(),CLOCK,INACTIVE,GREEN) endif
:end


// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin Datumsanzeige(ID,GADate)
:info $Eine Datumsanzeige fuer den WebServer mit einem button$\\
	:$Zahl zwischen 0 und 39 als ID des Elements$\\
	:$Gruppenadresse des Datums(Datentyp: d24)$
:shortinfo $Datumsanzeige fuer den WebServer$

if after(systemstart(),1000u64) then webdisplay(ID,setdate(),DATE,INACTIVE,GREEN) endif
if change(setdate()) then webdisplay(ID,setdate(),DATE,INACTIVE,GREEN) endif
:end



// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin HeizungPChart(ID,PageID,GA,WebZeit)
:info $Ein seitenbezogener Chart fuer die Anzeige von Heizungsdaten. Alle 15 Minuten wird ein neuer Wert gesetzt. Skalierung optimiert für Heizungswerte.$\\
	:$Zahl zwischen 0 und 39 als ID des Elements$\\
	:$Zahl zwischen 0 und 99 als ID der Seite, auf der das Element definiert wurde.$\\
	:$Gruppenadresse mit aktuellen Messdaten. (u08)$\\
	:$Skalierte Zeit für das Chart$
:shortinfo $XY-Diagramm fuer den WebServer, Skalierung optimiert für Heizungswerte.$

initGA(GA)
if (mtime(00,00) or mtime(15,00) or mtime(30,00) or mtime(45,00)) then {
	mpchart(ID,WebZeit,convert(GA,0f16)/2.549f16,0,PageID)
} endif
:end

// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin TemperaturPChart(ID,PageID,GA,WebZeit)
:info $Ein seitenbezogener Chart fuer die Anzeige von bestimmten Daten. Alle 15 Minuten wird ein neuer Wert gesetzt.$\\
	:$Zahl zwischen 0 und 39 als ID des Elements$\\
	:$Zahl zwischen 0 und 99 als ID der Seite, auf der das Element definiert wurde.$\\
	:$Gruppenadresse mit aktuellen Messdaten. (f16)$\\
	:$Skalierte Zeit für das Chart$
:shortinfo $XY-Diagramm fuer den WebServer$

initGA(GA)
if (mtime(00,00) or mtime(15,00) or mtime(30,00) or mtime(45,00)) then {
	mpchart(ID,WebZeit,convert(GA,0f16),0,PageID)
} endif
:end

// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin TemperaturPChart2Graphen(ID,PageID,GA,GA2,WebZeit)
:info $Ein seitenbezogener Chart fuer die Anzeige von bestimmten Daten. Alle 15 Minuten wirden zwei neue Werte gesetzt.$\\
	:$Zahl zwischen 0 und 39 als ID des Elements$\\
	:$Zahl zwischen 0 und 99 als ID der Seite, auf der das Element definiert wurde.$\\
	:$Gruppenadresse mit aktuellen Messdaten. (f16)$\\
	:$2. Gruppenadresse mit aktuellen Messdaten. (f16)$\\
	:$Skalierte Zeit für das Chart$
:shortinfo $XY-Diagramm fuer den WebServer$

initGA(GA)
if (mtime(00,00) or mtime(15,00) or mtime(30,00) or mtime(45,00)) then {
	mpchart(ID,WebZeit,convert(GA,0f16),0,PageID);
	mpchart(ID,WebZeit,convert(GA2,0f16),1,PageID)
} endif
:end


// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin SonnenAufUntergangRegenmeldungAnzeigeButton(ID, GARegenmeldung)
:info $Eine Statusanzeige für Sonnenauf-, Sonnenuntergang und Regenmeldung.$\\
	:$Zahl zwischen 0 und 39 als ID des Elements$\\
	:$Gruppenadresse der Wetterstation für Regenmeldung (b01)$
:shortinfo $Statusanzeige für Sonnenauf-, Sonnenuntergang und Regenmeldung.$

initGA(GARegenmeldung)
Regen_^ID=GARegenmeldung
RegenText_^ID=$$

if Regen_^ID then RegenText_^ID= $ - Es regnet$ else RegenText_^ID=$ - Es regnet nicht$ endif 

Sonnenaufgang_^ID=stringformat(sunrisehour(),0,3,2,2)+$:$+stringformat(sunriseminute(),0,3,2,2)
Sonnenuntergang_^ID=stringformat(sunsethour(),0,3,2,2)+$:$+stringformat(sunsetminute(),0,3,2,2)

if change(Sonnenaufgang_^ID) or change(RegenText_^ID) then{
	 display(ID,Sonnenaufgang_^ID+$ - $+Sonnenuntergang_^ID +RegenText_^ID,INFO,DISPLAY,GREY)
} endif
:end


// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin MinMaxTemperaturAnzeigeButton(ID, GAAussentemperatur)
:info $Eine Statusanzeige für Tagesmin- und  Tagesmax-temperatur.$\\
	:$Zahl zwischen 0 und 39 als ID des Elements$\\
	:$Gruppenadresse der Aussentemperatur (f16)$
:shortinfo $Statusanzeige für Tagesmin- und  Tagesmax-temperatur$

initGA(GAAussentemperatur)
AussenTemperatur_^ID=GAAussentemperatur

// Maximale und Minimale Temperatur eines Tages berechnen
MaxTemp_^ID=-99.0
MinTemp_^ID=99.0
if htime(00,00,00) then { 
   MaxTemp_^ID=AussenTemperatur_^ID;
   MinTemp_^ID=AussenTemperatur_^ID
} endif

if MaxTemp_^ID<AussenTemperatur_^ID then MaxTemp_^ID=AussenTemperatur_^ID endif
if MinTemp_^ID>AussenTemperatur_^ID then MinTemp_^ID=AussenTemperatur_^ID endif

if change(MinTemp_^ID) or change(MaxTemp_^ID) then {
	display(ID,convert(MinTemp_^ID,$$) +$ : $+ convert(MaxTemp_^ID,$$),TEMPERATURE,DISPLAY,GREY) 
}endif 

:end


// Online 
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin OnlineAnzeigeButton(ID)
:info $Berechnet die Zeit seit letztem Start des Awendungsprogramms.Die Anzeige wird auf einen Button ausgegeben.$ \\
	:$Zahl zwischen 0 und 39 als ID des Elements$
:shortinfo $Buttonanzeige wie lange der EibPC online ist$
TageOnline=0u16
StundenOnline=0
MinutenOnline=0
if mtime(59,00) then 							\\
	if StundenOnline<23 then 						\\
  		StundenOnline=StundenOnline+1 					\\
	     else                          						\\
		StundenOnline=0;			                \\
		TageOnline=TageOnline+1u16 					\\
	 endif 						\\
     endif 

if stime(59) then 							\\
	 if MinutenOnline<59 then        						\\
		MinutenOnline=MinutenOnline+1 					\\
	     else 				      		\\
		MinutenOnline=0 			    	        \\
	     endif						\\
	endif 
// Minuten
AnzeigeM0=$00$c14
if MinutenOnline<10 and change(MinutenOnline) then AnzeigeM0=$0$c14+convert(MinutenOnline,$xx$c14) endif
if MinutenOnline>9 and change(MinutenOnline) then AnzeigeM0=convert(MinutenOnline,$xx$c14) endif 
// Stunden
AnzeigeS0=$00$c14
if StundenOnline<10 and change(StundenOnline) then AnzeigeS0=$0$c14+convert(StundenOnline,$xx$c14) endif
if StundenOnline>9 and change(StundenOnline) then AnzeigeS0=convert(StundenOnline,$xx$c14) endif 
// Tage
AnzeigeT0=$000$c14
if TageOnline<10u16 and change(TageOnline) then AnzeigeT0=$00$c14+convert(TageOnline,$xx$c14) endif
if TageOnline>9u16 and TageOnline<100u16 and change(TageOnline) then AnzeigeT0=$0$c14+convert(TageOnline,$xx$c14) endif 
if TageOnline>99u16 and change(TageOnline) then AnzeigeT0=convert(TageOnline,$xx$c14) endif 
// Ausgabe Ein String im Format dd.hh:mm
AnzeigeOnline=AnzeigeT0+$.$c14+AnzeigeS0+$:$c14+AnzeigeM0

if change(AnzeigeOnline) then display(ID,$EibPC online: $ +convert(AnzeigeOnline,$$),INFO,DISPLAY,GREY) endif

:end 


// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin WindAnzeigeButton(ID, GAStatus)
:info $Eine Statusanzeige für die aktuelle Windgeschwindigkeit.$\\
	:$Zahl zwischen 0 und 39 als ID des Elements$\\
	:$Gruppenadresse Wind (f16)$
:shortinfo $Statusanzeige für die aktuelle Windgeschwindigkeit.$

initGA(GAStatus)
Wind_^ID=GAStatus
if change(Wind_^ID) then display(ID,GAStatus*3.6,WIND,DISPLAY,GREY) endif

:end

// Webelement
// @date	20.07.2016
// @version	2 
// @author	Enertex Bayern GmbH
:begin LichtAnzeigeButton(ID, GAStatus)
:info $Eine Statusanzeige für die aktuelle Helligkeit.$ \\
	:$Zahl zwischen 0 und 39 als ID des Elements$\\
	:$Gruppenadresse Licht (f16)$
:shortinfo $Statusanzeige für die aktuelle Helligkeit.$

initGA(GAStatus)
Licht_^ID=GAStatus
if change(Licht_^ID) then display(ID,Licht_^ID,WEATHER,DISPLAY,GREY) endif

:end


// Webelement für einen Raumkontroller, der mit einer u08 Raumkontroller-Variable verknüpft ist
// @date	01.10.2013
// @version	2
// @author	Enertex Bayern GmbH (J.S.)
:begin RaumcontrollerVar(ID, PageID, GaAktor, RkVar)
:info $Einen Raumcontroller im Webinterface mit einem pshifter simulieren. Das Webinterface ist mit mit einer 8-Bit Raumkontroller-Variable RkVar (u08) verknüpft (Umschaltung in Standby,\\
Komfort, Nachtmodus).Über die Gruppenadresse des Heizaktors GA wird ermittelt, ob tatsächlich geheizt wird. Der pshifter sollte folgende Form haben(§ mit Dollarzeichen ersetzen): pshifter(RkID)[ABSENT,PRESENT,NIGHT,ABSENT]§Raumkontroller§						siehe auch Beispiel Raumcontroller.epc $\\
         :$ID des pshifters$\\
         :$SeitenID des pshifters$\\
         :$Gruppenadresse des Heizaktors(Prozenttyp (u08))$\\
	 :$Name der Variablen, die den Zustand des simulierten Raumkontrollers wiedergibt$
:shortinfo $Raumcontroller Webelement, das mit einer 8-Bit Raumcontrollervariablen verknüpft ist. Im Visu-Assistenten verwendet.$
Rk_^ID_^PageID=RkVar
RkSymbol_^ID_^PageID=ABSENT
if pbutton(ID,PageID)==1 then Rk_^ID_^PageID=STANDBY endif
if pbutton(ID,PageID)==2 then Rk_^ID_^PageID=KOMFORT endif
if pbutton(ID,PageID)==3 then Rk_^ID_^PageID=NIGHTMODE endif

if change(Rk_^ID_^PageID) then {
	RkVar=Rk_^ID_^PageID;
	if Rk_^ID_^PageID==KOMFORT then RkSymbol_^ID_^PageID=PRESENT endif;
	if Rk_^ID_^PageID==STANDBY then RkSymbol_^ID_^PageID=ABSENT endif;
	if Rk_^ID_^PageID==NIGHTMODE then RkSymbol_^ID_^PageID=NIGHT endif
} endif 

if (change(RkSymbol_^ID_^PageID) or change(GaAktor)) and GaAktor>0 then {
 	pdisplay(ID,$Es wird geheizt$,RkSymbol_^ID_^PageID,BRIGHTRED,BLINKBLUE,PageID)
} endif 
if (change(RkSymbol_^ID_^PageID) or change(GaAktor)) and GaAktor==0 then {
	pdisplay(ID,$AUS$,RkSymbol_^ID_^PageID,ACTIVE,GREY,PageID)
} endif
:end

// Webelement
// @date	16.01.2014
// @version	2 
// @author	Enertex Bayern GmbH (J.S.)
:begin UmschaltButtonZweiIconsVar(ID, PageID, Var, ICONAktiv,ICONInAktiv,StateAktiv,StateInAktiv)
:info $Einen seitenbezogenen Button mit (Elemente: pbutton, pshifter) einer Schaltmöglichkeit ansteuern. Beim Knopfdruck wird umgeschaltet und das Icon von ICONAktiv zu\\
ICONInAktiv umgeschaltet. Datentyp der Variable b01. Die Schaltzeit der letzten Betätigung wird mit aufgezeichnet. Die Anzeige ist für einen Sperr-Button optimiert, \\
wobei der ICON-Zustand für EIN und AUS angegeben werden kann$\\
         :$ID des Elements$\\
         :$SeitenID$\\
         :$Variable des EIN/AUS Schaltelements (b01)$\\
         :$ICON für den EIN-Zustand$\\
         :$ICON für den AUS-Zustand$\\
         :$EIN-Zustand (State) des ICONs$\\
         :$AUS-Zustand (State) des ICONs$
:shortinfo $Implementierung eines Umschalters mit Angabe von 2 Icons$

if systemstart() then pdisplay(ID,CLOCK_STRING,ICONAktiv,StateAktiv,GREEN,PageID);Var=EIN; endif
if pbutton(ID,PageID)==1 then {
   Var=!Var
} endif   
if Var==EIN then {pdisplay(ID,CLOCK_STRING,ICONAktiv,StateAktiv,GREEN,PageID)} endif
if Var==AUS then {pdisplay(ID,CLOCK_STRING,ICONInAktiv,StateInAktiv,GREEN,PageID)} endif
:end



// Schreibt den Mittelwert einer Variable zyklisch in den Timebuffer uTimeBufferID und legt den Timebuffer uTimeBufferID an.
// @date	16.01.2014
// @version	2 
// @author	Enertex Bayern GmbH (J.S.)
:begin ZyklischMittelwertInTimeBufferSchreiben(uTimeBufferID,fVariable,uCylceInMinuts,uRecordLengthInDays,bStartTrigger,bTimeBufferStore,bTimeBufferLoad,uStoreInFlashAfterHours)
:info $Legt einen Timbuffer an und schreibt eine Variable zyklisch nach der Zeit uCylceInMinuts in den Timebuffer. Falls der Wert innerhalb eines \\
Zyklusses nicht konstant war, dann wird der Mittelwert über den Zyklus in den Timebuffer geschrieben$\\
	$ID des Timebuffers (u08)$\\
	$Variable vom Typ u08, u16, f16, f32. Diese wird zyklisch in den Timebuffer geschrieben (vXX)$\\
	$Zeitabstand der Datenaufzeichnung (in Minuten) (u64)$\\
	$Aufzeichnungsdauer in Tagen (u16)$\\
	$Startzeitpunkt der Datenaufzeichnung. Beim ersten Wechsel des Wertes von 0 auf 1 wird die Aufzeichnung gestartet. Z.B. um 0 Uhr: htime(0,0,0) (b01)$\\
	$Variable, die bei jedem Wechsel ihres Wertes den Timebuffer mit uTimeBufferID zur Datensicherung im Flash speichert. (b01)$\\
	$Variable, die beim Wechsel von 0 auf 1 den Timebuffer aus dem Flash lädt. (b01)$\\
	$Nach dieser Zeit in Stunden werden die Werte aus dem Timebuffer im zur Datensicherung Flash gespeichert.(u16)$
:shortinfo $Schreibt den Mittelwert einer Variable zyklisch in den Timebuffer uTimeBufferID. Im Visu-Assistenten verwendet. Min. EibPC FW V3.000 erforderlich$
:var bStart@
:var uRemainder@
:var uVariableCounter@
:var fTempAkku@
:var uBuffersize@
uVariableCounter@=0u32;
fTempAkku@=0f32;
uRemainder@=0u64;
bStart@=AUS;

if (convert((convert(uRecordLengthInDays,0u64)*24u64*60u64)/convert(uCylceInMinuts,0u64),0u16) <= 65535u16) then {
	timebufferconfig(uTimeBufferID, 0, convert((convert(uRecordLengthInDays,0u64)*24u64*60u64)/convert(uCylceInMinuts,0u64),0u16), fVariable);
} else {
	timebufferconfig(uTimeBufferID, 0, 65535u16, fVariable);
} endif;

// Timer zum bestimmten Triggerzeitpunkt starten
if  bStartTrigger && !bStart@ then bStart@=EIN endif;
if afterc(bStart@,1000000000000000u64,uRemainder@) then bStart@=EIN; endif

  // Summierer (Integrierer) der Variablen fVariable
if change(fVariable) then {
	uVariableCounter@=uVariableCounter@+1u32;
	fTempAkku@=fTempAkku@+convert(fVariable,0f32);
} endif;

// Zyklisches Schreiben der Variable in den Timebuffer
if (mod((1000000000000000u64-uRemainder@)/1000u64,(uCylceInMinuts*60u64))==0u64) && ((1000000000000000u64-uRemainder@)>4000u64) && bStart@ && (uRemainder@>0u64) then {
	if uVariableCounter@==0u32 then {
		timebufferadd(uTimeBufferID,fVariable);
	} endif;
	if uVariableCounter@!=0u32 then {
	       timebufferadd(uTimeBufferID,convert(fTempAkku@/convert(uVariableCounter@,0f32),fVariable));
	} endif;
	uVariableCounter@=0u32;
	fTempAkku@=0f32;
} endif;

// Zyklisches Speichern des Timebuffers zur Datensicherung im Flash (Remanentspeicher)
if (mod((1000000000000000u64-uRemainder@)/3600000u64,convert(uStoreInFlashAfterHours,0u64))==0u64) && ((1000000000000000u64-uRemainder@)>4000u64) && bStart@ && (uRemainder@>0u64) then {
	timebufferstore(uTimeBufferID);
} endif;

// Speichern des Timebuffers, wenn sich die Variable bTimeBufferStore ändert
if change(bTimeBufferStore) then timebufferstore(uTimeBufferID); endif;
// Laden des Timebuffers, wenn sich die Variable bTimeBufferStore von 0 auf 1 ändert
if bTimeBufferLoad then timebufferread(uTimeBufferID); endif;
:end 




// Nutzt ein Weboutputfeld als formatiertes Loggerfenster
// @date	18.07.2014
// @version	2 
// @author	Enertex Bayern GmbH (msc)
:begin WebLogger(ID,Text)
:info $Schreibt formatiert auf ein Weboutputfeld (QUAD-Größe) und gibt einen Textstring (40 Zeichen) dort aus$\\
	$ID des weboutput-Elements (u08)$\\
	$Textvariable$
:shortinfo $Weboutputfeld als formatiertes Loggerfenster$

:var TextLogger_out@
:var TextLogger_Count@
:var TextLogger_line@
:var TextLogger_Header@
:var TextLogger_Body@
 
TextLogger_out@    =$$
TextLogger_Count@  =0
// Maximum: 40 Characters each Log entry
TextLogger_line@   =$$c40
TextLogger_Header@ =$<body><table border="1" width="320" rules="groups">   <thead><tr><th><font color=teal>Datum </font></th> <th  width="74%">Event </th> </tr></thead><tbody>$c200
TextLogger_Body@   =$$

if change(Text) then {
   TextLogger_line@=Text;
   if TextLogger_Count@>12 then {
     TextLogger_Body@=split(TextLogger_Body@,find(TextLogger_Body@,$</td>$,1u16)+5u16,END)+$<tr><td><font color=teal>$+convert(settime(),$$c20)+$</font></td><td>$+TextLogger_line@+$</td>$;
   } else {
     TextLogger_Body@=TextLogger_Body@+$<tr><td><font color=teal>$+convert(settime(),$$c20)+$</font></td><td>$+TextLogger_line@+$</td></tr>$;
     TextLogger_Count@=TextLogger_Count@+1;  
   } endif;
   TextLogger_out@=TextLogger_Header@ +TextLogger_Body@+$</tbody></table></body>$;
   weboutput(ID, TextLogger_out@);
} endif
:end



// Webelement
// @date	06.11.2014
// @version	2 
// @author	Enertex Bayern GmbH, Stefanie Meier
:begin CallSceneButton(ID, PageID,GA, ScenenBaustein,ScenenNummerAktiv, ScenenNummerAUS, ICON)
:info $Einen seitenbezogenen Button mit (Elemente: pbutton, pshifter) einer Schaltmöglichkeit ansteuern. Beim Knopfdruck wird umgeschaltet und eine Scene aufgerufen. \\
Datentyp der Gruppenaddresse b01. Die Schaltzeit der letzten Betätigung wird mit aufgezeichnet.$\\
         :$ID des Elements$\\
         :$SeitenID$\\
         :$Gruppenadresse des EIN/AUS Schaltelements (b01)$\\
         :$ScenenBaustein$\\
	 :$ScenenNummer welche bei einem EIN-Signal aufgerufen werden soll$\\
	 :$ScenenNummer welche bei einem AUS-Signal aufgerufen werden soll$\\
	 :$Icon$
:shortinfo $Aufrufen von zwei Scene durch einen Um-Schalter("Toggle")$
initga(GA)
if pbutton(ID,PageID)==1 then {
	write(GA,!GA)
} endif
   
if GA then {
	callscene(ScenenBaustein,ScenenNummerAktiv)
} else {
        callscene(ScenenBaustein,ScenenNummerAUS)
} endif

if GA then {
 	pdisplay(ID,CLOCK_STRING,ICON,ACTIVE,GREEN,PageID) 
} else {
 	pdisplay(ID,CLOCK_STRING,ICON,INACTIVE,GREY,PageID) 
} endif
:end



// Webelement
// @date	7.05.2014
// @version	2 
// @author	Enertex Bayern GmbH (S.M.)
:begin MtimeChart2Graphen(BufferA, Value1, BufferB, Value2, MemTyp, Len, Datatyp)
:info $Konfiguration eines mtimechart für zwei Graphen. Der Buffer wird alle 15Minuten beschrieben.$\\
         :$Buffer 1$\\
         :$Variable oder Gruppenadresse$\\
         :$Buffer 2$\\
         :$Variable oder Gruppenadresse$\\
	 :$MemTyp$\\
	 :$Len$\\
	 :$Datatyp$
:shortinfo $Bufferkonfiguration für einen mtimechart mit zwei Graphen$

timebufferconfig(BufferA, MemTyp, Len, Datatyp)
timebufferconfig(BufferB, MemTyp, Len, Datatyp)
//if mtime(0,0) or mtime(15,0) or mtime(30,0) or mtime(45,0) then {
if change(Value1) or change(Value2) or mtime(0,0) or mtime(15,0) or mtime(30,0) or mtime(45,0) then {
	timebufferadd(BufferA,Value1);
	timebufferadd(BufferB,Value2);
} endif
:end

// Webelement
// @date	7.05.2014
// @version	2 
// @author	Enertex Bayern GmbH (S.M.)
:begin MtimeChart3Graphen(BufferA, Value1, BufferB, Value2, BufferC, Value3, MemTyp, Len, Datatyp)
:info $Konfiguration eines mtimechart für drei Graphen. Der Buffer wird alle 15Minuten beschrieben.$\\
         :$Buffer 1$\\
         :$Variable oder Gruppenadresse$\\
         :$Buffer 2$\\
         :$Variable oder Gruppenadresse$\\
         :$Buffer 3$\\
         :$Variable oder Gruppenadresse$\\
	 :$MemTyp$\\
	 :$Len$\\
	 :$Datatyp$
:shortinfo $Bufferkonfiguration für einen mtimechart mit drei Graphen$

timebufferconfig(BufferA, MemTyp, Len, Datatyp)
timebufferconfig(BufferB, MemTyp, Len, Datatyp)
timebufferconfig(BufferC, MemTyp, Len, Datatyp)

//if mtime(0,0) or mtime(15,0) or mtime(30,0) or mtime(45,0) then {
if change(Value1) or change(Value2) or change(Value3) or mtime(0,2) or mtime(15,2) or mtime(30,2) or mtime(45,2) then {
	timebufferadd(BufferA,Value1);
	timebufferadd(BufferB,Value2);
	timebufferadd(BufferC,Value3)
} endif
:end

// Webelement
// @date	7.05.2014
// @version	2 
// @author	Enertex Bayern GmbH (S.M.)
:begin MtimeChart4Graphen(BufferA, Value1, BufferB, Value2, BufferC, Value3, BufferD, Value4, MemTyp, Len, Datatyp)
:info $Konfiguration eines mtimechart für drei Graphen. Der Buffer wird alle 15Minuten beschrieben.$\\
         :$Buffer A$\\
         :$Variable oder Gruppenadresse$\\
         :$Buffer B$\\
         :$Variable oder Gruppenadresse$\\
         :$Buffer C$\\
         :$Variable oder Gruppenadresse$\\
         :$Buffer D$\\
         :$Variable oder Gruppenadresse$\\
	 :$MemTyp$\\
	 :$Len$\\
	 :$Datatyp$
:shortinfo $Bufferkonfiguration für einen mtimechart mit vier Graphen$

timebufferconfig(BufferA, MemTyp, Len, Datatyp)
timebufferconfig(BufferB, MemTyp, Len, Datatyp)
timebufferconfig(BufferC, MemTyp, Len, Datatyp)
timebufferconfig(BufferD, MemTyp, Len, Datatyp)

//if mtime(0,0) or mtime(15,0) or mtime(30,0) or mtime(45,0) then {
if change(Value1) or change(Value2) or change(Value3) or change(Value4) or mtime(0,4) or mtime(15,4) or mtime(30,4) or mtime(45,4) then {
	timebufferadd(BufferA,Value1);
	timebufferadd(BufferB,Value2);
	timebufferadd(BufferC,Value3);
	timebufferadd(BufferD,Value4)
} endif
:end

// Webelement
// @date	7.05.2014
// @version	2 
// @author	Enertex Bayern GmbH (S.M.)
:begin MtimeChart4Graphen4Datatyp(BufferA, Value1, Datatyp1, BufferB, Value2, Datatyp2, BufferC, Value3, Datatyp3, BufferD, Value4, Datatyp4, MemTyp, Len)
:info $Konfiguration eines mtimechart für drei Graphen. Der Buffer wird alle 15Minuten beschrieben. Die Datentypen der Graphen können einzelen angegeben werden und somit unterscheidliche sein.$\\
         :$Buffer A$\\
         :$Variable oder Gruppenadresse$\\
         :$Datatyp für Buffer A$\\
         :$Buffer B$\\
         :$Variable oder Gruppenadresse$\\
         :$Datatyp für Buffer B$\\
         :$Buffer C$\\
         :$Variable oder Gruppenadresse$\\
         :$Datatyp für Buffer C$\\
         :$Buffer D$\\
         :$Variable oder Gruppenadresse$\\
         :$Datatyp für Buffer D$\\
 	 :$MemTyp$\\
	 :$Len$\\
	 :$Datatyp$
:shortinfo $Bufferkonfiguration für einen mtimechart mit vier Graphen$

timebufferconfig(BufferA, MemTyp, Len, Datatyp1)
timebufferconfig(BufferB, MemTyp, Len, Datatyp2)
timebufferconfig(BufferC, MemTyp, Len, Datatyp3)
timebufferconfig(BufferD, MemTyp, Len, Datatyp4)

//if mtime(0,0) or mtime(15,0) or mtime(30,0) or mtime(45,0) then {
if change(Value1) or change(Value2) or change(Value3) or change(Value4) or mtime(0,4) or mtime(15,4) or mtime(30,4) or mtime(45,4) then {
	timebufferadd(BufferA,Value1);
	timebufferadd(BufferB,Value2);
	timebufferadd(BufferC,Value3);
	timebufferadd(BufferD,Value4)
} endif
:end

// Webelement
// @date	7.05.2014
// @version	2 
// @author	Enertex Bayern GmbH (S.M.)
:begin StoreAndRead4Buffer(BufferA, BufferB, BufferC, BufferD, MM,SS)
:info $Daten für vier Buffer ins Falsh speichern und bei Systemstart wieder laden$\\
         :$Buffer 1$\\
         :$Buffer 2$\\
         :$Buffer 3$\\
         :$Buffer 4$\\
         :$mm für cycle$\\
         :$ss für cycle$
:shortinfo $Daten für vier Buffer ins Falsh speichern und bei Systemstart wieder laden$
// Daten Graphen1 ins Flash speicher und bei Systemstart wieder laden
if cycle(MM,SS) then {
	timebufferstore(BufferA);
	timebufferstore(BufferB);
	timebufferstore(BufferC);
	timebufferstore(BufferD)
} endif
if after(systemstart(),30000u64) then {
	timebufferread(BufferA);
	timebufferread(BufferB);
	timebufferread(BufferC);
	timebufferread(BufferD)
} endif
:end

// Webelement
// @date	7.05.2014
// @version	2 
// @author	Enertex Bayern GmbH (S.M.)
:begin StoreAndRead3Buffer(BufferA, BufferB, BufferC, MM,SS)
:info $Daten für drei Buffer ins Falsh speichern und bei Systemstart wieder laden$\\
         :$Buffer 1$\\
         :$Buffer 2$\\
         :$Buffer 3$\\
         :$mm für cycle$\\
         :$ss für cycle$
:shortinfo $Daten für drei Buffer ins Falsh speichern und bei Systemstart wieder laden$
// Daten Graphen1 ins Flash speicher und bei Systemstart wieder laden
if cycle(MM,SS) then {
	timebufferstore(BufferA);
	timebufferstore(BufferB);
	timebufferstore(BufferC)
} endif
if after(systemstart(),30000u64) then {
	timebufferread(BufferA);
	timebufferread(BufferB);
	timebufferread(BufferC)
} endif
:end

// Webelement
// @date	7.05.2014
// @version	2 
// @author	Enertex Bayern GmbH (S.M.)
:begin StoreAndRead2Buffer(BufferA, BufferB, MM,SS)
:info $Daten für zwei Buffer ins Falsh speichern und bei Systemstart wieder laden$\\
         :$Buffer 1$\\
         :$Buffer 2$\\
         :$mm für cycle$\\
         :$ss für cycle$
:shortinfo $Daten für zwei Buffer ins Falsh speichern und bei Systemstart wieder laden$
// Daten Graphen1 ins Flash speicher und bei Systemstart wieder laden
if cycle(MM,SS) then {
	timebufferstore(BufferA);
	timebufferstore(BufferB);
} endif
if after(systemstart(),30000u64) then {
	timebufferread(BufferA);
	timebufferread(BufferB);
} endif
:end

// @date	09.01.2015
// @version	2
// @author	Enertex Bayern GmbH, J. Schuhmann

:begin Zeitschaltuhr4Schaltuhren(PageName,PageID,GA,uFlashAdress)
:info $Mit diesem Makro generiert der Visualisierungsassistent eine Webseite, mit der 4 Schaltzeituhren für eine binäre GA definiert werden können.\\
	:$Name der Webseite - muss eindeutig im Programm sein$\\
	:$Beliebige ganze Zahl für die eindeutige Kennzeichnung der Webseite im Visuassi$\\
	:$Gruppenadresse des Aktors der mit der Zeitschaltuhr geschalten wird (b01)$\\
	:$Adresse für den Remanentspeicherplatz (Flash) in der die eingestellten Schalthandlungen abgespeichert werden. Der Visualisierungsassistent verwendet als Addressraum nur Addressen von 900 bis 999 (b01)$

:shortinfo $Generierung einer Schaltzeituhrwebseite im Visualisierungsassistent(veraltet). Im Visu-Assistenten verwendet.$

// Zustandsvariable für die Zeitschaltuhr. Dieser muss im Flash abgelegt werden.
zWebDayTimer_^PageName=$$c1400;

// Zustandsvariablen
bSlotStateToggle_^PageName=0b01
bTriggerSlotStateUpdate_^PageName=0b01
uSlotToUpdate_^PageName=1u08
uSlotAddress_^PageName=1u16

if systemstart() then {
/* Konstanten setzen */
stringset(Webschaltuhr_zSlotValueIndex,$Aus                 Ein                 $c40,0u16);
stringset(Webschaltuhr_zDayIndexToString,$Sontag              Montag              Dienstag            Mittwoch            Donnerstag          Freitag             Samstag             Werktags            Wochenende          Täglich           $c200,00u16);
stringset(Webschaltuhr_zTimeIndexToString,$000102030405060708091011121314151617181920212223$c50,0u16);
stringset(Webschaltuhr_zMTimeIndexToString,$000102030405060708091011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859$c122,0u16);

/* Slot1 */
stringset(zWebDayTimer_^PageName,0u64,0u16);

/* Slot2 */
stringset(zWebDayTimer_^PageName,0u64,10u16);

/* Slot3 */
stringset(zWebDayTimer_^PageName,0u64,20u16);

/* Slot4 */
stringset(zWebDayTimer_^PageName,0u64,30u16);

} endif

// Tageswahlwahlschalter - Aktualisieren der gewälten Daten des aktuellen Slots
uSelectedDay_^PageName=255u08;
if mpbutton(Webschaltuhr_DayID,1,PageID)==255 then uSelectedDay_^PageName=0u08; endif
if mpbutton(Webschaltuhr_DayID,2,PageID)==255 then uSelectedDay_^PageName=1u08; endif
if mpbutton(Webschaltuhr_DayID,3,PageID)==255 then uSelectedDay_^PageName=2u08; endif
if mpbutton(Webschaltuhr_DayID,4,PageID)==255 then uSelectedDay_^PageName=3u08; endif
if mpbutton(Webschaltuhr_DayID,5,PageID)==255 then uSelectedDay_^PageName=4u08; endif
if mpbutton(Webschaltuhr_DayID,6,PageID)==255 then uSelectedDay_^PageName=5u08; endif
if mpbutton(Webschaltuhr_DayID,7,PageID)==255 then uSelectedDay_^PageName=6u08; endif
if mpbutton(Webschaltuhr_DayID,8,PageID)==255 then uSelectedDay_^PageName=7u08; endif
if mpbutton(Webschaltuhr_DayID,9,PageID)==255 then uSelectedDay_^PageName=8u08; endif
if mpbutton(Webschaltuhr_DayID,10,PageID)==255 then uSelectedDay_^PageName=9u08; endif
if change(uSelectedDay_^PageName) AND uSelectedDay_^PageName < 200u08 then stringset(zWebDayTimer_^PageName,uSelectedDay_^PageName,convert(((uSelectedWebschaltuhr_SlotID-1)*10+1), 0u16));uSlotToUpdate_^PageName=uSelectedWebschaltuhr_SlotID; bTriggerSlotStateUpdate_^PageName =! bTriggerSlotStateUpdate_^PageName; endif;

// Stundenwahlschalter - Aktualisieren der gewälten Daten des aktuellen Slots
uSelectedHour_^PageName=255u08;
if mpbutton(Webschaltuhr_StundenID,1,PageID)==255 then uSelectedHour_^PageName=0u08; endif
if mpbutton(Webschaltuhr_StundenID,2,PageID)==255 then uSelectedHour_^PageName=1u08; endif
if mpbutton(Webschaltuhr_StundenID,3,PageID)==255 then uSelectedHour_^PageName=2u08; endif
if mpbutton(Webschaltuhr_StundenID,4,PageID)==255 then uSelectedHour_^PageName=3u08; endif
if mpbutton(Webschaltuhr_StundenID,5,PageID)==255 then uSelectedHour_^PageName=4u08; endif
if mpbutton(Webschaltuhr_StundenID,6,PageID)==255 then uSelectedHour_^PageName=5u08; endif
if mpbutton(Webschaltuhr_StundenID,7,PageID)==255 then uSelectedHour_^PageName=6u08; endif
if mpbutton(Webschaltuhr_StundenID,8,PageID)==255 then uSelectedHour_^PageName=7u08; endif
if mpbutton(Webschaltuhr_StundenID,9,PageID)==255 then uSelectedHour_^PageName=8u08; endif
if mpbutton(Webschaltuhr_StundenID,10,PageID)==255 then uSelectedHour_^PageName=9u08; endif
if mpbutton(Webschaltuhr_StundenID,11,PageID)==255 then uSelectedHour_^PageName=10u08; endif
if mpbutton(Webschaltuhr_StundenID,12,PageID)==255 then uSelectedHour_^PageName=11u08; endif
if mpbutton(Webschaltuhr_StundenID,13,PageID)==255 then uSelectedHour_^PageName=12u08; endif
if mpbutton(Webschaltuhr_StundenID,14,PageID)==255 then uSelectedHour_^PageName=13u08; endif
if mpbutton(Webschaltuhr_StundenID,15,PageID)==255 then uSelectedHour_^PageName=14u08; endif
if mpbutton(Webschaltuhr_StundenID,16,PageID)==255 then uSelectedHour_^PageName=15u08; endif
if mpbutton(Webschaltuhr_StundenID,17,PageID)==255 then uSelectedHour_^PageName=16u08; endif
if mpbutton(Webschaltuhr_StundenID,18,PageID)==255 then uSelectedHour_^PageName=17u08; endif
if mpbutton(Webschaltuhr_StundenID,19,PageID)==255 then uSelectedHour_^PageName=18u08; endif
if mpbutton(Webschaltuhr_StundenID,20,PageID)==255 then uSelectedHour_^PageName=19u08; endif
if mpbutton(Webschaltuhr_StundenID,21,PageID)==255 then uSelectedHour_^PageName=20u08; endif
if mpbutton(Webschaltuhr_StundenID,22,PageID)==255 then uSelectedHour_^PageName=21u08; endif
if mpbutton(Webschaltuhr_StundenID,23,PageID)==255 then uSelectedHour_^PageName=22u08; endif
if mpbutton(Webschaltuhr_StundenID,24,PageID)==255 then uSelectedHour_^PageName=23u08; endif
if change(uSelectedHour_^PageName) AND uSelectedHour_^PageName < 200u08 then stringset(zWebDayTimer_^PageName,uSelectedHour_^PageName,convert(((uSelectedWebschaltuhr_SlotID-1)*10+2), 0u16));uSlotToUpdate_^PageName=uSelectedWebschaltuhr_SlotID; bTriggerSlotStateUpdate_^PageName =! bTriggerSlotStateUpdate_^PageName; endif;

// Minutenwahlschalter - Aktualisieren der gewälten Daten des aktuellen Slots
uSelectedMinute_^PageName=255u08;
if mpbutton(Webschaltuhr_MinutenID,1,PageID)==255 then uSelectedMinute_^PageName=0u08; endif
if mpbutton(Webschaltuhr_MinutenID,2,PageID)==255 then uSelectedMinute_^PageName=1u08; endif
if mpbutton(Webschaltuhr_MinutenID,3,PageID)==255 then uSelectedMinute_^PageName=2u08; endif
if mpbutton(Webschaltuhr_MinutenID,4,PageID)==255 then uSelectedMinute_^PageName=3u08; endif
if mpbutton(Webschaltuhr_MinutenID,5,PageID)==255 then uSelectedMinute_^PageName=4u08; endif
if mpbutton(Webschaltuhr_MinutenID,6,PageID)==255 then uSelectedMinute_^PageName=5u08; endif
if mpbutton(Webschaltuhr_MinutenID,7,PageID)==255 then uSelectedMinute_^PageName=6u08; endif
if mpbutton(Webschaltuhr_MinutenID,8,PageID)==255 then uSelectedMinute_^PageName=7u08; endif
if mpbutton(Webschaltuhr_MinutenID,9,PageID)==255 then uSelectedMinute_^PageName=8u08; endif
if mpbutton(Webschaltuhr_MinutenID,10,PageID)==255 then uSelectedMinute_^PageName=9u08; endif
if mpbutton(Webschaltuhr_MinutenID,11,PageID)==255 then uSelectedMinute_^PageName=10u08; endif
if mpbutton(Webschaltuhr_MinutenID,12,PageID)==255 then uSelectedMinute_^PageName=11u08; endif
if mpbutton(Webschaltuhr_MinutenID,13,PageID)==255 then uSelectedMinute_^PageName=12u08; endif
if mpbutton(Webschaltuhr_MinutenID,14,PageID)==255 then uSelectedMinute_^PageName=13u08; endif
if mpbutton(Webschaltuhr_MinutenID,15,PageID)==255 then uSelectedMinute_^PageName=14u08; endif
if mpbutton(Webschaltuhr_MinutenID,16,PageID)==255 then uSelectedMinute_^PageName=15u08; endif
if mpbutton(Webschaltuhr_MinutenID,17,PageID)==255 then uSelectedMinute_^PageName=16u08; endif
if mpbutton(Webschaltuhr_MinutenID,18,PageID)==255 then uSelectedMinute_^PageName=17u08; endif
if mpbutton(Webschaltuhr_MinutenID,19,PageID)==255 then uSelectedMinute_^PageName=18u08; endif
if mpbutton(Webschaltuhr_MinutenID,20,PageID)==255 then uSelectedMinute_^PageName=19u08; endif
if mpbutton(Webschaltuhr_MinutenID,21,PageID)==255 then uSelectedMinute_^PageName=20u08; endif
if mpbutton(Webschaltuhr_MinutenID,22,PageID)==255 then uSelectedMinute_^PageName=21u08; endif
if mpbutton(Webschaltuhr_MinutenID,23,PageID)==255 then uSelectedMinute_^PageName=22u08; endif
if mpbutton(Webschaltuhr_MinutenID,24,PageID)==255 then uSelectedMinute_^PageName=23u08; endif
if mpbutton(Webschaltuhr_MinutenID,25,PageID)==255 then uSelectedMinute_^PageName=24u08; endif
if mpbutton(Webschaltuhr_MinutenID,26,PageID)==255 then uSelectedMinute_^PageName=25u08; endif
if mpbutton(Webschaltuhr_MinutenID,27,PageID)==255 then uSelectedMinute_^PageName=26u08; endif
if mpbutton(Webschaltuhr_MinutenID,28,PageID)==255 then uSelectedMinute_^PageName=27u08; endif
if mpbutton(Webschaltuhr_MinutenID,29,PageID)==255 then uSelectedMinute_^PageName=28u08; endif
if mpbutton(Webschaltuhr_MinutenID,30,PageID)==255 then uSelectedMinute_^PageName=29u08; endif
if mpbutton(Webschaltuhr_MinutenID,31,PageID)==255 then uSelectedMinute_^PageName=30u08; endif
if mpbutton(Webschaltuhr_MinutenID,32,PageID)==255 then uSelectedMinute_^PageName=31u08; endif
if mpbutton(Webschaltuhr_MinutenID,33,PageID)==255 then uSelectedMinute_^PageName=32u08; endif
if mpbutton(Webschaltuhr_MinutenID,34,PageID)==255 then uSelectedMinute_^PageName=33u08; endif
if mpbutton(Webschaltuhr_MinutenID,35,PageID)==255 then uSelectedMinute_^PageName=34u08; endif
if mpbutton(Webschaltuhr_MinutenID,36,PageID)==255 then uSelectedMinute_^PageName=35u08; endif
if mpbutton(Webschaltuhr_MinutenID,37,PageID)==255 then uSelectedMinute_^PageName=36u08; endif
if mpbutton(Webschaltuhr_MinutenID,38,PageID)==255 then uSelectedMinute_^PageName=37u08; endif
if mpbutton(Webschaltuhr_MinutenID,39,PageID)==255 then uSelectedMinute_^PageName=38u08; endif
if mpbutton(Webschaltuhr_MinutenID,40,PageID)==255 then uSelectedMinute_^PageName=39u08; endif
if mpbutton(Webschaltuhr_MinutenID,41,PageID)==255 then uSelectedMinute_^PageName=40u08; endif
if mpbutton(Webschaltuhr_MinutenID,42,PageID)==255 then uSelectedMinute_^PageName=41u08; endif
if mpbutton(Webschaltuhr_MinutenID,43,PageID)==255 then uSelectedMinute_^PageName=42u08; endif
if mpbutton(Webschaltuhr_MinutenID,44,PageID)==255 then uSelectedMinute_^PageName=43u08; endif
if mpbutton(Webschaltuhr_MinutenID,45,PageID)==255 then uSelectedMinute_^PageName=44u08; endif
if mpbutton(Webschaltuhr_MinutenID,46,PageID)==255 then uSelectedMinute_^PageName=45u08; endif
if mpbutton(Webschaltuhr_MinutenID,47,PageID)==255 then uSelectedMinute_^PageName=46u08; endif
if mpbutton(Webschaltuhr_MinutenID,48,PageID)==255 then uSelectedMinute_^PageName=47u08; endif
if mpbutton(Webschaltuhr_MinutenID,49,PageID)==255 then uSelectedMinute_^PageName=48u08; endif
if mpbutton(Webschaltuhr_MinutenID,50,PageID)==255 then uSelectedMinute_^PageName=49u08; endif
if mpbutton(Webschaltuhr_MinutenID,51,PageID)==255 then uSelectedMinute_^PageName=50u08; endif
if mpbutton(Webschaltuhr_MinutenID,52,PageID)==255 then uSelectedMinute_^PageName=51u08; endif
if mpbutton(Webschaltuhr_MinutenID,53,PageID)==255 then uSelectedMinute_^PageName=52u08; endif
if mpbutton(Webschaltuhr_MinutenID,54,PageID)==255 then uSelectedMinute_^PageName=53u08; endif
if mpbutton(Webschaltuhr_MinutenID,55,PageID)==255 then uSelectedMinute_^PageName=54u08; endif
if mpbutton(Webschaltuhr_MinutenID,56,PageID)==255 then uSelectedMinute_^PageName=55u08; endif
if mpbutton(Webschaltuhr_MinutenID,57,PageID)==255 then uSelectedMinute_^PageName=56u08; endif
if mpbutton(Webschaltuhr_MinutenID,58,PageID)==255 then uSelectedMinute_^PageName=57u08; endif
if mpbutton(Webschaltuhr_MinutenID,59,PageID)==255 then uSelectedMinute_^PageName=58u08; endif
if mpbutton(Webschaltuhr_MinutenID,60,PageID)==255 then uSelectedMinute_^PageName=59u08; endif
if change(uSelectedMinute_^PageName) AND uSelectedMinute_^PageName < 200u08 then stringset(zWebDayTimer_^PageName,uSelectedMinute_^PageName,convert(((uSelectedWebschaltuhr_SlotID-1)*10+3), 0u16));uSlotToUpdate_^PageName=uSelectedWebschaltuhr_SlotID; bTriggerSlotStateUpdate_^PageName =! bTriggerSlotStateUpdate_^PageName; endif


// Wertewahlschalter - Funktionen: Setzen der Variable zSlotSelWert_Page1
StateSlot_^PageName=stringcast(zWebDayTimer_^PageName,0u08,convert(((uSelectedWebschaltuhr_SlotID-1)*10+4), 0u16))+1;

// Der Hack wird benötigt, damit beim Webbrowser-Refresh der aktuelle Sliderwert erhalten bleibt.
if change(getpeslider(Webschaltuhr_ValueID,PageID)) then {
        setpeslider(Webschaltuhr_ValueID,getpeslider(Webschaltuhr_ValueID,PageID),STATESWITCH,StateSlot_^PageName,PageID)
} endif


if change (getpeslider(Webschaltuhr_ValueID,PageID)) then {
	stringset(zWebDayTimer_^PageName,convert(getpeslider(Webschaltuhr_ValueID,PageID),0u08),convert(((uSelectedWebschaltuhr_SlotID-1)*10+4), 0u16));uSlotToUpdate_^PageName=uSelectedWebschaltuhr_SlotID; bTriggerSlotStateUpdate_^PageName =! bTriggerSlotStateUpdate_^PageName;} endif

// Bei Druck auf Slot-Button wird Aktivierung getoggelt
if pbutton(Webschaltuhr_Slot1ID,PageID)==1u08 then {uSlotToUpdate_^PageName=Webschaltuhr_Slot1ID;bSlotStateToggle_^PageName=1b01; bTriggerSlotStateUpdate_^PageName=!bTriggerSlotStateUpdate_^PageName;} endif
if pbutton(Webschaltuhr_Slot2ID,PageID)==1u08 then {uSlotToUpdate_^PageName=Webschaltuhr_Slot2ID;bSlotStateToggle_^PageName=1b01; bTriggerSlotStateUpdate_^PageName=!bTriggerSlotStateUpdate_^PageName;} endif
if pbutton(Webschaltuhr_Slot3ID,PageID)==1u08 then {uSlotToUpdate_^PageName=Webschaltuhr_Slot3ID;bSlotStateToggle_^PageName=1b01; bTriggerSlotStateUpdate_^PageName=!bTriggerSlotStateUpdate_^PageName;} endif
if pbutton(Webschaltuhr_Slot4ID,PageID)==1u08 then {uSlotToUpdate_^PageName=Webschaltuhr_Slot4ID;bSlotStateToggle_^PageName=1b01; bTriggerSlotStateUpdate_^PageName=!bTriggerSlotStateUpdate_^PageName;} endif

// Slotwahlschalter - Funktionen: Setzen der Variable uSelectedWebschaltuhr_SlotID
if mpbutton(Webschaltuhr_SlotID,2,PageID)==255 then uOldSelectedWebschaltuhr_SlotID=uSelectedWebschaltuhr_SlotID; uSelectedWebschaltuhr_SlotID = Webschaltuhr_Slot1ID; endif
if mpbutton(Webschaltuhr_SlotID,3,PageID)==255 then uOldSelectedWebschaltuhr_SlotID=uSelectedWebschaltuhr_SlotID; uSelectedWebschaltuhr_SlotID = Webschaltuhr_Slot2ID; endif
if mpbutton(Webschaltuhr_SlotID,4,PageID)==255 then uOldSelectedWebschaltuhr_SlotID=uSelectedWebschaltuhr_SlotID; uSelectedWebschaltuhr_SlotID = Webschaltuhr_Slot3ID; endif
if mpbutton(Webschaltuhr_SlotID,5,PageID)==255 then uOldSelectedWebschaltuhr_SlotID=uSelectedWebschaltuhr_SlotID; uSelectedWebschaltuhr_SlotID = Webschaltuhr_Slot4ID; endif

//Bei Systemstart werden die Schalthandlungen aus dem Flash geladen und das Übersichtpanel aktualisiert
bFlashReaded_^PageName=0b01;
if after(systemstart(),10000u64) then {
  readflash(zWebDayTimer_^PageName,uFlashAdress);
  bFlashReaded_^PageName=1b01;
} endif;

if after(systemstart(),(convert(PageID,1u64)*1000u64+10000u64)) then {
  uSlotToUpdate_^PageName=1u08;
  bTriggerSlotStateUpdate_^PageName=!bTriggerSlotStateUpdate_^PageName;
} endif;

if after(systemstart(),(convert(PageID,1u64)*1500u64+10000u64)) then {
  uSlotToUpdate_^PageName=2u08;
  bTriggerSlotStateUpdate_^PageName=!bTriggerSlotStateUpdate_^PageName;
} endif;

if after(systemstart(),(convert(PageID,1u64)*2500u64+10000u64)) then {
  uSlotToUpdate_^PageName=3u08;
  bTriggerSlotStateUpdate_^PageName=!bTriggerSlotStateUpdate_^PageName;
} endif;

if after(systemstart(),(convert(PageID,1u64)*3500u64+10000u64)) then {
  uSlotToUpdate_^PageName=4u08;
  bTriggerSlotStateUpdate_^PageName=!bTriggerSlotStateUpdate_^PageName;
} endif;


// Schaltuhr 1
Status1_^PageName = 0
Farbe1_^PageName = 0
bState1_^PageName=convert(convert(stringcast(zWebDayTimer_^PageName,0u08,0u16),0b01),0u08)
if bState1_^PageName == 0 then Status1_^PageName = 1 endif
if bState1_^PageName == 1 then  Status1_^PageName = 2 endif
if Status1_^PageName == 2 then Farbe1_^PageName = GREEN endif
if Status1_^PageName == 1 then Farbe1_^PageName = GREY endif
if systemstart() then pdisplay(Webschaltuhr_Slot1ID,Webschaltuhr_zSlot1Text,CLOCK,Status1_^PageName,Farbe1_^PageName,PageID) endif;
if systemstart() or change(zWebDayTimer_^PageName) then Webschaltuhr_Pos13 =convert(stringcast(zWebDayTimer_^PageName,0u08,4u16)*20,0u16) endif;
if change(zWebDayTimer_^PageName) then Webschaltuhr_Pos1 =convert(stringcast(zWebDayTimer_^PageName,0u08,1u16)*20,0u16) endif;
if change(zWebDayTimer_^PageName) then Webschaltuhr_Pos2 =convert(stringcast(zWebDayTimer_^PageName,0u08,2u16)*2,0u16) endif;
if change(zWebDayTimer_^PageName) then Webschaltuhr_Pos3 =convert(stringcast(zWebDayTimer_^PageName,0u08,3u16)*2,0u16) endif;



// Schaltuhr 2
Status2_^PageName= 0
Farbe2_^PageName = 0 
bState2_^PageName=convert(convert(stringcast(zWebDayTimer_^PageName,0u08,10u16),0b01),0u08)
if bState2_^PageName==0 then Status2_^PageName = 1 endif
if bState2_^PageName==1 then Status2_^PageName = 2 endif
if Status2_^PageName == 2 then Farbe2_^PageName = GREEN endif
if Status2_^PageName == 1 then Farbe2_^PageName = GREY endif
if systemstart() then pdisplay(Webschaltuhr_Slot2ID,Webschaltuhr_zSlot2Text,CLOCK,Status2_^PageName,Farbe2_^PageName,PageID) endif;
if systemstart() or change(zWebDayTimer_^PageName) then Webschaltuhr_Pos14 =convert(stringcast(zWebDayTimer_^PageName,0u08,14u16)*20,0u16) endif;
if change(zWebDayTimer_^PageName) then Webschaltuhr_Pos4 =convert(stringcast(zWebDayTimer_^PageName,0u08,11u16)*20,0u16) endif;
if change(zWebDayTimer_^PageName) then Webschaltuhr_Pos5 =convert(stringcast(zWebDayTimer_^PageName,0u08,12u16)*2,0u16) endif;
if change(zWebDayTimer_^PageName) then Webschaltuhr_Pos6 =convert(stringcast(zWebDayTimer_^PageName,0u08,13u16)*2,0u16) endif;


// Schaltuhr 3
Status3_^PageName= 0
Farbe3_^PageName = 0 
bState3_^PageName=convert(convert(stringcast(zWebDayTimer_^PageName,0u08,20u16),0b01),0u08)
if bState3_^PageName == 0 then Status3_^PageName = 1 endif 
if bState3_^PageName == 1 then Status3_^PageName = 2 endif
if Status3_^PageName == 2 then Farbe3_^PageName = GREEN endif
if Status3_^PageName == 1 then Farbe3_^PageName = GREY endif
if systemstart() then pdisplay(Webschaltuhr_Slot3ID,Webschaltuhr_zSlot3Text,CLOCK,Status3_^PageName,Farbe3_^PageName,PageID) endif;
if systemstart() or change(zWebDayTimer_^PageName) then Webschaltuhr_Pos15 =convert(stringcast(zWebDayTimer_^PageName,0u08,24u16)*20,0u16) endif;
if change(zWebDayTimer_^PageName) then Webschaltuhr_Pos7 =convert(stringcast(zWebDayTimer_^PageName,0u08,21u16)*20,0u16) endif;
if change(zWebDayTimer_^PageName) then Webschaltuhr_Pos8 =convert(stringcast(zWebDayTimer_^PageName,0u08,22u16)*2,0u16) endif;
if change(zWebDayTimer_^PageName) then Webschaltuhr_Pos9 =convert(stringcast(zWebDayTimer_^PageName,0u08,23u16)*2,0u16) endif;


// Schaltuhr 4
Status4_^PageName= 0
Farbe4_^PageName = 0 
bState4_^PageName=convert(convert(stringcast(zWebDayTimer_^PageName,0u08,30u16),0b01),0u08)
if bState4_^PageName == 0 then Status4_^PageName = 1 endif
if bState4_^PageName == 1 then Status4_^PageName = 2 endif
if Status4_^PageName == 2 then Farbe4_^PageName = GREEN  endif
if Status4_^PageName == 1 then Farbe4_^PageName = GREY endif
if systemstart() then pdisplay(Webschaltuhr_Slot4ID,Webschaltuhr_zSlot4Text,CLOCK,Status4_^PageName,Farbe4_^PageName,PageID) endif;
if systemstart() or change(zWebDayTimer_^PageName) then Webschaltuhr_Pos16 =convert(stringcast(zWebDayTimer_^PageName,0u08,34u16)*20,0u16) endif;
if change(zWebDayTimer_^PageName) then Webschaltuhr_Pos10 =convert(stringcast(zWebDayTimer_^PageName,0u08,31u16)*20,0u16) endif;
if change(zWebDayTimer_^PageName) then Webschaltuhr_Pos11 =convert(stringcast(zWebDayTimer_^PageName,0u08,32u16)*2,0u16) endif;
if change(zWebDayTimer_^PageName) then Webschaltuhr_Pos12 =convert(stringcast(zWebDayTimer_^PageName,0u08,33u16)*2,0u16) endif;


// Bei Auswahl eines Slots werden aktuelle Schaltuhrwerte (aus dem Speicher zWebDayTimer_^PageName) in das Konfigurationspanel geladen
if change(uSelectedWebschaltuhr_SlotID) then {
	
	pdisplay(Webschaltuhr_DayID,$$, DATE, INACTIVE, GREY, PageID,(stringcast(zWebDayTimer_^PageName,0u08,convert(((uSelectedWebschaltuhr_SlotID-1)*10+1), 0u16)))+1u08); /* Tageswahl-Dropdown aktualisieren */
	pdisplay(Webschaltuhr_StundenID,$$, CLOCK, INACTIVE, GREY, PageID,(stringcast(zWebDayTimer_^PageName,0u08,convert(((uSelectedWebschaltuhr_SlotID-1)*10+2), 0u16)))+1u08); /* Stundenwahl-Dropdown aktualisieren */
	pdisplay(Webschaltuhr_MinutenID,$$, CLOCK, INACTIVE, GREY, PageID,(stringcast(zWebDayTimer_^PageName,0u08,convert(((uSelectedWebschaltuhr_SlotID-1)*10+3), 0u16)))+1u08); /* Minutenwahl-Dropdown aktualisieren */
	setpeslider(Webschaltuhr_ValueID,convert(stringcast(zWebDayTimer_^PageName,0u16,convert(((uSelectedWebschaltuhr_SlotID-1)*10+4), 0u16)),0f32),STATESWITCH,StateSlot_^PageName,PageID); /* Wertwahl-Slider aktualisieren */

} endif

// Wenn eine Zeit bzw. ein Wert im Konfigurationspanel geändert wurde, wird die Anzeige im gerade aktiven Slot entsprechend aktualisiert.
if  change(bTriggerSlotStateUpdate_^PageName) then {
	uSlotAddress_^PageName=convert((uSlotToUpdate_^PageName-1)*10,0u16);
	Webschaltuhr_bState=convert(stringcast(zWebDayTimer_^PageName,0u08,uSlotAddress_^PageName),0b01);
	if bSlotStateToggle_^PageName == 1b01 then Webschaltuhr_bState=!Webschaltuhr_bState; bSlotStateToggle_^PageName=0b01; endif;
	
	// Neuen Status in den Flash schreiben.
	stringset(zWebDayTimer_^PageName,convert(Webschaltuhr_bState,0u08),uSlotAddress_^PageName);
	
	Webschaltuhr_mPos=convert(stringcast(zWebDayTimer_^PageName,0u08,uSlotAddress_^PageName+3u16)*2,0u16); 
	Webschaltuhr_zMTime=convert(split(Webschaltuhr_zMTimeIndexToString, Webschaltuhr_mPos , 1u16 + Webschaltuhr_mPos),$$c14);

	Webschaltuhr_tPos=   convert(stringcast(zWebDayTimer_^PageName,0u08,uSlotAddress_^PageName+2u16)*2,0u16); 
	Webschaltuhr_zTime=  convert(split(Webschaltuhr_zTimeIndexToString, Webschaltuhr_tPos , 1u16 + Webschaltuhr_tPos),$$c14);

	Webschaltuhr_uPos=	convert(stringcast(zWebDayTimer_^PageName,0u08,uSlotAddress_^PageName+1u16)*20,0u16);
	Webschaltuhr_zDayUntrimmed=	convert(split(Webschaltuhr_zDayIndexToString, Webschaltuhr_uPos , 10u16 + Webschaltuhr_uPos),$$c1400);
	Webschaltuhr_zDay=	convert(split(Webschaltuhr_zDayUntrimmed, 0u16, find(Webschaltuhr_zDayUntrimmed, $ $, 0u16) - 1u16),$$c14);

	Webschaltuhr_vPos=   convert(stringcast(zWebDayTimer_^PageName,0u08,uSlotAddress_^PageName+4u16)*20,0u16);
	Webschaltuhr_zValue=	convert(split(Webschaltuhr_zSlotValueIndex, Webschaltuhr_vPos , 2u16 + Webschaltuhr_vPos),$$c14);
	

	Webschaltuhr_zSlotSelShifterLabel=convert(Webschaltuhr_zDay,$$)+$, $+convert(Webschaltuhr_zTime,$$)+$:$+convert(Webschaltuhr_zMTime,$$)+$ Uhr$+$, $+convert(Webschaltuhr_zValue,$$);
	if Webschaltuhr_bState==0b01 then {
		pdisplay(uSlotToUpdate_^PageName,Webschaltuhr_zSlotSelShifterLabel+ $, inaktiv$ ,CLOCK,INACTIVE,GREY,PageID);
	} endif;
	if Webschaltuhr_bState==1b01 then {
		pdisplay(uSlotToUpdate_^PageName,Webschaltuhr_zSlotSelShifterLabel+ $, aktiv$,CLOCK,ACTIVE,GREEN,PageID);
	} endif;
	writeflash(zWebDayTimer_^PageName,uFlashAdress)
} endif;


// Gruppenadresse entsprechend den Schaltuhren 1,2,3,4 schalten, wenn Sie aktiv geschalten wurden.
Wert1_^PageName= 0b01;
if Webschaltuhr_zSlot1Value==($Ein$c14) then Wert1_^PageName=EIN endif
if Webschaltuhr_zSlot1Value==($Aus$c14) then Wert1_^PageName=AUS endif
Stunde1_^PageName =convert(Webschaltuhr_zSlot1Hour,0u08);
Minute1_^PageName =convert(Webschaltuhr_zSlot1Minute,0u08);
Tag1_^PageName = convert(stringcast(zWebDayTimer_^PageName,0u08,1u16),0u08)
if (Tag1_^PageName < 9u08) and (bState1_^PageName ==1) and wtime(Stunde1_^PageName,Minute1_^PageName,0,Tag1_^PageName) then write(GA,Wert1_^PageName) endif;
if (Tag1_^PageName == 9u08) and (bState1_^PageName ==1) and htime(Stunde1_^PageName,Minute1_^PageName,0) then write(GA,Wert1_^PageName) endif;


Wert2_^PageName= 0b01;
if Webschaltuhr_zSlot2Value==($Ein$c14) then Wert2_^PageName=1b01 endif
if Webschaltuhr_zSlot2Value==($Aus$c14) then Wert2_^PageName=0b01 endif
Stunde2_^PageName =convert(Webschaltuhr_zSlot2Hour,0u08);
Minute2_^PageName =convert(Webschaltuhr_zSlot2Minute,0u08);
Tag2_^PageName = stringcast(zWebDayTimer_^PageName,0u08,11u16)
if (Tag2_^PageName < 9u08) and (bState2_^PageName ==1) and wtime(Stunde2_^PageName,Minute2_^PageName,0,Tag2_^PageName) then write(GA,Wert2_^PageName) endif 
if (Tag2_^PageName == 9u08) and (bState2_^PageName ==1) and htime(Stunde2_^PageName,Minute2_^PageName,0) then write(GA,Wert2_^PageName) endif;


Wert3_^PageName= 0b01;
if Webschaltuhr_zSlot3Value==($Ein$c14) then Wert3_^PageName=1b01 endif
if Webschaltuhr_zSlot3Value==($Aus$c14) then Wert3_^PageName=0b01 endif
Stunde3_^PageName =convert(Webschaltuhr_zSlot3Hour,0u08);
Minute3_^PageName =convert(Webschaltuhr_zSlot3Minute,0u08);
Tag3_^PageName = stringcast(zWebDayTimer_^PageName,0u08,21u16)
if (Tag3_^PageName < 9u08) and (bState3_^PageName ==1) and wtime(Stunde3_^PageName,Minute3_^PageName,0,Tag3_^PageName) then write(GA,Wert3_^PageName) endif
if (Tag3_^PageName == 9u08) and (bState3_^PageName ==1) and htime(Stunde3_^PageName,Minute3_^PageName,0) then write(GA,Wert3_^PageName) endif


Wert4_^PageName= 0b01;
if Webschaltuhr_zSlot4Value==($Ein$c14) then Wert4_^PageName=1b01 endif
if Webschaltuhr_zSlot4Value==($Aus$c14) then Wert4_^PageName=0b01 endif
Stunde4_^PageName =convert(Webschaltuhr_zSlot4Hour,0u08);
Minute4_^PageName =convert(Webschaltuhr_zSlot4Minute,0u08);
Tag4_^PageName = stringcast(zWebDayTimer_^PageName,0u08,31u16)
if (Tag4_^PageName < 9u08) and (bState4_^PageName ==1) and wtime(Stunde4_^PageName,Minute4_^PageName,0,Tag4_^PageName) then write(GA,Wert4_^PageName) endif
if (Tag4_^PageName == 9u08) and (bState4_^PageName ==1) and htime(Stunde4_^PageName,Minute4_^PageName,0) then write(GA,Wert4_^PageName) endif

:end


// Webelement
// @date    28.09.2015
// @version    1
// @author     Enertex Bayern GmbH
:begin SliderDimmerStatusVerzoegerung(ID, PageID, GA, StatusGA)
:info $Ein seitenbezogenen Slider(pslider), der einen Dimmer ansteuert. Die GA ist vom Typ u08 (= Prozenttyp). Es gibt eine Statusrückmeldung, die nach spätestens 6 Sekunden nach der Rückmeldung in der Visu aktualisiert wird. Das Icon wird dem Zustand angepasst.$\\
         :$ID des psliders$\\
         :$SeitenID des psliders$\\
         :$Gruppenadresse des Dimmers (Prozenttyp (u08))\\
     :$Statusadresse des Dimmers (Prozenttyp (u08))$
:shortinfo $Einen Dimmer mit einem Slider ansteuern$
initga(GA)
initga(StatusGA)
InternDimmer_^ID_^PageID=0
InternDimmerManuell_^ID_^PageID=EIN

// Status bei normaler Busnderung
if systemstart()  then {
     write(GA,StatusGA);
     InternDimmer_^ID_^PageID=StatusGA
} endif


if change(GA) then InternDimmer_^ID_^PageID=GA endif
// Warte auf eine Rückmeldung 6 Sekunden
if delay(change(StatusGA),6000u64) then {
       if StatusGA!=InternDimmer_^ID_^PageID then {
             InternDimmer_^ID_^PageID=StatusGA;
             // Keine manuelle Bedienung des Sliders
             InternDimmerManuell_^ID_^PageID=AUS;
        } endif
    } endif


if change(InternDimmer_^ID_^PageID) then {
    // Schreibe einen neuen Wert nur, wenn dieser von der Sliderbetaetigung kommt
    if InternDimmer_^ID_^PageID!=GA and InternDimmerManuell_^ID_^PageID then {
        write(GA,InternDimmer_^ID_^PageID);
    } endif;
    if InternDimmer_^ID_^PageID==0 then {
 setpslider(ID,InternDimmer_^ID_^PageID,LIGHT,INACTIVE,PageID)
    } endif ;
    if InternDimmer_^ID_^PageID>=1 and InternDimmer_^ID_^PageID<50  then {
        setpslider(ID,InternDimmer_^ID_^PageID,LIGHT,STATE4,PageID)
    } endif;
    if InternDimmer_^ID_^PageID>=50 and InternDimmer_^ID_^PageID<100  then {
        setpslider(ID,InternDimmer_^ID_^PageID,LIGHT,STATE5,PageID)
    } endif;
    if InternDimmer_^ID_^PageID>=100 and InternDimmer_^ID_^PageID<200  then {
        setpslider(ID,InternDimmer_^ID_^PageID,LIGHT,STATE6,PageID)
    } endif;
    if InternDimmer_^ID_^PageID>=200  then {
        setpslider(ID,InternDimmer_^ID_^PageID,LIGHT,ACTIVE,PageID)
    } endif
    } endif;

if change(getpslider(ID,PageID)) then {
    InternDimmerManuell_^ID_^PageID=EIN;
    InternDimmer_^ID_^PageID=getpslider(ID,PageID);
} endif
:end

// @date	09.01.2015
// @version	2
// @author	Enertex Bayern GmbH, J. Schuhmann
:begin Zeitschaltuhr4SchaltuhrenV2(PageName,PageID,GA)
:info $Mit diesem Makro generiert der Visualisierungsassistent eine Webseite, mit der 4 Schaltzeituhren für eine binäre GA definiert werden können.\\
	:$Name der Webseite - muss eindeutig im Programm sein$\\
	:$Beliebige ganze Zahl für die eindeutige Kennzeichnung der Webseite im Visuassi$\\
	:$Gruppenadresse des Aktors der mit der Zeitschaltuhr geschalten wird (b01)$\\

:shortinfo $Generierung einer Schaltzeituhrwebseite im Visualisierungsassistent (Neu). Im Visu-Assistenten verwendet.$

// Zustandsvariable für die Zeitschaltuhr. Dieser muss im Flash abgelegt werden.
cDataFlash_^PageName=$$c1400;

// Zustandsvariablen
bSlotStateToggle_^PageName=0b01
bTriggerSlotStateUpdate_^PageName=0b01
uSlotToUpdate_^PageName=1u08
uSlotAddress_^PageName=1u16

if systemstart() then {
/* Lookup-Tables definieren */
stringset(Webschaltuhr_zSlotValueIndex,$Aus                 Ein                 $c40,0u16);
stringset(Webschaltuhr_zDayIndexToString,$Sontag              Montag              Dienstag            Mittwoch            Donnerstag          Freitag             Samstag             Werktags            Wochenende          Täglich           $c200,00u16);
stringset(Webschaltuhr_zTimeIndexToString,$000102030405060708091011121314151617181920212223$c50,0u16);
stringset(Webschaltuhr_zMTimeIndexToString,$000102030405060708091011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859$c122,0u16);

/* Slot1 */
stringset(cDataFlash_^PageName,0u64,0u16);

/* Slot2 */
stringset(cDataFlash_^PageName,0u64,10u16);

/* Slot3 */
stringset(cDataFlash_^PageName,0u64,20u16);

/* Slot4 */
stringset(cDataFlash_^PageName,0u64,30u16);

} endif

// Tageswahlwahlschalter - Aktualisieren der gewälten Daten des aktuellen Slots
uSelectedDay_^PageName=255u08;
if mpbutton(Webschaltuhr_DayID,1,PageID)==255 then uSelectedDay_^PageName=0u08; endif
if mpbutton(Webschaltuhr_DayID,2,PageID)==255 then uSelectedDay_^PageName=1u08; endif
if mpbutton(Webschaltuhr_DayID,3,PageID)==255 then uSelectedDay_^PageName=2u08; endif
if mpbutton(Webschaltuhr_DayID,4,PageID)==255 then uSelectedDay_^PageName=3u08; endif
if mpbutton(Webschaltuhr_DayID,5,PageID)==255 then uSelectedDay_^PageName=4u08; endif
if mpbutton(Webschaltuhr_DayID,6,PageID)==255 then uSelectedDay_^PageName=5u08; endif
if mpbutton(Webschaltuhr_DayID,7,PageID)==255 then uSelectedDay_^PageName=6u08; endif
if mpbutton(Webschaltuhr_DayID,8,PageID)==255 then uSelectedDay_^PageName=7u08; endif
if mpbutton(Webschaltuhr_DayID,9,PageID)==255 then uSelectedDay_^PageName=8u08; endif
if mpbutton(Webschaltuhr_DayID,10,PageID)==255 then uSelectedDay_^PageName=9u08; endif
if change(uSelectedDay_^PageName) AND uSelectedDay_^PageName < 200u08 then stringset(cDataFlash_^PageName,uSelectedDay_^PageName,convert(((uSelectedWebschaltuhr_SlotID-1)*10+1), 0u16));uSlotToUpdate_^PageName=uSelectedWebschaltuhr_SlotID; bTriggerSlotStateUpdate_^PageName =! bTriggerSlotStateUpdate_^PageName; endif;

// Stundenwahlschalter - Aktualisieren der gewälten Daten des aktuellen Slots
uSelectedHour_^PageName=255u08;
if mpbutton(Webschaltuhr_StundenID,1,PageID)==255 then uSelectedHour_^PageName=0u08; endif
if mpbutton(Webschaltuhr_StundenID,2,PageID)==255 then uSelectedHour_^PageName=1u08; endif
if mpbutton(Webschaltuhr_StundenID,3,PageID)==255 then uSelectedHour_^PageName=2u08; endif
if mpbutton(Webschaltuhr_StundenID,4,PageID)==255 then uSelectedHour_^PageName=3u08; endif
if mpbutton(Webschaltuhr_StundenID,5,PageID)==255 then uSelectedHour_^PageName=4u08; endif
if mpbutton(Webschaltuhr_StundenID,6,PageID)==255 then uSelectedHour_^PageName=5u08; endif
if mpbutton(Webschaltuhr_StundenID,7,PageID)==255 then uSelectedHour_^PageName=6u08; endif
if mpbutton(Webschaltuhr_StundenID,8,PageID)==255 then uSelectedHour_^PageName=7u08; endif
if mpbutton(Webschaltuhr_StundenID,9,PageID)==255 then uSelectedHour_^PageName=8u08; endif
if mpbutton(Webschaltuhr_StundenID,10,PageID)==255 then uSelectedHour_^PageName=9u08; endif
if mpbutton(Webschaltuhr_StundenID,11,PageID)==255 then uSelectedHour_^PageName=10u08; endif
if mpbutton(Webschaltuhr_StundenID,12,PageID)==255 then uSelectedHour_^PageName=11u08; endif
if mpbutton(Webschaltuhr_StundenID,13,PageID)==255 then uSelectedHour_^PageName=12u08; endif
if mpbutton(Webschaltuhr_StundenID,14,PageID)==255 then uSelectedHour_^PageName=13u08; endif
if mpbutton(Webschaltuhr_StundenID,15,PageID)==255 then uSelectedHour_^PageName=14u08; endif
if mpbutton(Webschaltuhr_StundenID,16,PageID)==255 then uSelectedHour_^PageName=15u08; endif
if mpbutton(Webschaltuhr_StundenID,17,PageID)==255 then uSelectedHour_^PageName=16u08; endif
if mpbutton(Webschaltuhr_StundenID,18,PageID)==255 then uSelectedHour_^PageName=17u08; endif
if mpbutton(Webschaltuhr_StundenID,19,PageID)==255 then uSelectedHour_^PageName=18u08; endif
if mpbutton(Webschaltuhr_StundenID,20,PageID)==255 then uSelectedHour_^PageName=19u08; endif
if mpbutton(Webschaltuhr_StundenID,21,PageID)==255 then uSelectedHour_^PageName=20u08; endif
if mpbutton(Webschaltuhr_StundenID,22,PageID)==255 then uSelectedHour_^PageName=21u08; endif
if mpbutton(Webschaltuhr_StundenID,23,PageID)==255 then uSelectedHour_^PageName=22u08; endif
if mpbutton(Webschaltuhr_StundenID,24,PageID)==255 then uSelectedHour_^PageName=23u08; endif
if change(uSelectedHour_^PageName) AND uSelectedHour_^PageName < 200u08 then stringset(cDataFlash_^PageName,uSelectedHour_^PageName,convert(((uSelectedWebschaltuhr_SlotID-1)*10+2), 0u16));uSlotToUpdate_^PageName=uSelectedWebschaltuhr_SlotID; bTriggerSlotStateUpdate_^PageName =! bTriggerSlotStateUpdate_^PageName; endif;

// Minutenwahlschalter - Aktualisieren der gewälten Daten des aktuellen Slots
uSelectedMinute_^PageName=255u08;
if mpbutton(Webschaltuhr_MinutenID,1,PageID)==255 then uSelectedMinute_^PageName=0u08; endif
if mpbutton(Webschaltuhr_MinutenID,2,PageID)==255 then uSelectedMinute_^PageName=1u08; endif
if mpbutton(Webschaltuhr_MinutenID,3,PageID)==255 then uSelectedMinute_^PageName=2u08; endif
if mpbutton(Webschaltuhr_MinutenID,4,PageID)==255 then uSelectedMinute_^PageName=3u08; endif
if mpbutton(Webschaltuhr_MinutenID,5,PageID)==255 then uSelectedMinute_^PageName=4u08; endif
if mpbutton(Webschaltuhr_MinutenID,6,PageID)==255 then uSelectedMinute_^PageName=5u08; endif
if mpbutton(Webschaltuhr_MinutenID,7,PageID)==255 then uSelectedMinute_^PageName=6u08; endif
if mpbutton(Webschaltuhr_MinutenID,8,PageID)==255 then uSelectedMinute_^PageName=7u08; endif
if mpbutton(Webschaltuhr_MinutenID,9,PageID)==255 then uSelectedMinute_^PageName=8u08; endif
if mpbutton(Webschaltuhr_MinutenID,10,PageID)==255 then uSelectedMinute_^PageName=9u08; endif
if mpbutton(Webschaltuhr_MinutenID,11,PageID)==255 then uSelectedMinute_^PageName=10u08; endif
if mpbutton(Webschaltuhr_MinutenID,12,PageID)==255 then uSelectedMinute_^PageName=11u08; endif
if mpbutton(Webschaltuhr_MinutenID,13,PageID)==255 then uSelectedMinute_^PageName=12u08; endif
if mpbutton(Webschaltuhr_MinutenID,14,PageID)==255 then uSelectedMinute_^PageName=13u08; endif
if mpbutton(Webschaltuhr_MinutenID,15,PageID)==255 then uSelectedMinute_^PageName=14u08; endif
if mpbutton(Webschaltuhr_MinutenID,16,PageID)==255 then uSelectedMinute_^PageName=15u08; endif
if mpbutton(Webschaltuhr_MinutenID,17,PageID)==255 then uSelectedMinute_^PageName=16u08; endif
if mpbutton(Webschaltuhr_MinutenID,18,PageID)==255 then uSelectedMinute_^PageName=17u08; endif
if mpbutton(Webschaltuhr_MinutenID,19,PageID)==255 then uSelectedMinute_^PageName=18u08; endif
if mpbutton(Webschaltuhr_MinutenID,20,PageID)==255 then uSelectedMinute_^PageName=19u08; endif
if mpbutton(Webschaltuhr_MinutenID,21,PageID)==255 then uSelectedMinute_^PageName=20u08; endif
if mpbutton(Webschaltuhr_MinutenID,22,PageID)==255 then uSelectedMinute_^PageName=21u08; endif
if mpbutton(Webschaltuhr_MinutenID,23,PageID)==255 then uSelectedMinute_^PageName=22u08; endif
if mpbutton(Webschaltuhr_MinutenID,24,PageID)==255 then uSelectedMinute_^PageName=23u08; endif
if mpbutton(Webschaltuhr_MinutenID,25,PageID)==255 then uSelectedMinute_^PageName=24u08; endif
if mpbutton(Webschaltuhr_MinutenID,26,PageID)==255 then uSelectedMinute_^PageName=25u08; endif
if mpbutton(Webschaltuhr_MinutenID,27,PageID)==255 then uSelectedMinute_^PageName=26u08; endif
if mpbutton(Webschaltuhr_MinutenID,28,PageID)==255 then uSelectedMinute_^PageName=27u08; endif
if mpbutton(Webschaltuhr_MinutenID,29,PageID)==255 then uSelectedMinute_^PageName=28u08; endif
if mpbutton(Webschaltuhr_MinutenID,30,PageID)==255 then uSelectedMinute_^PageName=29u08; endif
if mpbutton(Webschaltuhr_MinutenID,31,PageID)==255 then uSelectedMinute_^PageName=30u08; endif
if mpbutton(Webschaltuhr_MinutenID,32,PageID)==255 then uSelectedMinute_^PageName=31u08; endif
if mpbutton(Webschaltuhr_MinutenID,33,PageID)==255 then uSelectedMinute_^PageName=32u08; endif
if mpbutton(Webschaltuhr_MinutenID,34,PageID)==255 then uSelectedMinute_^PageName=33u08; endif
if mpbutton(Webschaltuhr_MinutenID,35,PageID)==255 then uSelectedMinute_^PageName=34u08; endif
if mpbutton(Webschaltuhr_MinutenID,36,PageID)==255 then uSelectedMinute_^PageName=35u08; endif
if mpbutton(Webschaltuhr_MinutenID,37,PageID)==255 then uSelectedMinute_^PageName=36u08; endif
if mpbutton(Webschaltuhr_MinutenID,38,PageID)==255 then uSelectedMinute_^PageName=37u08; endif
if mpbutton(Webschaltuhr_MinutenID,39,PageID)==255 then uSelectedMinute_^PageName=38u08; endif
if mpbutton(Webschaltuhr_MinutenID,40,PageID)==255 then uSelectedMinute_^PageName=39u08; endif
if mpbutton(Webschaltuhr_MinutenID,41,PageID)==255 then uSelectedMinute_^PageName=40u08; endif
if mpbutton(Webschaltuhr_MinutenID,42,PageID)==255 then uSelectedMinute_^PageName=41u08; endif
if mpbutton(Webschaltuhr_MinutenID,43,PageID)==255 then uSelectedMinute_^PageName=42u08; endif
if mpbutton(Webschaltuhr_MinutenID,44,PageID)==255 then uSelectedMinute_^PageName=43u08; endif
if mpbutton(Webschaltuhr_MinutenID,45,PageID)==255 then uSelectedMinute_^PageName=44u08; endif
if mpbutton(Webschaltuhr_MinutenID,46,PageID)==255 then uSelectedMinute_^PageName=45u08; endif
if mpbutton(Webschaltuhr_MinutenID,47,PageID)==255 then uSelectedMinute_^PageName=46u08; endif
if mpbutton(Webschaltuhr_MinutenID,48,PageID)==255 then uSelectedMinute_^PageName=47u08; endif
if mpbutton(Webschaltuhr_MinutenID,49,PageID)==255 then uSelectedMinute_^PageName=48u08; endif
if mpbutton(Webschaltuhr_MinutenID,50,PageID)==255 then uSelectedMinute_^PageName=49u08; endif
if mpbutton(Webschaltuhr_MinutenID,51,PageID)==255 then uSelectedMinute_^PageName=50u08; endif
if mpbutton(Webschaltuhr_MinutenID,52,PageID)==255 then uSelectedMinute_^PageName=51u08; endif
if mpbutton(Webschaltuhr_MinutenID,53,PageID)==255 then uSelectedMinute_^PageName=52u08; endif
if mpbutton(Webschaltuhr_MinutenID,54,PageID)==255 then uSelectedMinute_^PageName=53u08; endif
if mpbutton(Webschaltuhr_MinutenID,55,PageID)==255 then uSelectedMinute_^PageName=54u08; endif
if mpbutton(Webschaltuhr_MinutenID,56,PageID)==255 then uSelectedMinute_^PageName=55u08; endif
if mpbutton(Webschaltuhr_MinutenID,57,PageID)==255 then uSelectedMinute_^PageName=56u08; endif
if mpbutton(Webschaltuhr_MinutenID,58,PageID)==255 then uSelectedMinute_^PageName=57u08; endif
if mpbutton(Webschaltuhr_MinutenID,59,PageID)==255 then uSelectedMinute_^PageName=58u08; endif
if mpbutton(Webschaltuhr_MinutenID,60,PageID)==255 then uSelectedMinute_^PageName=59u08; endif
if change(uSelectedMinute_^PageName) AND uSelectedMinute_^PageName < 200u08 then stringset(cDataFlash_^PageName,uSelectedMinute_^PageName,convert(((uSelectedWebschaltuhr_SlotID-1)*10+3), 0u16));uSlotToUpdate_^PageName=uSelectedWebschaltuhr_SlotID; bTriggerSlotStateUpdate_^PageName =! bTriggerSlotStateUpdate_^PageName; endif


// Wertewahlschalter - Funktionen: Setzen der Variable zSlotSelWert_Page1
StateSlot_^PageName=stringcast(cDataFlash_^PageName,0u08,convert(((uSelectedWebschaltuhr_SlotID-1)*10+4), 0u16))+1;

// Der Hack wird benötigt, damit beim Webbrowser-Refresh der aktuelle Sliderwert erhalten bleibt.
if change(getpeslider(Webschaltuhr_ValueID,PageID)) then {
        setpeslider(Webschaltuhr_ValueID,getpeslider(Webschaltuhr_ValueID,PageID),STATESWITCH,StateSlot_^PageName,PageID)
} endif


if change (getpeslider(Webschaltuhr_ValueID,PageID)) then {
	stringset(cDataFlash_^PageName,convert(getpeslider(Webschaltuhr_ValueID,PageID),0u08),convert(((uSelectedWebschaltuhr_SlotID-1)*10+4), 0u16));uSlotToUpdate_^PageName=uSelectedWebschaltuhr_SlotID; bTriggerSlotStateUpdate_^PageName =! bTriggerSlotStateUpdate_^PageName;} endif

// Bei Druck auf Slot-Button wird Aktivierung getoggelt
if pbutton(Webschaltuhr_Slot1ID,PageID)==1u08 then {uSlotToUpdate_^PageName=Webschaltuhr_Slot1ID;bSlotStateToggle_^PageName=1b01; bTriggerSlotStateUpdate_^PageName=!bTriggerSlotStateUpdate_^PageName;} endif
if pbutton(Webschaltuhr_Slot2ID,PageID)==1u08 then {uSlotToUpdate_^PageName=Webschaltuhr_Slot2ID;bSlotStateToggle_^PageName=1b01; bTriggerSlotStateUpdate_^PageName=!bTriggerSlotStateUpdate_^PageName;} endif
if pbutton(Webschaltuhr_Slot3ID,PageID)==1u08 then {uSlotToUpdate_^PageName=Webschaltuhr_Slot3ID;bSlotStateToggle_^PageName=1b01; bTriggerSlotStateUpdate_^PageName=!bTriggerSlotStateUpdate_^PageName;} endif
if pbutton(Webschaltuhr_Slot4ID,PageID)==1u08 then {uSlotToUpdate_^PageName=Webschaltuhr_Slot4ID;bSlotStateToggle_^PageName=1b01; bTriggerSlotStateUpdate_^PageName=!bTriggerSlotStateUpdate_^PageName;} endif

// Slotwahlschalter - Funktionen: Setzen der Variable uSelectedWebschaltuhr_SlotID
if mpbutton(Webschaltuhr_SlotID,2,PageID)==255 then uOldSelectedWebschaltuhr_SlotID=uSelectedWebschaltuhr_SlotID; uSelectedWebschaltuhr_SlotID = Webschaltuhr_Slot1ID; endif
if mpbutton(Webschaltuhr_SlotID,3,PageID)==255 then uOldSelectedWebschaltuhr_SlotID=uSelectedWebschaltuhr_SlotID; uSelectedWebschaltuhr_SlotID = Webschaltuhr_Slot2ID; endif
if mpbutton(Webschaltuhr_SlotID,4,PageID)==255 then uOldSelectedWebschaltuhr_SlotID=uSelectedWebschaltuhr_SlotID; uSelectedWebschaltuhr_SlotID = Webschaltuhr_Slot3ID; endif
if mpbutton(Webschaltuhr_SlotID,5,PageID)==255 then uOldSelectedWebschaltuhr_SlotID=uSelectedWebschaltuhr_SlotID; uSelectedWebschaltuhr_SlotID = Webschaltuhr_Slot4ID; endif

//Bei Systemstart werden die Schalthandlungen aus dem Flash geladen und das Übersichtpanel aktualisiert
if after(systemstart(),10000u64) then {
  //readflash(cDataFlash_^PageName,uFlashAdress);
  readflashvar(cDataFlash_^PageName);
} endif;

if after(systemstart(),(convert(PageID,1u64)*1000u64+10000u64)) then {
  uSlotToUpdate_^PageName=1u08;
  bTriggerSlotStateUpdate_^PageName=!bTriggerSlotStateUpdate_^PageName;
} endif;

if after(systemstart(),(convert(PageID,1u64)*1500u64+10000u64)) then {
  uSlotToUpdate_^PageName=2u08;
  bTriggerSlotStateUpdate_^PageName=!bTriggerSlotStateUpdate_^PageName;
} endif;

if after(systemstart(),(convert(PageID,1u64)*2500u64+10000u64)) then {
  uSlotToUpdate_^PageName=3u08;
  bTriggerSlotStateUpdate_^PageName=!bTriggerSlotStateUpdate_^PageName;
} endif;

if after(systemstart(),(convert(PageID,1u64)*3500u64+10000u64)) then {
  uSlotToUpdate_^PageName=4u08;
  bTriggerSlotStateUpdate_^PageName=!bTriggerSlotStateUpdate_^PageName;
} endif;


// Schaltuhr 1
Farbe1_^PageName = 0
uStatus1_^PageName=convert(convert(stringcast(cDataFlash_^PageName,0u08,0u16)+1,0b01),0u08)
if uStatus1_^PageName == 2 then Farbe1_^PageName = GREEN endif
if uStatus1_^PageName == 1 then Farbe1_^PageName = GREY endif
if systemstart() then pdisplay(Webschaltuhr_Slot1ID,Webschaltuhr_zSlot1Text,CLOCK,uStatus1_^PageName,Farbe1_^PageName,PageID) endif;
if systemstart() or change(cDataFlash_^PageName) then Webschaltuhr_Pos13 =convert(stringcast(cDataFlash_^PageName,0u08,4u16)*20,0u16) endif;
if change(cDataFlash_^PageName) then Webschaltuhr_Pos1 =convert(stringcast(cDataFlash_^PageName,0u08,1u16)*20,0u16) endif;
if change(cDataFlash_^PageName) then Webschaltuhr_Pos2 =convert(stringcast(cDataFlash_^PageName,0u08,2u16)*2,0u16) endif;
if change(cDataFlash_^PageName) then Webschaltuhr_Pos3 =convert(stringcast(cDataFlash_^PageName,0u08,3u16)*2,0u16) endif;



// Schaltuhr 2
Farbe2_^PageName = 0
uStatus2_^PageName=convert(convert(stringcast(cDataFlash_^PageName,0u08,10u16)+1,0b01),0u08)
if uStatus2_^PageName == 2 then Farbe2_^PageName = GREEN endif
if uStatus2_^PageName == 1 then Farbe2_^PageName = GREY endif
if systemstart() then pdisplay(Webschaltuhr_Slot2ID,Webschaltuhr_zSlot2Text,CLOCK,uStatus2_^PageName,Farbe2_^PageName,PageID) endif;
if systemstart() or change(cDataFlash_^PageName) then Webschaltuhr_Pos14 =convert(stringcast(cDataFlash_^PageName,0u08,14u16)*20,0u16) endif;
if change(cDataFlash_^PageName) then Webschaltuhr_Pos4 =convert(stringcast(cDataFlash_^PageName,0u08,11u16)*20,0u16) endif;
if change(cDataFlash_^PageName) then Webschaltuhr_Pos5 =convert(stringcast(cDataFlash_^PageName,0u08,12u16)*2,0u16) endif;
if change(cDataFlash_^PageName) then Webschaltuhr_Pos6 =convert(stringcast(cDataFlash_^PageName,0u08,13u16)*2,0u16) endif;


// Schaltuhr 3
Farbe3_^PageName = 0 
uStatus3_^PageName=convert(convert(stringcast(cDataFlash_^PageName,0u08,20u16)+1,0b01),0u08)
if uStatus3_^PageName == 2 then Farbe2_^PageName = GREEN endif
if uStatus3_^PageName == 1 then Farbe2_^PageName = GREY endif
if systemstart() then pdisplay(Webschaltuhr_Slot3ID,Webschaltuhr_zSlot3Text,CLOCK,uStatus3_^PageName,Farbe3_^PageName,PageID) endif;
if systemstart() or change(cDataFlash_^PageName) then Webschaltuhr_Pos15 =convert(stringcast(cDataFlash_^PageName,0u08,24u16)*20,0u16) endif;
if change(cDataFlash_^PageName) then Webschaltuhr_Pos7 =convert(stringcast(cDataFlash_^PageName,0u08,21u16)*20,0u16) endif;
if change(cDataFlash_^PageName) then Webschaltuhr_Pos8 =convert(stringcast(cDataFlash_^PageName,0u08,22u16)*2,0u16) endif;
if change(cDataFlash_^PageName) then Webschaltuhr_Pos9 =convert(stringcast(cDataFlash_^PageName,0u08,23u16)*2,0u16) endif;


// Schaltuhr 4
Farbe4_^PageName = 0 
uStatus4_^PageName=convert(convert(stringcast(cDataFlash_^PageName,0u08,30u16)+1,0b01),0u08)
if uStatus4_^PageName == 2 then Farbe2_^PageName = GREEN endif
if uStatus4_^PageName == 1 then Farbe2_^PageName = GREY endif
if systemstart() then pdisplay(Webschaltuhr_Slot4ID,Webschaltuhr_zSlot4Text,CLOCK,uStatus4_^PageName,Farbe4_^PageName,PageID) endif;
if systemstart() or change(cDataFlash_^PageName) then Webschaltuhr_Pos16 =convert(stringcast(cDataFlash_^PageName,0u08,34u16)*20,0u16) endif;
if change(cDataFlash_^PageName) then Webschaltuhr_Pos10 =convert(stringcast(cDataFlash_^PageName,0u08,31u16)*20,0u16) endif;
if change(cDataFlash_^PageName) then Webschaltuhr_Pos11 =convert(stringcast(cDataFlash_^PageName,0u08,32u16)*2,0u16) endif;
if change(cDataFlash_^PageName) then Webschaltuhr_Pos12 =convert(stringcast(cDataFlash_^PageName,0u08,33u16)*2,0u16) endif;


// Bei Auswahl eines Slots werden aktuelle Schaltuhrwerte (aus dem Speicher cDataFlash_^PageName) in das Konfigurationspanel geladen
if change(uSelectedWebschaltuhr_SlotID) then {
	
	pdisplay(Webschaltuhr_DayID,$$, DATE, INACTIVE, GREY, PageID,(stringcast(cDataFlash_^PageName,0u08,convert(((uSelectedWebschaltuhr_SlotID-1)*10+1), 0u16)))+1u08); /* Tageswahl-Dropdown aktualisieren */
	pdisplay(Webschaltuhr_StundenID,$$, CLOCK, INACTIVE, GREY, PageID,(stringcast(cDataFlash_^PageName,0u08,convert(((uSelectedWebschaltuhr_SlotID-1)*10+2), 0u16)))+1u08); /* Stundenwahl-Dropdown aktualisieren */
	pdisplay(Webschaltuhr_MinutenID,$$, CLOCK, INACTIVE, GREY, PageID,(stringcast(cDataFlash_^PageName,0u08,convert(((uSelectedWebschaltuhr_SlotID-1)*10+3), 0u16)))+1u08); /* Minutenwahl-Dropdown aktualisieren */
	setpeslider(Webschaltuhr_ValueID,convert(stringcast(cDataFlash_^PageName,0u16,convert(((uSelectedWebschaltuhr_SlotID-1)*10+4), 0u16)),0f32),STATESWITCH,StateSlot_^PageName,PageID); /* Wertwahl-Slider aktualisieren */

} endif

// Wenn eine Zeit bzw. ein Wert im Konfigurationspanel geändert wurde, wird die Anzeige im gerade aktiven Slot entsprechend aktualisiert.
if  change(bTriggerSlotStateUpdate_^PageName) then {
	uSlotAddress_^PageName=convert((uSlotToUpdate_^PageName-1)*10,0u16);
	Webschaltuhr_bState=convert(stringcast(cDataFlash_^PageName,0u08,uSlotAddress_^PageName),0b01);
	if bSlotStateToggle_^PageName == 1b01 then Webschaltuhr_bState=!Webschaltuhr_bState; bSlotStateToggle_^PageName=0b01; endif;
	
	// Neuen Status in den Flash schreiben.
	stringset(cDataFlash_^PageName,convert(Webschaltuhr_bState,0u08),uSlotAddress_^PageName);
	
	Webschaltuhr_mPos=convert(stringcast(cDataFlash_^PageName,0u08,uSlotAddress_^PageName+3u16)*2,0u16); 
	Webschaltuhr_zMTime=convert(split(Webschaltuhr_zMTimeIndexToString, Webschaltuhr_mPos , 1u16 + Webschaltuhr_mPos),$$c14);

	Webschaltuhr_tPos=   convert(stringcast(cDataFlash_^PageName,0u08,uSlotAddress_^PageName+2u16)*2,0u16); 
	Webschaltuhr_zTime=  convert(split(Webschaltuhr_zTimeIndexToString, Webschaltuhr_tPos , 1u16 + Webschaltuhr_tPos),$$c14);

	Webschaltuhr_uPos=	convert(stringcast(cDataFlash_^PageName,0u08,uSlotAddress_^PageName+1u16)*20,0u16);
	Webschaltuhr_zDayUntrimmed=	convert(split(Webschaltuhr_zDayIndexToString, Webschaltuhr_uPos , 10u16 + Webschaltuhr_uPos),$$c1400);
	Webschaltuhr_zDay=	convert(split(Webschaltuhr_zDayUntrimmed, 0u16, find(Webschaltuhr_zDayUntrimmed, $ $, 0u16) - 1u16),$$c14);

	Webschaltuhr_vPos=   convert(stringcast(cDataFlash_^PageName,0u08,uSlotAddress_^PageName+4u16)*20,0u16);
	Webschaltuhr_zValue=	convert(split(Webschaltuhr_zSlotValueIndex, Webschaltuhr_vPos , 2u16 + Webschaltuhr_vPos),$$c14);
	

	Webschaltuhr_zSlotSelShifterLabel=convert(Webschaltuhr_zDay,$$)+$, $+convert(Webschaltuhr_zTime,$$)+$:$+convert(Webschaltuhr_zMTime,$$)+$ Uhr$+$, $+convert(Webschaltuhr_zValue,$$);
	if Webschaltuhr_bState==0b01 then {
		pdisplay(uSlotToUpdate_^PageName,Webschaltuhr_zSlotSelShifterLabel+ $, inaktiv$ ,CLOCK,INACTIVE,GREY,PageID);
	} endif;
	if Webschaltuhr_bState==1b01 then {
		pdisplay(uSlotToUpdate_^PageName,Webschaltuhr_zSlotSelShifterLabel+ $, aktiv$,CLOCK,ACTIVE,GREEN,PageID);
	} endif;
	//writeflash(cDataFlash_^PageName,uFlashAdress)
	writeflashvar(cDataFlash_^PageName)
} endif;


// Gruppenadresse entsprechend den Schaltuhren 1,2,3,4 schalten, wenn Sie aktiv geschalten wurden.
Wert1_^PageName   = convert(stringcast(cDataFlash_^PageName,0u08,4u16),0b01)
Stunde1_^PageName = convert(stringcast(cDataFlash_^PageName,0u08,2u16),0u08)
Minute1_^PageName = convert(stringcast(cDataFlash_^PageName,0u08,3u16),0u08)
Tag1_^PageName    = convert(stringcast(cDataFlash_^PageName,0u08,1u16),0u08)
uState1_^PageName = convert(stringcast(cDataFlash_^PageName,0u08,0u16),0u08)
if (Tag1_^PageName < 9u08) and (uState1_^PageName ==1) and wtime(Stunde1_^PageName,Minute1_^PageName,0,Tag1_^PageName) then write(GA,Wert1_^PageName) endif;
if (Tag1_^PageName == 9u08) and (uState1_^PageName ==1) and htime(Stunde1_^PageName,Minute1_^PageName,0) then write(GA,Wert1_^PageName) endif;


Wert2_^PageName   = convert(stringcast(cDataFlash_^PageName,0u08,14u16),0b01)
Stunde2_^PageName = convert(stringcast(cDataFlash_^PageName,0u08,12u16),0u08)
Minute2_^PageName = convert(stringcast(cDataFlash_^PageName,0u08,13u16),0u08)
Tag2_^PageName    = convert(stringcast(cDataFlash_^PageName,0u08,11u16),0u08)
uState2_^PageName = convert(stringcast(cDataFlash_^PageName,0u08,10u16),0u08)
if (Tag2_^PageName < 9u08) and (uState2_^PageName ==1) and wtime(Stunde2_^PageName,Minute2_^PageName,0,Tag2_^PageName) then write(GA,Wert2_^PageName) endif 
if (Tag2_^PageName == 9u08) and (uState2_^PageName ==1) and htime(Stunde2_^PageName,Minute2_^PageName,0) then write(GA,Wert2_^PageName) endif;


Wert3_^PageName   = convert(stringcast(cDataFlash_^PageName,0u08,24u16),0b01)
Stunde3_^PageName = convert(stringcast(cDataFlash_^PageName,0u08,22u16),0u08)
Minute3_^PageName = convert(stringcast(cDataFlash_^PageName,0u08,23u16),0u08)
Tag3_^PageName    = convert(stringcast(cDataFlash_^PageName,0u08,21u16),0u08)
uState3_^PageName = convert(stringcast(cDataFlash_^PageName,0u08,20u16),0u08)
if (Tag3_^PageName < 9u08) and (uState3_^PageName ==1) and wtime(Stunde3_^PageName,Minute3_^PageName,0,Tag3_^PageName) then write(GA,Wert3_^PageName) endif
if (Tag3_^PageName == 9u08) and (uState3_^PageName ==1) and htime(Stunde3_^PageName,Minute3_^PageName,0) then write(GA,Wert3_^PageName) endif


Wert4_^PageName   = convert(stringcast(cDataFlash_^PageName,0u08,34u16),0b01)
Stunde4_^PageName = convert(stringcast(cDataFlash_^PageName,0u08,32u16),0u08)
Minute4_^PageName = convert(stringcast(cDataFlash_^PageName,0u08,33u16),0u08)
Tag4_^PageName    = convert(stringcast(cDataFlash_^PageName,0u08,31u16),0u08)
uState4_^PageName = convert(stringcast(cDataFlash_^PageName,0u08,30u16),0u08)
if (Tag4_^PageName < 9u08) and (uState4_^PageName ==1) and wtime(Stunde4_^PageName,Minute4_^PageName,0,Tag4_^PageName) then write(GA,Wert4_^PageName) endif
if (Tag4_^PageName == 9u08) and (uState4_^PageName ==1) and htime(Stunde4_^PageName,Minute4_^PageName,0) then write(GA,Wert4_^PageName) endif

:end

// Nutzt ein Weboutputfeld als formatiertes Loggerfenster
// @date    18.07.2014
// @version    1
// @author    Enertex Bayern GmbH (msc)
:begin WebLoggerSize(ID,Text,FSize)
:info $Schreibt formatiert auf ein Weboutputfeld (QUAD-Groesse) und gibt einen Textstring (40 Zeichen) dort aus$\\
    $ID des weboutput-Elements (u08)$\\
    $Textvariable$\\
    $Schriftgroesse: 0.6, 0.8, 1.0 oder 1.2$
:shortinfo $Weboutputfeld als formatiertes Loggerfenster$

:var TextLogger_out@
:var TextLogger_Count@
:var TextLogger_line@
:var TextLogger_Header@
:var TextLogger_Body@

TextLogger_out@    =$$
TextLogger_Count@  =0
TextLogger_Lines = 0
TextLogger_Cut = 0u16

// Maximum: 40 Characters each Log entry
TextLogger_line@   =$$c40
TextLogger_Header@ =$<body><table border="1" width="320" rules="groups" style="font-size:$+FSize+$em"> <thead><tr><th><font color=teal>Datum </font></th> <th  width="74%">Event </th> </tr></thead><tbody>$c200
TextLogger_Body@   =$$

//Anzahl Zeilen nach Textgroesse
if FSize == $0.6$ then TextLogger_Lines = 16; TextLogger_Cut = 33u16  endif
if FSize == $0.8$ then TextLogger_Lines = 14; TextLogger_Cut = 29u16 endif
if FSize == $1.0$ then TextLogger_Lines = 12; TextLogger_Cut = 25u16 endif
if FSize == $1.2$ then TextLogger_Lines = 10; TextLogger_Cut = 21u16 endif

if change(Text) then {
   TextLogger_line@=Text;
   if TextLogger_Count@>TextLogger_Lines then {
     TextLogger_Body@=$<tr><td><font color=teal>$+convert(settime(),$$c20)+$</font></td><td>$+TextLogger_line@+$</td></tr>$+split(TextLogger_Body@,0u16,(find(TextLogger_Body@,$</td>$,TextLogger_Cut)+4u16));
 } else {
     TextLogger_Body@=$<tr><td><font color=teal>$+convert(settime(),$$c20)+$</font></td><td>$+TextLogger_line@+$</td></tr>$+TextLogger_Body@;
     TextLogger_Count@=TextLogger_Count@+1;
   } endif;
   TextLogger_out@=TextLogger_Header@ +TextLogger_Body@+$</tbody></table></body>$;
   weboutput(ID, TextLogger_out@);
} endif

:end

#ifndef  DEBUG

:begin vmDebugUDP(cString)
:return __EMPTY()
:end

:begin vmAssign(xDst, xSrc)
:return  __EMPTY()
:end
#endif
